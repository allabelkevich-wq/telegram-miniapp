# Диагностика проблем с отправкой заявок

## Что проверить:

### 1. В Mini App (консоль браузера/Telegram):
После нажатия "Отправить заявку" должны появиться логи:
- `[YupSoul] Проверка Telegram API:` - показывает доступность API
- `[YupSoul] ✅ Telegram WebApp API доступен` - если API доступен
- `[YupSoul] MainButton показана, ждём нажатия` - кнопка показана
- `[YupSoul] MainButton onClick: отправка заявки через sendData` - при нажатии
- `[YupSoul] ⚠️ ВЫЗЫВАЮ sendData` - перед отправкой
- `[YupSoul] ✅ sendData вызван успешно` - после отправки

### 2. В боте (логи Render):
Должны появиться логи:
- `[Заявка] ⚠️ ВАЖНО: Получены web_app_data` - данные получены
- `[Заявка] ⚠️ ОБРАБОТЧИК АКТИВИРОВАН!` - обработчик сработал
- `[Заявка] Обработка web_app_data` - обработка началась
- `[Заявка] JSON распарсен` - данные распарсены
- `[Заявка] Сохранена успешно, ID: ...` - заявка сохранена

### 3. Возможные проблемы:

**Проблема 1: sendData не вызывается**
- Проверь консоль Mini App - есть ли ошибки?
- Проверь, что MainButton действительно нажата
- Проверь, что `tg.sendData` существует

**Проблема 2: Данные не доходят до бота**
- Проверь логи бота на Render
- Проверь, что бот обновился (последний коммит: 5a3b05e)
- Проверь, что используется правильный экземпляр бота

**Проблема 3: Обработчик не срабатывает**
- Проверь, что бот запущен и получает обновления
- Проверь команду `/ping` - бот отвечает?
- Проверь, что нет другого процесса, который перехватывает обновления

### 4. Что сделать для диагностики:

1. Открой Mini App из чата с ботом
2. Открой консоль разработчика (если возможно) или смотри логи в Telegram
3. Заполни форму и отправь заявку
4. Проверь логи в Render Dashboard → Logs
5. Напиши `/admin` в боте - есть ли заявка?

### 5. Если заявка не появляется:

Проверь в логах Render:
- Есть ли строка `[Заявка] ⚠️ ВАЖНО: Получены web_app_data`?
- Если нет - данные не доходят до бота (проблема в Mini App или Telegram)
- Если есть, но нет `[Заявка] Сохранена успешно` - проблема в обработке
