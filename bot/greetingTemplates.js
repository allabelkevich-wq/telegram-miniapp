/**
 * –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–º–µ—Å—Ç–µ —Å –ø–µ—Å–Ω–µ–π (–∑–≤—É–∫–æ–≤—ã–º –∫–ª—é—á–æ–º).
 * –í—ã–±–æ—Ä –ø–æ —Ç–∏–ø—É –∑–∞–ø—Ä–æ—Å–∞: –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Ñ–∏–Ω–∞–Ω—Å—ã/–∫–∞—Ä—å–µ—Ä–∞, –∑–¥–æ—Ä–æ–≤—å–µ, –¥—É—Ö–æ–≤–Ω—ã–π, –æ–±—â–∞—è –ø–µ—Å–Ω—è.
 * –ü—Ä–∏–º–µ—Ä—ã –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ç–µ, —á—Ç–æ –ø—Ä–∏—Å—ã–ª–∞–ª–∏—Å—å –≤–º–µ—Å—Ç–µ —Å —á–∞—Ç–æ–º Qwen3max.
 *
 * –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏: {{name}} ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, {{title}} ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å).
 */

const GREETINGS_BY_CATEGORY = {
  /** –ó–∞–ø—Ä–æ—Å –ø—Ä–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –ø–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–æ, –ª—é–±–æ–≤—å */
  relationships: [
    "{{name}} ‚Äî —Ç–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –¥–ª—è –æ—Ç–Ω–æ—à–µ–Ω–∏–π –≥–æ—Ç–æ–≤. –ü—É—Å—Ç—å –æ–Ω –æ—Ç–∫—Ä–æ–µ—Ç –¥–≤–µ—Ä—å –∫ –¥–∏–∞–ª–æ–≥—É –¥—É—à –∏ –≥–∞—Ä–º–æ–Ω–∏–∏ –≤ –ø–∞—Ä–µ. –°–ª—É—à–∞–π —Å —Å–µ—Ä–¥—Ü–µ–º. ‚ù§Ô∏è",
    "–î–ª—è —Ç–µ–±—è, {{name}}, —Å–æ–∑–¥–∞–Ω –∫–ª—é—á –∫ —Ç–µ–º–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π. –ü—É—Å—Ç—å –º—É–∑—ã–∫–∞ –Ω–∞–ø–æ–º–Ω–∏—Ç —Ç–µ–±–µ –æ —Ç–≤–æ–µ–π —Å–∏–ª–µ –∏ –¥–∞—Ä–µ –≤ —Å–æ—é–∑–µ. üå∏",
  ],
  /** –ó–∞–ø—Ä–æ—Å –ø—Ä–æ –¥–µ–Ω—å–≥–∏, –∫–∞—Ä—å–µ—Ä—É, —Ñ–∏–Ω–∞–Ω—Å—ã */
  finances: [
    "{{name}} ‚Äî —Ç–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –¥–ª—è –ø–æ—Ç–æ–∫–∞ –∏–∑–æ–±–∏–ª–∏—è –≥–æ—Ç–æ–≤. –°–ª—É—à–∞–π –µ–≥–æ, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ —è—Å–Ω–æ—Å—Ç—å –∏ —Å–º–µ–ª–æ—Å—Ç—å –≤ —Ä–µ—à–µ–Ω–∏—è—Ö. üíé",
    "–ö–ª—é—á –∫ —Ç–≤–æ–µ–º—É —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–º—É –∏ –∫–∞—Ä—å–µ—Ä–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É –≥–æ—Ç–æ–≤, {{name}}. –ü—É—Å—Ç—å –æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ–±—è –Ω–∞ –ø—É—Ç–∏ –∫ —Ü–µ–ª–∏. ‚ú®",
  ],
  /** –ó–∞–ø—Ä–æ—Å –ø—Ä–æ –∑–¥–æ—Ä–æ–≤—å–µ, —Ç–µ–ª–æ */
  health: [
    "{{name}} ‚Äî —Ç–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –¥–ª—è —Ç–µ–ª–∞ –∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–æ–∑–¥–∞–Ω. –ü—É—Å—Ç—å –æ–Ω —Å—Ç–∞–Ω–µ—Ç –ø—Ä–∞–∫—Ç–∏–∫–æ–π –∑–∞–±–æ—Ç—ã –æ —Å–µ–±–µ. üåø",
    "–î–ª—è —Ç–µ–±—è, {{name}}, –≥–æ—Ç–æ–≤ –∫–ª—é—á, —Ä–µ–∑–æ–Ω–∏—Ä—É—é—â–∏–π —Å —Ç–µ–º–æ–π –∑–¥–æ—Ä–æ–≤—å—è. –°–ª—É—à–∞–π –≤ —Ç–∏—à–∏–Ω–µ ‚Äî —Ç–µ–ª–æ —É—Å–ª—ã—à–∏—Ç. üí´",
  ],
  /** –î—É—Ö–æ–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –ø—É—Ç—å –¥—É—à–∏, –º–∏—Å—Å–∏—è */
  spiritual: [
    "{{name}} ‚Äî —Ç–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –¥–ª—è –¥—É—à–∏ –≥–æ—Ç–æ–≤. –ü—É—Å—Ç—å –æ–Ω –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ç–µ–±–µ –æ –¥–æ–≥–æ–≤–æ—Ä–µ —Å –∂–∏–∑–Ω—å—é –∏ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ. üîÆ",
    "–ö–ª—é—á –∫ —Ç–≤–æ–µ–º—É –¥—É—Ö–æ–≤–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É –∂–¥—ë—Ç —Ç–µ–±—è, {{name}}. –°–ª—É—à–∞–π —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏ –∏ –¥–æ–≤–µ—Ä–∏–µ–º. ‚ú®",
  ],
  /** –°–æ–∑–¥–∞—Ç—å –ø–µ—Å–Ω—é, –æ–±—â–∏–π –∑–∞–ø—Ä–æ—Å, –±–µ–∑ —è–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ */
  default: [
    "{{name}} ‚Äî —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –≥–æ—Ç–æ–≤! –°–ª—É—à–∞–π –µ–≥–æ –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ –≤ —Ç–∏—à–∏–Ω–µ ‚Äî –ø—É—Å—Ç—å –æ–Ω –æ—Ç–∫—Ä–æ–µ—Ç —Ç–µ–±–µ –¥–≤–µ—Ä—å –∫ –∂–µ–ª–∞–µ–º–æ–º—É. ‚ú®",
    "–í—Å–µ–ª–µ–Ω–Ω–∞—è —Å–æ–∑–¥–∞–ª–∞ –¥–ª—è —Ç–µ–±—è, {{name}}, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á. –û–Ω –∂–¥—ë—Ç —Ç–µ–±—è –≤ —ç—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏. –ü–æ–∑–≤–æ–ª—å –∑–≤—É–∫—É —Ç–µ—á—å —á–µ—Ä–µ–∑ —Ç–µ–±—è. üéµ",
    "{{name}}, —Ç–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –≥–æ—Ç–æ–≤. –≠—Ç–æ —Ç–≤–æ–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–∏–ª—ã –¥–ª—è –∏–≥—Ä—ã –∂–∏–∑–Ω–∏ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ —Å –ª—é–±–æ–≤—å—é –∫ —Å–µ–±–µ. üíú",
  ],
};

/** –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (–Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä) –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —Ç–µ–∫—Å—Ç—É –∑–∞–ø—Ä–æ—Å–∞ */
const KEYWORDS = {
  relationships: ["–æ—Ç–Ω–æ—à–µ–Ω", "–ª—é–±–æ–≤", "–ø–∞—Ä—Ç–Ω—ë—Ä", "–ø–∞—Ä–∞", "—Å–æ—é–∑", "—Å–µ–º—å", "–¥–µ—Ç–∏", "—Å–∏–Ω–∞—Å—Ç—Ä–∏", "–≤—Å—Ç—Ä–µ—á", "—Å–µ—Ä–¥—Ü"],
  finances: ["–¥–µ–Ω—å–≥", "—Ñ–∏–Ω–∞–Ω—Å", "–∫–∞—Ä—å–µ—Ä", "—Ä–∞–±–æ—Ç", "–±–∏–∑–Ω–µ—Å", "–¥–æ—Ö–æ–¥", "–∏–∑–æ–±–∏–ª", "–¥–µ–Ω–µ–∂", "–∑–∞—Ä–∞–±–æ—Ç"],
  health: ["–∑–¥–æ—Ä–æ–≤—å", "—Ç–µ–ª–æ", "–±–æ–ª–µ–∑–Ω", "—Å–∏–º–ø—Ç–æ–º", "—ç–Ω–µ—Ä–≥–∏", "—Å–∏–ª", "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤", "–∏—Å—Ü–µ–ª–µ–Ω"],
  spiritual: ["–¥—É—à", "–º–∏—Å—Å–∏", "–∫–∞—Ä–º", "–¥—É—Ö–æ–≤–Ω", "—Å–º—ã—Å–ª", "–ø—É—Ç—å", "–≤–æ–ø–ª–æ—â–µ–Ω", "—É—Ä–æ–∫", "—Å—É–¥—å–±"],
};

/**
 * –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–∞ –ø–æ —Ç–µ–∫—Å—Ç—É.
 * @param {string} requestText ‚Äî —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 * @returns {keyof GREETINGS_BY_CATEGORY}
 */
function getCategoryByRequest(requestText) {
  if (!requestText || typeof requestText !== "string") return "default";
  const lower = requestText.toLowerCase().trim();
  for (const [category, words] of Object.entries(KEYWORDS)) {
    if (words.some((w) => lower.includes(w))) return category;
  }
  return "default";
}

/**
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–º–µ—Å—Ç–µ —Å –ø–µ—Å–Ω–µ–π.
 * @param {string} requestText ‚Äî —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ (–¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
 * @param {{ name?: string, title?: string }} vars ‚Äî –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
 * @returns {string}
 */
function getGreetingForSong(requestText, vars = {}) {
  const category = getCategoryByRequest(requestText);
  const list = GREETINGS_BY_CATEGORY[category] || GREETINGS_BY_CATEGORY.default;
  const template = list[Math.floor(Math.random() * list.length)];
  return template
    .replace(/\{\{name\}\}/g, vars.name || "–î—Ä—É–≥")
    .replace(/\{\{title\}\}/g, vars.title || "—Ç–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á");
}

export { GREETINGS_BY_CATEGORY, KEYWORDS, getCategoryByRequest, getGreetingForSong };
