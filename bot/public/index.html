<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>YupSoul</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <!-- URL –±–æ—Ç–∞ —Å API –∑–∞—è–≤–æ–∫ (Render). –ó–∞—è–≤–∫–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ POST /api/submit-request. -->
  <script>window.HEROES_API_BASE = 'https://telegram-miniapp-ar09.onrender.com'; window.BACKEND_URL = window.HEROES_API_BASE;</script>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
    /* –ê–î–ê–ü–¢–ò–í–ù–´–ï –°–¢–ò–õ–ò –° –ü–û–î–î–ï–†–ñ–ö–û–ô –¢–ï–ú–´ –¢–ï–õ–ï–ì–†–ê–ú */
    :root {
      --primary-color: #d4af37;
      --secondary-color: #ec4899;
      --success-color: #10b981;
      --subtitle-readable: rgba(255,255,255,0.92);
      /* Fluid scaling ‚Äî –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ Apple: —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —ç–∫—Ä–∞–Ω—É */
      --fluid-xs: clamp(0.7rem, 1.8vw, 0.8rem);
      --fluid-sm: clamp(0.8rem, 2.2vw, 0.95rem);
      --fluid-base: clamp(0.9rem, 2.8vw, 1.05rem);
      --fluid-md: clamp(1rem, 3.2vw, 1.2rem);
      --fluid-lg: clamp(1.1rem, 3.8vw, 1.4rem);
      --fluid-xl: clamp(1.2rem, 4.5vw, 1.6rem);
      --fluid-2xl: clamp(1.4rem, 5.5vw, 2.4rem);
      --spacing-xs: clamp(4px, 1.2vw, 8px);
      --spacing-sm: clamp(6px, 1.8vw, 12px);
      --spacing-md: clamp(10px, 2.5vw, 18px);
      --spacing-lg: clamp(14px, 3.5vw, 24px);
      --spacing-xl: clamp(18px, 4.5vw, 28px);
      --radius-sm: clamp(6px, 1.8vw, 10px);
      --radius-md: clamp(8px, 2.2vw, 14px);
      --radius-lg: clamp(12px, 3vw, 20px);
      /* –±–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (dark premium) */
      --tg-theme-bg-color: #0A0A1A;
      --tg-theme-secondary-bg-color: rgba(255,255,255,0.08);
      --tg-theme-text-color: #ffffff;
      --tg-theme-hint-color: rgba(224, 224, 240, 0.7);
      --tg-theme-border-color: rgba(212, 175, 55, 0.3);
      --tg-theme-button-color: #d4af37;
      --tg-theme-button-text-color: #0A0A1A;
    }
    .theme-light {
      --tg-theme-bg-color: #f5f3ff;
      --tg-theme-secondary-bg-color: rgba(255,255,255,0.92);
      --tg-theme-text-color: #1f2937;
      --tg-theme-hint-color: rgba(31, 41, 55, 0.6);
      --tg-theme-border-color: rgba(212,175,55,0.35);
      --tg-theme-button-color: #d4af37;
      --tg-theme-button-text-color: #1f2937;
      --subtitle-readable: rgba(31,41,55,0.88);
    }
    .theme-dark {
      --tg-theme-bg-color: #0A0A1A;
      --tg-theme-secondary-bg-color: rgba(255,255,255,0.08);
      --tg-theme-text-color: #ffffff;
      --tg-theme-hint-color: rgba(224,224,240,0.7);
      --tg-theme-border-color: rgba(212,175,55,0.3);
      --tg-theme-button-color: #d4af37;
      --tg-theme-button-text-color: #0A0A1A;
      --subtitle-readable: rgba(255,255,255,0.92);
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    body {
      background: var(--tg-theme-bg-color) url('assets/bg-yupsoul.png') center/cover no-repeat fixed !important;
      color: var(--tg-theme-text-color) !important;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: var(--fluid-base);
      margin: 0;
      padding: var(--spacing-lg) var(--spacing-md);
      padding-left: max(var(--spacing-md), env(safe-area-inset-left));
      padding-right: max(var(--spacing-md), env(safe-area-inset-right));
      padding-bottom: max(var(--spacing-lg), env(safe-area-inset-bottom));
      min-height: 100vh;
      min-height: -webkit-fill-available;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }
    body::before {
      content:"";position:fixed;inset:0;z-index:0;
      background:
        radial-gradient(circle at 20% 30%, rgba(212,175,55,0.08), transparent 55%),
        radial-gradient(circle at 80% 70%, rgba(236,72,153,0.06), transparent 60%),
        linear-gradient(135deg, rgba(212,175,55,0.08), rgba(0,0,0,0.2));
      pointer-events:none;
    }
    body::after {
      content:"";position:fixed;inset:0;z-index:0;background:
        radial-gradient(1px 1px at 20% 20%, rgba(255,255,255,0.7), transparent 40px),
        radial-gradient(1px 1px at 40% 60%, rgba(255,255,255,0.5), transparent 40px),
        radial-gradient(1px 1px at 70% 30%, rgba(255,255,255,0.8), transparent 40px),
        radial-gradient(1px 1px at 85% 80%, rgba(255,255,255,0.4), transparent 40px);
      opacity:0.4;
      animation: stars 5s linear infinite;
      pointer-events:none;
    }
    @keyframes stars { 0%{opacity:0.3;} 50%{opacity:0.8;} 100%{opacity:0.3;} }
    .content-wrapper { max-width: min(600px,100%); margin: 0 auto; padding: var(--spacing-lg); width: 100%; }
    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; color: var(--tg-theme-text-color, #fff); font-size: 14px; margin-bottom: 8px; font-weight: 500; }
    input::placeholder, textarea::placeholder { color: var(--tg-theme-hint-color, rgba(255,255,255,.45)); opacity: .85; }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%; padding: 12px 16px; background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05));
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1)); border-radius: 8px;
      color: var(--tg-theme-text-color, #fff); font-size: 14px; box-sizing: border-box;
    }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      outline: none; border-color: var(--tg-theme-button-color, #8b5cf6); box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
    }
    .checkbox-group { display: flex; align-items: center; margin-top: 8px; }
    .checkbox-group input[type="checkbox"] { width: 18px; height: 18px; margin-right: 8px; cursor: pointer; }
    .checkbox-group label { margin: 0; font-size: 13px; color: var(--tg-theme-text-color, #fff); opacity: 0.9; }
    small { color: var(--tg-theme-hint-color, rgba(255, 255, 255, 0.6)); font-size: 12px; }
    h3 { color: var(--tg-theme-text-color, #fff); font-size: 18px; margin: 0 0 15px 0; font-weight: 600; }
    #payBtn {
      width: 100%; padding: 16px; background: linear-gradient(135deg, var(--tg-theme-button-color, #8b5cf6), #ec4899);
      border: none; border-radius: 10px; color: var(--tg-theme-button-text-color, #fff); font-size: 16px; font-weight: 600;
      cursor: pointer; transition: all 0.3s; margin-top: 20px; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
    }
    #payBtn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4); }
    #payBtn:active { transform: translateY(0); }
    .form-section {
      background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05)); border-radius: 12px; padding: 20px; margin-bottom: 20px;
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1));
    }
    .request-examples {
      margin: 20px 0; padding: 15px; background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05));
      border-radius: 12px; border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1));
    }
    .request-examples h3 { font-size: 16px; color: var(--tg-theme-text-color, #fff); margin: 0 0 12px 0; font-weight: 500; }
    .examples-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 8px; }
    .example-btn {
      background: linear-gradient(135deg, #d4af37, #e8c547, #d4af37);
      border: 1px solid rgba(212, 175, 55, 0.7); color: #0A0A1A;
      padding: 10px 12px; border-radius: 8px; font-size: 12px; font-weight: 600;
      cursor: pointer; text-align: left; transition: all 0.2s; width: 100%;
      white-space: normal; word-wrap: break-word; word-break: break-word;
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
    }
    .example-btn:hover { opacity: 0.95; transform: translateY(-2px); box-shadow: 0 6px 18px rgba(212, 175, 55, 0.5); background: linear-gradient(135deg, #e0b83a, #f0d050, #e0b83a); }
    .example-btn.special { background: linear-gradient(135deg, #d4af37, #e8c547); border-color: rgba(212, 175, 55, 0.7); }
    .mode-selector {
      margin: 20px 0; padding: 18px; background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(12px);
      border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 4px 20px rgba(139, 92, 246, 0.08);
    }
    .mode-selector h3 { font-size: 16px; color: var(--tg-theme-text-color, #fff); margin: 0 0 6px 0; font-weight: 500; text-align: center; }
    .mode-subtitle { font-size: 12px; color: var(--tg-theme-hint-color, rgba(255,255,255,.65)); margin: 0 0 14px 0; text-align: center; }
    .mode-buttons { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .mode-btn {
      background: rgba(255, 255, 255, 0.1); border: 2px solid rgba(255, 255, 255, 0.2);
      color: var(--tg-theme-text-color, #fff); padding: 16px 12px; border-radius: 12px; cursor: pointer; transition: all 0.3s;
      text-align: center; font-size: 14px; line-height: 1.4;
    }
    .mode-btn:hover {
      background: rgba(255, 255, 255, 0.15); border-color: rgba(139, 92, 246, 0.5);
      transform: translateY(-2px); box-shadow: 0 4px 12px rgba(139, 92, 246, 0.15);
    }
    .mode-btn.active {
      background: linear-gradient(135deg, var(--tg-theme-button-color, #8b5cf6), #ec4899);
      border-color: var(--tg-theme-button-color, #8b5cf6); color: var(--tg-theme-button-text-color, #fff);
      box-shadow: 0 4px 20px rgba(139, 92, 246, 0.35);
    }
    .mode-icon { font-size: 28px; display: block; margin: 0 auto 8px; }
    .mode-label { font-weight: 600; font-size: 14px; display: block; margin: 0 0 4px; }
    .mode-desc { font-size: 11px; opacity: 0.8; display: block; margin-top: 4px; }
    .location-input-wrapper { position: relative; }
    .location-input {
      width: 100%; padding: 12px 16px; background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05));
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1)); border-radius: 8px;
      color: var(--tg-theme-text-color, #fff); font-size: 14px; box-sizing: border-box;
    }
    .location-input:focus {
      outline: none; border-color: var(--tg-theme-button-color, #8b5cf6); box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
    }
    .location-suggestions {
      position: absolute; z-index: 1000; background: var(--tg-theme-bg-color, #1a1a1a);
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1)); border-radius: 8px;
      max-height: 200px; overflow-y: auto; width: 100%; margin-top: 4px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      display: none;
    }
    .location-suggestion {
      padding: 10px 12px; cursor: pointer; border-bottom: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1));
      color: var(--tg-theme-text-color, #fff); font-size: 14px; transition: background 0.2s;
    }
    .location-suggestion:hover { background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.1)); }
    .location-suggestion:last-child { border-bottom: none; }
    .stepper {
      display: flex; gap: 8px; align-items: center; margin-bottom: 16px; position: relative;
    }
    .step-line {
      position: absolute; left: 12px; right: 12px; height: 2px; background: var(--tg-theme-border-color); top: 18px; z-index: 0;
    }
    .step-indicator {
      position: relative; z-index: 1; padding: 8px 12px; border-radius: 10px; border: 1px solid var(--tg-theme-border-color);
      background: var(--tg-theme-secondary-bg-color); color: var(--tg-theme-text-color); font-weight: 600; font-size: 13px;
      flex: 1; text-align: center;
    }
    .step-indicator.active {
      border-color: var(--tg-theme-button-color); background: linear-gradient(135deg, var(--tg-theme-button-color), #ec4899);
      color: var(--tg-theme-button-text-color); box-shadow: 0 6px 18px rgba(139,92,246,0.25);
    }
    .step-panel { margin-top: 4px; }
    .step-nav { display: flex; gap: 12px; margin-top: 16px; }
    .step-nav button { flex: 1; text-transform: none; letter-spacing: 0; }
    @media (max-width: 480px) {
      .mode-buttons { grid-template-columns: 1fr; }
      .examples-grid { grid-template-columns: 1fr; }
      .mode-btn { padding: 14px 10px; }
      .mode-icon { font-size: 24px; }
      .content-wrapper { padding: 15px; }
      #payBtn { padding: 14px; font-size: 15px; }
    }
    @media (min-width: 481px) and (max-width: 768px) {
      .mode-buttons { grid-template-columns: repeat(2, 1fr); }
      .examples-grid { grid-template-columns: repeat(2, 1fr); }
    }
    /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Comfortaa',sans-serif}
    body::before{content:"";position:fixed;inset:0;background:linear-gradient(180deg,rgba(1,6,26,.62) 0%,rgba(8,10,38,.78) 100%);z-index:0}
    .container{max-width:min(600px,100%);margin:0 auto;width:100%;position:relative;z-index:1;padding:0 var(--spacing-md)}
    .page{display:none;min-height:100vh;padding-top:var(--spacing-lg)}
    .page.active{display:block}
    header{text-align:center;margin:var(--spacing-xl) 0 var(--spacing-lg);position:relative}
    h1{font-size:var(--fluid-2xl);background:linear-gradient(135deg,#d4af37,#ec4899,#d4af37);background-size:300% 300%;animation:gradientShift 4s ease infinite;-webkit-background-clip:text;background-clip:text;color:transparent;font-weight:800;letter-spacing:-1px;line-height:1.1}
    .subtitle{color:var(--subtitle-readable,var(--tg-theme-text-color));font-size:var(--fluid-base);margin-top:8px;font-weight:400}
    .tagline{color:#d4af37;font-size:var(--fluid-md);font-weight:600;margin:12px 0;letter-spacing:-0.2px}
    .section{background:var(--tg-theme-secondary-bg-color);backdrop-filter:blur(20px);border-radius:var(--radius-lg);padding:var(--spacing-xl) var(--spacing-lg);box-shadow:0 15px 45px rgba(212,175,55,0.28);border:1px solid var(--tg-theme-border-color);position:relative;overflow:hidden;margin-bottom:var(--spacing-lg)}
    .section::before{display:none}
    .field{margin-bottom:var(--spacing-lg);text-align:left}
    label{display:block;margin-bottom:10px;color:var(--tg-theme-text-color,#2d2d2d);font-weight:600;font-size:1.05rem;display:flex;align-items:center;gap:10px}
    label::before{content:attr(data-icon);font-size:1.25rem}
    input,textarea,select{width:100%;padding:var(--spacing-md);border-radius:var(--radius-md);border:1px solid var(--tg-theme-border-color,#e5e7eb);background:var(--tg-theme-secondary-bg-color,#fff);color:var(--tg-theme-text-color,#2d2d2d);font-size:var(--fluid-base);transition:all .3s ease;font-family:'Comfortaa',sans-serif}
    input:focus,textarea:focus,select:focus{outline:none;border-color:var(--tg-theme-button-color,#a78bfa);box-shadow:0 0 0 3px rgba(167,139,250,.15)}
    input.valid,textarea.valid{border-color:#4ade80}
    .birthdate-wrap{position:relative}
    #birthdate{padding-right:2.5rem;min-width:0}
    .birthdate-check{position:absolute;right:14px;top:50%;transform:translateY(-50%);pointer-events:none;color:#4ade80;font-size:1.25rem;display:none;font-weight:700}
    .birthdate-wrap.has-date .birthdate-check{display:block}
    .time-group{display:flex;flex-direction:row;align-items:center;gap:1rem;flex-wrap:wrap;margin:0}
    .time-group-input{flex:0 1 auto;min-width:0;width:100%;max-width:140px}
    .time-group-checkbox{margin:0;flex:0 0 auto;align-self:center}
    .checkbox{display:flex;align-items:center;gap:10px;margin-top:0}
    .checkbox input{width:22px;height:22px;min-width:22px;accent-color:#a78bfa;opacity:.75;background:rgba(255,255,255,.12);border-radius:6px}
    .time-group .checkbox input{opacity:.6;background:rgba(255,255,255,.08)}
    .checkbox label{margin-bottom:0;font-weight:500;color:var(--tg-theme-text-color,#2d2d2d);font-size:1rem;display:flex;align-items:center;gap:6px}
    .checkbox label::before{content:"‚ùì";font-size:1.2rem;opacity:.9}
    select{appearance:none;background:url("image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23a78bfa' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") no-repeat right 16px center;background-size:20px;padding-right:48px}
    textarea{min-height:140px;line-height:1.6;resize:vertical}
    .request-label{font-size:var(--fluid-md);text-align:center;margin-bottom:var(--spacing-sm);color:#a78bfa;font-weight:700;letter-spacing:-0.5px}
    .request-help-row{display:flex;align-items:center;justify-content:space-between;gap:var(--spacing-sm);margin-bottom:var(--spacing-sm)}
    .request-help-row .request-label{margin-bottom:0;text-align:left;font-size:var(--fluid-base);letter-spacing:-0.2px;line-height:1.2;flex:1;min-width:0}
    /* –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –æ—Ç–∫–∏–¥–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî —Å—Ç–∏–ª—å Apple */
    .quick-dropdown{position:relative;flex:1 1 auto;min-width:0;margin-bottom:var(--spacing-sm);min-width:120px}
    @media (max-width: 380px){
      .request-help-row{flex-wrap:wrap}
      .request-help-row .request-label{flex:1 1 100%;margin-bottom:var(--spacing-xs)}
      .quick-dropdown{flex:1 1 100%}
    }
    .request-help-toggle{width:100%;min-height:auto;margin:0;padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--radius-md);background:linear-gradient(135deg,rgba(212,175,55,0.2),rgba(212,175,55,0.12));color:#d4af37;border:1px solid rgba(212,175,55,0.5);box-shadow:none;text-transform:none;letter-spacing:0;font-size:var(--fluid-sm);font-weight:600;flex:0 0 auto;white-space:nowrap;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:all .2s}
    .request-help-toggle::after{content:'';width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:6px solid currentColor;margin-left:6px;opacity:.8;transition:transform .2s}
    .request-help-toggle.open::after{transform:rotate(180deg)}
    .request-help-toggle:hover{background:rgba(212,175,55,.25)}
    .request-examples{display:none;position:absolute;top:100%;left:0;right:0;margin-top:4px;padding:var(--spacing-xs);background:var(--tg-theme-bg-color);border:1px solid rgba(212,175,55,.35);border-radius:var(--radius-md);box-shadow:0 8px 24px rgba(0,0,0,.4);max-height:min(45vh,220px);overflow-y:auto;z-index:100;-webkit-overflow-scrolling:touch}
    .request-examples.open{display:block}
    .quick-list{display:flex;flex-direction:column;gap:2px;width:100%}
    .quick-list .example-btn{width:100% !important;padding:var(--spacing-sm) var(--spacing-md) !important;font-size:var(--fluid-sm) !important;line-height:1.3 !important;min-height:auto !important;border-radius:var(--radius-sm) !important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;box-sizing:border-box}
    .example-btn{width:auto;min-width:0;max-width:none;flex-shrink:0;white-space:normal;text-transform:none;letter-spacing:0;font-size:.95rem;font-weight:600;padding:12px 16px;margin:0;min-height:auto;border-radius:12px;box-shadow:none;word-wrap:break-word;word-break:break-word;overflow:visible}
    .example-btn::after{display:none}
    .example-btn:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(212,175,55,0.45)}
    button{background:linear-gradient(135deg, #d4af37, #ec4899, #d4af37);background-size:300% 300%;animation:gradientShift 4s ease infinite;color:var(--tg-theme-button-text-color);border:none;padding:18px 30px;font-size:1.05rem;border-radius:18px;width:100%;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 12px 35px rgba(212,175,55,0.6);margin-top:10px;letter-spacing:0;text-transform:none;min-height:58px;position:relative;overflow:hidden}
    button::after{display:none}
    button:hover{transform:translateY(-2px);box-shadow:0 14px 38px rgba(212,175,55,0.65)}
    button:active{transform:translateY(1px)}
    button:disabled{background:rgba(255,255,255,0.2);cursor:not-allowed;transform:none;box-shadow:none;opacity:.7}
    button.secondary{background:rgba(255,255,255,0.12);color:var(--tg-theme-text-color);border:1px solid var(--tg-theme-border-color);box-shadow:none;text-transform:none;letter-spacing:0;font-weight:600;min-height:56px}
    button.secondary:hover{background:rgba(255,255,255,0.18);box-shadow:0 6px 20px rgba(212,175,55,0.35)}
    .btn-group{display:flex;gap:15px;margin-top:25px}
    .btn-group button{flex:1}
    .price-tag{background:linear-gradient(90deg,#f9a8d4,#a78bfa);color:white;padding:12px 20px;border-radius:16px;font-size:1.4rem;font-weight:700;text-align:center;margin:20px 0;box-shadow:0 4px 15px rgba(249,168,212,.3);letter-spacing:1px}
    .payment-info{background:rgba(167,139,250,.05);border-left:4px solid #a78bfa;padding:15px;border-radius:0 12px 12px 0;margin:15px 0;font-size:.95rem;line-height:1.6}
    .payment-info::before{content:"üíé ";font-size:1.3rem}
    .success-icon{font-size:5rem;text-align:center;margin:20px 0;background:linear-gradient(90deg,#5eead4,#a78bfa);-webkit-background-clip:text;background-clip:text;color:transparent}
    .keys-composition{display:flex;align-items:center;justify-content:center;gap:20px;margin:25px 0;flex-wrap:wrap}
    .keys-composition svg{filter:drop-shadow(0 4px 12px rgba(167,139,250,.25));transition:transform .3s ease}
    .keys-composition .key-music{transform:rotate(-10deg);width:56px;height:80px}
    .keys-composition .key-door{transform:rotate(8deg);width:52px;height:80px}
    .keys-composition .key-music:hover,.keys-composition .key-door:hover{transform:rotate(0) scale(1.05)}
    .keys-composition-small{display:flex;align-items:center;justify-content:center;gap:12px;margin:15px 0}
    .keys-composition-small .key-music{width:36px;height:50px;transform:rotate(-8deg);opacity:.9}
    .keys-composition-small .key-door{width:34px;height:50px;transform:rotate(6deg);opacity:.9}
    .app-logo{display:block;margin:0 auto;max-width:220px;width:100%;height:auto;border-radius:0;box-shadow:0 10px 28px rgba(214,172,83,.22)}
    .app-logo.success{max-width:180px;margin-bottom:15px}
    .success-title{font-size:2.2rem;color:#a78bfa;font-weight:800;text-align:center;margin:20px 0;background:linear-gradient(90deg,#a78bfa,#f9a8d4);-webkit-background-clip:text;background-clip:text;color:transparent}
    .success-text{font-size:1.15rem;line-height:1.7;margin:20px 0;text-align:center;padding:0 10px}
    .loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px 40px;text-align:center;min-height:70vh}
    .spinner{width:60px;height:60px;border:5px solid rgba(167,139,250,.2);border-top-color:#a78bfa;border-radius:50%;margin:0 auto 25px;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loading-text{font-size:1.5rem;color:#a78bfa;font-weight:700;margin-bottom:15px}
    .song-preview{background:white;border-radius:16px;padding:20px;margin:20px 0;text-align:left;border:2px solid #a78bfa}
    .song-preview h3{color:#a78bfa;font-size:1.4rem;margin-bottom:10px;text-align:center}
    .song-preview p{font-size:1.05rem;line-height:1.7;color:var(--tg-theme-text-color,#2d2d2d)}
    footer{text-align:center;padding:30px 0 20px;color:#6b7280;font-size:.95rem;margin-top:auto}
    .birthplace-wrap{position:relative}
    .birthplace-suggestions{position:absolute;left:0;right:0;top:100%;margin-top:4px;background:var(--tg-theme-bg-color,#fff);border:1px solid var(--tg-theme-border-color,#e5e7eb);border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.12);max-height:220px;overflow-y:auto;z-index:50;list-style:none;padding:6px 0}
    .birthplace-suggestions li{padding:12px 16px;cursor:pointer;font-size:1rem;color:var(--tg-theme-text-color,#2d2d2d);border-bottom:1px solid var(--tg-theme-border-color,#f3f4f6);transition:background .15s}
    .birthplace-suggestions li:last-child{border-bottom:none}
    .birthplace-suggestions li:hover,.birthplace-suggestions li.selected{background:rgba(167,139,250,.12);color:#6d28d9}
    .birthplace-suggestions .place-type{font-size:.85rem;color:#6b7280;margin-top:2px}
    .birthplace-wrap{position:relative}
    #birthplace{padding-right:2.5rem;text-overflow:clip;min-width:0}
    .birthplace-check{position:absolute;right:14px;top:50%;transform:translateY(-50%);pointer-events:none;color:#4ade80;font-size:1.25rem;display:none;font-weight:700}
    .birthplace-wrap.has-place .birthplace-check{display:block}
    .birthplace-hint{margin-top:6px;font-size:.9rem;color:var(--tg-theme-hint-color,#6b7280)}
    /* Debug overlay for HOT payment */
    .hot-debug-toggle{position:fixed;right:12px;top:12px;z-index:100000;background:rgba(212,175,55,0.18);border:1px solid var(--tg-theme-border-color);color:var(--tg-theme-text-color);padding:8px 10px;border-radius:10px;font-size:12px;cursor:pointer;opacity:0.95;transition:all .2s;font-weight:700}
    .hot-debug-toggle:hover{opacity:1;box-shadow:0 6px 18px rgba(212,175,55,0.45)}
    .hot-debug-panel{position:fixed;right:12px;top:52px;z-index:100000;width:320px;max-height:360px;overflow-y:auto;background:rgba(10,10,26,0.96);border:1px solid var(--tg-theme-border-color);border-radius:12px;padding:10px 12px;box-shadow:0 14px 30px rgba(0,0,0,0.45);display:none}
    .hot-debug-panel h4{margin:0 0 8px 0;font-size:13px;color:var(--tg-theme-text-color)}
    .hot-debug-panel .row{font-size:12px;color:var(--tg-theme-hint-color);padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.08)}
    .hot-debug-panel .row:last-child{border-bottom:none}
    .payment-build-badge{display:none;align-items:center;gap:6px;background:rgba(212,175,55,0.14);border:1px solid rgba(212,175,55,0.35);color:#f8e7b0;padding:6px 10px;border-radius:999px;font-size:12px;margin-bottom:12px}
    
    #transitForm{display:none;margin-top:30px;padding:20px;background:var(--tg-theme-secondary-bg-color,rgba(255,255,255,0.05));border-radius:12px;border:1px solid var(--tg-theme-border-color,rgba(255,255,255,0.1))}
    #transitForm h3{color:var(--tg-theme-text-color,#fff);margin:0 0 15px 0;font-size:18px}
    #secondPersonForm{display:none;margin-top:30px;padding:20px;background:var(--tg-theme-secondary-bg-color,rgba(255,255,255,0.05));border-radius:12px;border:1px solid var(--tg-theme-border-color,rgba(255,255,255,0.1))}
    #secondPersonForm h3{color:var(--tg-theme-text-color,#fff);margin:0 0 15px 0;font-size:18px}
    
    /* –ü–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–≤—å—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ */
    .preview-nav{background:white;border-radius:16px;padding:12px;margin-bottom:25px;box-shadow:0 4px 20px rgba(167,139,250,.15);text-align:center;border:1px solid #e5e7eb;display:none}
    .preview-nav.show{display:block}
    .preview-nav-buttons{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:10px}
    .preview-nav button{background:white;color:#a78bfa;border:2px solid #a78bfa;padding:6px 14px;margin:0 4px;border-radius:20px;cursor:pointer;font-weight:600;transition:all .2s;font-size:.9rem;min-width:90px}
    .preview-nav button:hover{background:#a78bfa;color:white;transform:translateY(-2px)}
    .preview-nav button.active{background:linear-gradient(90deg,#a78bfa,#f9a8d4);color:white;border-color:transparent;box-shadow:0 4px 15px rgba(167,139,250,.3)}
    
    @media (max-width:480px){.container{padding:0 var(--spacing-sm)}h1{font-size:var(--fluid-2xl)}.subtitle{font-size:var(--fluid-base)}.tagline{font-size:var(--fluid-md)}.section{padding:var(--spacing-lg) var(--spacing-md)}.btn-group{flex-direction:column}.btn-group button{width:100%}button{font-size:1.15rem;padding:16px;min-height:60px}.price-tag{font-size:1.25rem;padding:10px 15px}.success-icon{font-size:4rem}.success-title{font-size:1.9rem}.success-text{font-size:1.05rem}.preview-nav-buttons{flex-direction:column;align-items:center}.preview-nav button{width:100%;max-width:200px}}
  </style>
</head>
<body>
  <!-- –ü–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–≤—å—é (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ) -->
  <div class="container">
    <div class="preview-nav" id="previewNav">
      <div style="font-weight:600;color:#a78bfa;margin-bottom:8px">üé® –†–µ–∂–∏–º –ø—Ä–µ–≤—å—é</div>
      <div class="preview-nav-buttons">
        <button class="active" data-page="home">–ì–ª–∞–≤–Ω–∞—è</button>
        <button data-page="form">–§–æ—Ä–º–∞</button>
        <button data-page="payment">–û–ø–ª–∞—Ç–∞</button>
        <button data-page="loading">–ó–∞–≥—Ä—É–∑–∫–∞</button>
        <button data-page="success">–£—Å–ø–µ—Ö</button>
      </div>
    </div>
  </div>

  <div id="langSwitcher" style="position:fixed;top:max(12px,env(safe-area-inset-top));right:max(16px,env(safe-area-inset-right));z-index:1000;font-size:13px;opacity:0.85;background:rgba(0,0,0,0.35);padding:6px 10px;border-radius:8px;min-height:32px;display:flex;align-items:center;">
    <span id="langRu" style="cursor:pointer;padding:2px 6px;border-radius:4px;">RU</span>
    <span style="opacity:0.5;">|</span>
    <span id="langEn" style="cursor:pointer;padding:2px 6px;border-radius:4px;">EN</span>
  </div>
  <div class="container">
    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div class="page active" id="homePage">
      <header>
        <h1>YupSoul</h1>
        <div id="homeTagline" class="tagline">–ò—Å—Å–ª–µ–¥—É–π —Å–≤–æ–∏ –≥—Ä–∞–Ω–∏ —Ç–∞–∫, –∫–∞–∫ —Ç—ã —ç—Ç–æ–≥–æ –∑–∞—Ö–æ—á–µ—à—å</div>
      </header>
      
      <div class="section">
        <img src="assets/logo-yupsoul.png" alt="YupSoul" class="app-logo" width="220" height="220">
        <p id="homeGreeting" class="tagline" style="margin-bottom:12px">–ó–∞—Ö–æ–¥–∏, –∫–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å –≤—Å–ø–æ–º–Ω–∏—Ç—å, –∫—Ç–æ —Ç—ã.</p>
        <button id="startBtn">–ù–∞—á–∞—Ç—å</button>
        <div id="masterNav" style="display:none; margin-top:20px">
          <button class="secondary" id="goHeroesBtn">üë• –ú–æ–∏ –≥–µ—Ä–æ–∏</button>
        </div>
        <div id="adminLinkWrap" style="display:none; margin-top:16px; text-align:center">
          <a href="#" id="adminLinkBtn" class="secondary" style="display:inline-block;padding:10px 20px;text-decoration:none;color:inherit;border-radius:8px;border:2px solid var(--tg-theme-button-color,#8b5cf6);color:var(--tg-theme-button-color,#8b5cf6)">üëë –ê–¥–º–∏–Ω–∫–∞</a>
        </div>
      </div>
      
      <footer>
        <p>YupSoul ‚Ä¢ 2026</p>
      </footer>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ú–æ–∏ –≥–µ—Ä–æ–∏¬ª (—Ç–∞—Ä–∏—Ñ –ú–∞—Å—Ç–µ—Ä) -->
    <div class="page" id="heroesPage">
      <header>
        <h1>–ú–æ–∏ –≥–µ—Ä–æ–∏</h1>
        <div class="subtitle">–ö–∞—Ä—Ç–æ—Ç–µ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
      </header>
      <div class="section">
        <div class="field">
          <label>–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏</label>
          <input type="text" id="heroesSearch" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è...">
        </div>
        <button class="secondary" id="heroesSearchBtn" style="margin-bottom:15px">–ò—Å–∫–∞—Ç—å</button>
        <div id="heroesList"></div>
        <button id="addHeroBtn" style="margin-top:15px">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è</button>
        <div id="heroFormWrap" style="display:none; margin-top:25px; padding-top:20px; border-top:1px solid #e5e7eb">
          <div class="field"><label for="heroName">–ò–º—è *</label><input type="text" id="heroName" placeholder="–ò–º—è –≥–µ—Ä–æ—è" required></div>
          <div class="field"><label for="heroBirthdate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label><input type="date" id="heroBirthdate"></div>
          <div class="field"><label for="heroBirthtime">–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è</label><input type="time" id="heroBirthtime"></div>
          <div class="field"><label for="heroBirthplace">–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è</label><input type="text" id="heroBirthplace" placeholder="–ì–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞"></div>
          <div class="checkbox" style="margin-bottom:15px"><input type="checkbox" id="heroBirthtimeUnknown"><label for="heroBirthtimeUnknown">–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è</label></div>
          <div class="field"><label for="heroGender">–ü–æ–ª</label><select id="heroGender"><option value="">–í—ã–±–µ—Ä–∏</option><option value="male">–ú—É–∂—Å–∫–æ–π</option><option value="female">–ñ–µ–Ω—Å–∫–∏–π</option><option value="other">–î—Ä—É–≥–æ–π</option></select></div>
          <div class="field"><label for="heroNotes">–î–æ—Å—å–µ / –∑–∞–º–µ—Ç–∫–∏</label><textarea id="heroNotes" placeholder="–ó–∞–º–µ—Ç–∫–∏ –æ –∫–ª–∏–µ–Ω—Ç–µ" rows="3"></textarea></div>
          <div class="btn-group">
            <button class="secondary" id="heroFormCancel">–û—Ç–º–µ–Ω–∞</button>
            <button id="heroFormSave">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </div>
      </div>
      <div class="btn-group" style="margin-top:20px">
        <button class="secondary" id="heroesBackBtn">‚Üê –ù–∞–∑–∞–¥</button>
      </div>
      <footer><p>YupSoul ‚Ä¢ 2026</p></footer>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ñ–æ—Ä–º—ã -->
    <div class="page" id="formPage">
      <header>
        <h1>YupSoul</h1>
      </header>
      
      <div class="section">
        <div class="step-panel" data-step="1">
          <div class="mode-selector">
            <h3>–¢–∏–ø –∫–ª—é—á–∞</h3>
            <p class="mode-subtitle">–û—Ç —ç—Ç–æ–≥–æ –∑–∞–≤–∏—Å—è—Ç –ø–æ–ª—è —Ñ–æ—Ä–º—ã –Ω–∏–∂–µ</p>
            <div class="mode-buttons">
              <button type="button" class="mode-btn active" data-mode="single">
                <span class="mode-label">–î–ª—è —Å–µ–±—è</span>
                <span class="mode-desc">–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑</span>
              </button>
              <button type="button" class="mode-btn" data-mode="couple">
                <span class="mode-label">–î–ª—è –¥–≤–æ–∏—Ö</span>
                <span class="mode-desc">–î—É—ç—Ç/–ø–∞—Ä–∞</span>
              </button>
              <button type="button" class="mode-btn" data-mode="transit">
                <span class="mode-label">–≠–Ω–µ—Ä–≥–∏—è –¥–Ω—è</span>
                <span class="mode-desc">–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞</span>
              </button>
            </div>
          </div>
        </div>

        <div class="step-panel" data-step="2">
        <div class="field">
            <input type="text" id="name" placeholder="–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?" required aria-label="–ò–º—è">
        </div>
        
        <div class="field">
          <div id="birthdateWrap" class="birthdate-wrap">
            <input type="date" id="birthdate" required aria-label="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è">
            <span id="birthdateCheck" class="birthdate-check" aria-hidden="true">‚úì</span>
          </div>
        </div>
        
        <div class="field">
          <div id="birthplaceWrap" class="birthplace-wrap">
              <input type="text" id="birthplace" placeholder="–ì–æ—Ä–æ–¥ –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∞ ‚Äî –≤—ã–±–µ—Ä–∏ –∏–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫" required autocomplete="off" aria-label="–õ–æ–∫–∞—Ü–∏—è —Ä–æ–∂–¥–µ–Ω–∏—è">
              <span id="birthplaceCheck" class="birthplace-check" aria-hidden="true">‚úì</span>
            <ul id="birthplaceSuggestions" class="birthplace-suggestions" aria-hidden="true"></ul>
          </div>
          <div id="birthplaceHint" class="birthplace-hint" style="display:none;">–í—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫ ‚Äî —Ç–∞–∫ –ø–æ–¥—Ç—è–Ω—É—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.</div>
        </div>
        
        <div class="field">
          <div class="time-group" role="group" aria-label="–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è">
            <input type="time" id="birthtime" required aria-label="–í—Ä–µ–º—è" class="time-group-input">
            <div class="checkbox time-group-checkbox">
              <input type="checkbox" id="unknown" aria-label="–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è">
              <label for="unknown">–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è</label>
            </div>
          </div>
        </div>
        
        <div class="field">
          <label for="gender" id="genderLabel">–ü–æ–ª</label>
          <select id="gender" required aria-label="–ü–æ–ª">
              <option value="">–í—ã–±–µ—Ä–∏</option>
            <option value="male">–ú—É–∂—Å–∫–æ–π</option>
            <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
          </select>
        </div>
        
        <div class="field">
            <select id="language" required aria-label="–Ø–∑—ã–∫ –ø–µ—Å–Ω–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è" title="–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å —è–∑—ã–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞">
              <option value="">–Ø–∑—ã–∫ –ø–µ—Å–Ω–∏</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English</option>
            <option value="de">Deutsch</option>
            <option value="fr">Fran√ßais</option>
            <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
          </select>
        </div>
        
          <div id="secondPersonForm" style="display:none">
            <h3 style="margin-bottom:12px;">–î–ª—è –¥–≤–æ–∏—Ö</h3>
          <div class="field">
            <input type="text" id="name2" placeholder="–ò–º—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞" maxlength="50">
          </div>
          <div class="field">
              <input type="date" id="birthdate2" max="2010-12-31" placeholder="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è">
          </div>
          <div class="field form-group location-input-wrapper">
              <input type="text" id="birthplace2" class="location-input" placeholder="–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ" maxlength="100" autocomplete="off">
            <div id="birthplaceSuggestions2" class="location-suggestions"></div>
          </div>
          <div class="field">
            <div class="time-group">
                <input type="time" id="birthtime2" style="flex:1" placeholder="–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è">
              <div class="checkbox" style="margin:0 0 0 15px">
                <input type="checkbox" id="unknown2">
                <label for="unknown2">–ù–µ –∑–Ω–∞—é</label>
              </div>
            </div>
          </div>
          <div class="field">
            <select id="gender2">
                <option value="">–ü–æ–ª</option>
              <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
              <option value="male">–ú—É–∂—Å–∫–æ–π</option>
            </select>
          </div>
        </div>
        
          <div id="transitForm" style="display:none">
            <h3 style="margin-bottom:12px;">–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞</h3>
          <div class="field">
              <input type="date" id="transitDate" min="2024-01-01" max="2030-12-31" placeholder="–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è">
          </div>
          <div class="field">
              <input type="time" id="transitTime" placeholder="–í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è">
          </div>
          <div class="field form-group location-input-wrapper">
              <input type="text" id="transitLocation" class="location-input" placeholder="–ì–æ—Ä–æ–¥ –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –º–æ–º–µ–Ω—Ç–∞" maxlength="100" autocomplete="off">
            <div id="transitLocationSuggestions" class="location-suggestions"></div>
            <div class="checkbox-group" style="margin-top: 10px;">
              <input type="checkbox" id="transitLocationConfirmed">
                <label for="transitLocationConfirmed">–õ–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ</label>
            </div>
          </div>
          <div class="field">
              <textarea id="transitIntent" placeholder="–ù–∞–º–µ—Ä–µ–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" rows="2" maxlength="200" style="min-height:60px"></textarea>
            </div>
          </div>
        </div>
        
        <div class="step-panel" data-step="3">
        <div class="field">
          <div class="request-help-row">
              <div class="request-label">–û—Ç–ø—Ä–∞–≤—å –∑–∞–ø—Ä–æ—Å</div>
              <div class="quick-dropdown">
                <button type="button" id="quickRequestsToggle" class="request-help-toggle" aria-expanded="false">–ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã</button>
                <div class="request-examples" id="quickRequestsPanel">
              <div class="quick-list" id="quickRequestsList" style="display:flex;flex-direction:column;gap:8px;">
                <button type="button" class="example-btn" data-text="–ì–∞—Ä–º–æ–Ω–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ">–ì–∞—Ä–º–æ–Ω–∏—è –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ</button>
                <button type="button" class="example-btn" data-text="–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –æ–ø–æ—Ä–∞ –Ω–∞ —Å–µ–±—è">–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ</button>
                <button type="button" class="example-btn" data-text="–†–∞—Å–∫—Ä—ã—Ç—å —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –±–µ–∑ —Å—Ç—Ä–∞—Ö–∞">–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</button>
                <button type="button" class="example-btn" data-text="–û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ –∏ –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏">–û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ</button>
                <button type="button" class="example-btn" data-text="–ë–∞–ª–∞–Ω—Å —Ä–∞–±–æ—Ç—ã –∏ –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏">–ë–∞–ª–∞–Ω—Å –∂–∏–∑–Ω–∏</button>
                <button type="button" class="example-btn" data-text="–î–æ–≤–µ—Ä—è—Ç—å –∂–∏–∑–Ω–∏ –∏ –æ—Ç–ø—É—Å–∫–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å">–î–æ–≤–µ—Ä–∏–µ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ</button>
                <button type="button" class="example-btn" data-text="–ò—Å—Ü–µ–ª–∏—Ç—å –¥–µ—Ç—Å–∫–∏–µ —Ç—Ä–∞–≤–º—ã –∏ –æ–±—Ä–µ—Å—Ç–∏ —Å–≤–æ–±–æ–¥—É">–ò—Å—Ü–µ–ª–µ–Ω–∏–µ –∏ —Å–≤–æ–±–æ–¥–∞</button>
                <button type="button" class="example-btn" data-text="–ù–∞–π—Ç–∏ —Å–≤–æ–π –ø—É—Ç—å –∫ —Å—á–∞—Å—Ç—å—é –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—é">–ü—É—Ç—å –∫ —Å—á–∞—Å—Ç—å—é</button>
                <button type="button" class="example-btn" data-text="–ú–æ—â–Ω–∞—è –ø–µ—Å–Ω—è –æ –º–æ–µ–π —Å–∏–ª–µ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–∏">–°–∏–ª–∞ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ</button>
                <button type="button" class="example-btn" data-text="–ú–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è –ø–µ—Å–Ω—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ –∏—Å—Ü–µ–ª–µ–Ω–∏—è">–ì–ª—É–±–∏–Ω–∞ –∏ —Ç–∏—à–∏–Ω–∞</button>
                <button type="button" class="example-btn" data-text="–¢—ë–ø–ª–∞—è –ø–µ—Å–Ω—è –æ –∑–∞–±–æ—Ç–µ –∏ –Ω–µ–∂–Ω–æ—Å—Ç–∏">–ù–µ–∂–Ω–æ—Å—Ç—å –∏ –∑–∞–±–æ—Ç–∞</button>
                <button type="button" class="example-btn" data-text="–í–µ—Å—ë–ª–∞—è –ø–µ—Å–Ω—è —Å —Å–∞–º–æ–∏—Ä–æ–Ω–∏–µ–π –ø—Ä–æ –º–æ–∏ —Å–ª–∞–±–æ—Å—Ç–∏">–Æ–º–æ—Ä –∏ –ª—ë–≥–∫–æ—Å—Ç—å</button>
              </div>
                </div>
              </div>
          </div>
            <textarea id="request" placeholder="–ö–∞–∫—É—é –≥—Ä–∞–Ω—å –±—É–¥–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è?" aria-label="–ó–∞–ø—Ä–æ—Å" rows="4"></textarea>
        </div>
        
        <div class="step-nav">
          <button id="stepNext">–ö –æ–ø–ª–∞—Ç–µ</button>
        </div>
      </div>
      
      <footer>
        <p>YupSoul ‚Ä¢ 2026</p>
      </footer>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–Ω–∞—Ç–æ–≤ / —Ä–µ–∫–≤–∏–∑–∏—Ç—ã -->
    <div class="page" id="paymentPage">
      <header>
        <h1>YupSoul</h1>
        <div class="subtitle">–¢–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á</div>
      </header>
      
      <div class="section">
        <div class="payment-build-badge">Build: c4eee97+dbg</div>
        <div class="tagline" style="margin-bottom:15px">–û–ø–ª–∞—Ç–∞ –∏ –¥–æ—Å—Ç—É–ø</div>
        <p id="paymentIntro" style="text-align:center;font-size:1.05rem;line-height:1.7;margin-bottom:16px">–ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è ‚Äî –≤ –ø–æ–¥–∞—Ä–æ–∫. –î–∞–ª—å—à–µ –º–æ–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–ª–∏ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø.</p>
        <div id="pricingNotice" style="background:rgba(212,175,55,0.12);border:1px solid rgba(212,175,55,0.4);border-radius:12px;padding:12px 14px;margin-bottom:14px;font-size:.92rem;color:rgba(255,255,255,0.95);">
          –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤...
        </div>
        <div id="priceSummary" style="background:rgba(212,175,55,0.08);border:1px solid rgba(212,175,55,0.3);border-radius:16px;padding:20px;margin:16px 0;">
          <div id="priceSummaryLabel" style="font-size:.95rem;color:rgba(255,255,255,0.9);">–¢–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç</div>
          <div id="priceLabel" style="font-size:1.15rem;font-weight:700;color:#fff;margin-top:6px;">‚Äî</div>
          <div id="priceValue" style="font-size:1.8rem;font-weight:800;color:#fff;margin-top:6px;">‚Äî</div>
          <div id="priceHint" style="font-size:.88rem;color:rgba(255,255,255,0.85);margin-top:6px;"></div>
        </div>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
          <input id="promoCodeInput" type="text" placeholder="–ü—Ä–æ–º–æ–∫–æ–¥" style="flex:1;min-width:180px;padding:10px 12px;border-radius:10px;border:1px solid rgba(212,175,55,.4);background:var(--tg-theme-secondary-bg-color);color:var(--tg-theme-text-color);text-transform:uppercase;">
          <button id="promoApplyBtn" type="button" class="secondary" style="min-width:140px;margin-top:0;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
        <div id="paymentStatus" style="display:none;background:rgba(212,175,55,.1);border:1px solid rgba(212,175,55,.35);border-radius:12px;padding:12px 14px;margin:14px 0;font-size:.92rem;color:rgba(255,255,255,.95);"></div>
        <div class="btn-group">
          <button class="secondary" id="backFromPaymentBtn">‚Üê –ù–∞–∑–∞–¥</button>
          <button id="payBtn">–û—Ñ–æ—Ä–º–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
      </div>
      
      <footer>
        <p>YupSoul ‚Ä¢ 2026</p>
      </footer>
      
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="page" id="loadingPage">
      <div class="loading">
        <div class="spinner"></div>
        <div class="loading-text">–°–æ–∑–¥–∞—é —Ç–≤–æ–π –∫–ª—é—á...</div>
        <div id="loadingDesc" style="color:#6b7280;font-size:1.1rem;text-align:center;max-width:400px">–ú–∞–≥–∏—è —Ç–≤–æ—Ä–∏—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –¢–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–≤–æ–∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.</div>
      </div>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—Ö–∞ -->
    <div class="page" id="successPage">
      <header>
        <h1>YupSoul</h1>
        <div class="subtitle">–ö–ª—é—á –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!</div>
      </header>
      
      <div class="section">
        <img src="assets/logo-yupsoul.png" alt="YupSoul" class="app-logo success" width="180" height="180">
        <h2 class="success-title">–ì–æ—Ç–æ–≤–æ!</h2>
        <p class="success-text">
          –¢–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Å–æ–∑–¥–∞–Ω! –≠—Ç–æ —Ç–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–∏–ª—ã –¥–ª—è –∏–≥—Ä—ã –∂–∏–∑–Ω–∏.
        </p>
        
        <div class="song-preview">
          <h3>üéµ –¢–≤–æ—è –ø–µ—Å–Ω—è</h3>
          <p id="songPreviewText">
            –¢–≤–æ—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞—É–¥–∏–æ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —É–∂–µ –∂–¥—ë—Ç —Ç–µ–±—è –≤ –±–æ—Ç–µ. –°–ª—É—à–∞–π –µ—ë –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å—Å—è –Ω–∞ –≤–æ–ª–Ω—É —É—Å–ø–µ—Ö–∞.
          </p>
        </div>
        
        <div style="background:rgba(167,139,250,.08);border-radius:12px;padding:15px;margin:20px 0;text-align:center;font-size:1.05rem;line-height:1.7">
          <strong>–ß—Ç–æ –¥–∞–ª—å—à–µ:</strong><br>
          –û—Ç–∫—Ä–æ–π –±–æ—Ç–∞ <a href="https://t.me/Yup_Soul_bot" style="color:#a78bfa;text-decoration:underline">@Yup_Soul_bot</a> –≤ Telegram ‚Äî —Ç–∞–º —Ç–µ–±—è –∂–¥—ë—Ç —Ç–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á.
        </div>
        
        <div id="soulChatHint" class="soul-chat-hint" style="background:rgba(167,139,250,.06);border-radius:12px;padding:12px 14px;margin:12px 0 0 0;font-size:.95rem;line-height:1.5;color:var(--tg-theme-hint-color,#6b7280);display:none"></div>
        <button class="secondary" id="soulChatBtn" type="button" style="margin-top:15px">–ü–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å –¥—É—à–æ–π</button>
        <button class="secondary" id="soulChatPayBtn" type="button" style="margin-top:8px;display:none;font-size:.9rem">–ö –æ–ø–ª–∞—Ç–µ ‚Äî Soul Basic / Soul Plus</button>
        <button class="secondary" id="newKeyBtn" style="margin-top:15px">–°–æ–∑–¥–∞—Ç—å –µ—â—ë –æ–¥–∏–Ω –∫–ª—é—á</button>
      </div>
      
      <footer>
        <p>YupSoul ‚Ä¢ 2026</p>
      </footer>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É¬ª (—Ä–µ–¥–∏—Ä–µ–∫—Ç —Å HOT) -->
    <div class="page" id="paymentThanksPage">
      <header>
        <h1>YupSoul</h1>
        <div class="subtitle">–∑–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞</div>
      </header>
      <div class="section" style="text-align:center; padding: 40px 20px">
        <div class="success-icon" style="font-size:4rem; margin-bottom:20px">‚úì</div>
        <h2 class="success-title" style="font-size:1.6rem; margin:0 0 16px 0">–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É</h2>
        <p class="success-text" id="paymentThanksMessage" style="margin:0 0 24px 0; font-size:1rem">
          –ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞. –ü–µ—Å–Ω—è —É—à–ª–∞ –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–ø–ª–∞—á–∏–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ. –ß–µ—Ä–µ–∑ 2‚Äì3 –º–∏–Ω—É—Ç—ã –ø—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º.
        </p>
        <button id="paymentThanksBackBtn" class="primary">–ì–æ—Ç–æ–≤–æ</button>
      </div>
      <footer><p>YupSoul ‚Ä¢ 2026</p></footer>
    </div>
    
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var tg = null;
      var INIT_DATA_STORAGE_KEY = 'tg_init_data';
      var LANG_STORAGE_KEY = 'yupsoul_lang';
      var LANG = {
        ru: {
          tagline: '–ò—Å—Å–ª–µ–¥—É–π —Å–≤–æ–∏ –≥—Ä–∞–Ω–∏ —Ç–∞–∫, –∫–∞–∫ —Ç—ã —ç—Ç–æ–≥–æ –∑–∞—Ö–æ—á–µ—à—å',
          startBtn: '–ù–∞—á–∞—Ç—å', myHeroes: 'üë• –ú–æ–∏ –≥–µ—Ä–æ–∏', admin: 'üëë –ê–¥–º–∏–Ω–∫–∞',
          heroesTitle: '–ú–æ–∏ –≥–µ—Ä–æ–∏', heroesSubtitle: '–ö–∞—Ä—Ç–æ—Ç–µ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤',
          searchByName: '–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏', searchPlaceholder: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è...', searchBtn: '–ò—Å–∫–∞—Ç—å',
          addHero: '‚ûï –î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è', heroName: '–ò–º—è *', heroBirthdate: '–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è', heroBirthtime: '–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è',
          heroBirthplace: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è', heroBirthplacePh: '–ì–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞', heroNotes: '–î–æ—Å—å–µ / –∑–∞–º–µ—Ç–∫–∏', heroNotesPh: '–ó–∞–º–µ—Ç–∫–∏ –æ –∫–ª–∏–µ–Ω—Ç–µ',
          unknownTime: '–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è', cancel: '–û—Ç–º–µ–Ω–∞', save: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å', back: '‚Üê –ù–∞–∑–∞–¥',
          gender: '–ü–æ–ª', genderSelect: '–í—ã–±–µ—Ä–∏', male: '–ú—É–∂—Å–∫–æ–π', female: '–ñ–µ–Ω—Å–∫–∏–π', other: '–î—Ä—É–≥–æ–π',
          modeType: '–¢–∏–ø –∫–ª—é—á–∞', modeSubtitle: '–û—Ç —ç—Ç–æ–≥–æ –∑–∞–≤–∏—Å—è—Ç –ø–æ–ª—è —Ñ–æ—Ä–º—ã –Ω–∏–∂–µ',
          modeSingle: '–î–ª—è —Å–µ–±—è', modeSingleDesc: '–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑',
          modeCouple: '–î–ª—è –¥–≤–æ–∏—Ö', modeCoupleDesc: '–î—É—ç—Ç/–ø–∞—Ä–∞',
          modeTransit: '–≠–Ω–µ—Ä–≥–∏—è –¥–Ω—è', modeTransitDesc: '–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞',
          namePh: '–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?', birthdateLabel: '–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è', birthplacePh: '–ì–æ—Ä–æ–¥ –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∞ ‚Äî –≤—ã–±–µ—Ä–∏ –∏–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫',
          birthplaceHint: '–í—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫ ‚Äî —Ç–∞–∫ –ø–æ–¥—Ç—è–Ω—É—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.',
          unknownTimeShort: '–ù–µ –∑–Ω–∞—é', secondPersonTitle: '–î–ª—è –¥–≤–æ–∏—Ö', name2Ph: '–ò–º—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
          birthplace2Ph: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ', birthtime2Ph: '–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è',
          transitTitle: '–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞', transitDatePh: '–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è', transitTimePh: '–í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è',
          transitLocationPh: '–ì–æ—Ä–æ–¥ –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –º–æ–º–µ–Ω—Ç–∞', transitLocationOk: '–õ–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ',
          transitIntentPh: '–ù–∞–º–µ—Ä–µ–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)',
          sendRequest: '–û—Ç–ø—Ä–∞–≤—å –∑–∞–ø—Ä–æ—Å', quickRequests: '–ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã', hide: '–°–∫—Ä—ã—Ç—å',
          requestPh: '–ö–∞–∫—É—é –≥—Ä–∞–Ω—å –±—É–¥–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è?', toPayment: '–ö –æ–ø–ª–∞—Ç–µ',
          paymentSubtitle: '–¢–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á', paymentAndAccess: '–û–ø–ª–∞—Ç–∞ –∏ –¥–æ—Å—Ç—É–ø',
          paymentIntro: '–ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è ‚Äî –≤ –ø–æ–¥–∞—Ä–æ–∫. –î–∞–ª—å—à–µ –º–æ–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–ª–∏ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø.',
          loadingPricing: '–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤...', currentItem: '–¢–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç',
          promoCode: '–ü—Ä–æ–º–æ–∫–æ–¥', apply: '–ü—Ä–∏–º–µ–Ω–∏—Ç—å', backFromPayment: '‚Üê –ù–∞–∑–∞–¥',
          submitAndContinue: '–û—Ñ–æ—Ä–º–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å', submitRequest: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É',
          firstFree: '–ü–µ—Ä–≤—ã–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ—Å–ø–ª–∞—Ç–Ω–æ.',
          paymentRequired: '–û–ø–ª–∞—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫.',
          promoApplied: '–ü—Ä–æ–º–æ–∫–æ–¥ {code}: -{amount} {currency}',
          creatingKey: '–°–æ–∑–¥–∞—é —Ç–≤–æ–π –∫–ª—é—á...',
          creatingKeyDesc: '–ú–∞–≥–∏—è —Ç–≤–æ—Ä–∏—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –¢–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–≤–æ–∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.',
          keyActivated: '–ö–ª—é—á –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!', done: '–ì–æ—Ç–æ–≤–æ!',
          successText: '–¢–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Å–æ–∑–¥–∞–Ω! –≠—Ç–æ —Ç–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–∏–ª—ã –¥–ª—è –∏–≥—Ä—ã –∂–∏–∑–Ω–∏.',
          yourSong: 'üéµ –¢–≤–æ—è –ø–µ—Å–Ω—è',
          songPreviewText: '–¢–≤–æ—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞—É–¥–∏–æ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —É–∂–µ –∂–¥—ë—Ç —Ç–µ–±—è –≤ –±–æ—Ç–µ. –°–ª—É—à–∞–π –µ—ë –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å—Å—è –Ω–∞ –≤–æ–ª–Ω—É —É—Å–ø–µ—Ö–∞.',
          whatNext: '–ß—Ç–æ –¥–∞–ª—å—à–µ:', openBot: '–û—Ç–∫—Ä–æ–π –±–æ—Ç–∞',
          soulChat: '–ü–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å –¥—É—à–æ–π', soulChatPay: '–ö –æ–ø–ª–∞—Ç–µ ‚Äî Soul Basic / Soul Plus',
          newKey: '–°–æ–∑–¥–∞—Ç—å –µ—â—ë –æ–¥–∏–Ω –∫–ª—é—á',
          paymentThanks: '–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É', thanksSubtitle: '–∑–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞',
          songInProgress: '–ü–µ—Å–Ω—è —É—à–ª–∞ –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é. –ß–µ—Ä–µ–∑ 2‚Äì3 –º–∏–Ω—É—Ç—ã –ø—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º.',
          songInProgressConfirmed: '–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞. –ü–µ—Å–Ω—è —É—à–ª–∞ –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–ø–ª–∞—á–∏–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ. –ß–µ—Ä–µ–∑ 2‚Äì3 –º–∏–Ω—É—Ç—ã –ø—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º.',
          thanksDone: '–ì–æ—Ç–æ–≤–æ',
          notFromTelegram: '–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º –≤ Telegram (–∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é) ‚Äî –∏–Ω–∞—á–µ –∑–∞—è–≤–∫–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è.',
          notFound: '–ù–µ –Ω–∞–π–¥–µ–Ω–æ', searchError: '–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞',
          soulChatLoad: '–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶',
          soulChatHasAccess: '–£ —Ç–µ–±—è –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ Soul Chat. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –±–æ—Ç. –í –±–æ—Ç–µ –Ω–∞–ø–∏—à–∏ /soulchat –∏ –∑–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å —Å–≤–æ–µ–π –¥—É—à–µ.',
          soulChatNoAccess: 'Soul Chat ‚Äî –¥–∏–∞–ª–æ–≥–∏ —Å –¥—É—à–æ–π. –î–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ Soul Basic (10 –¥–∏–∞–ª–æ–≥–æ–≤/–º–µ—Å) –∏–ª–∏ Soul Plus (30 –¥–∏–∞–ª–æ–≥–æ–≤/–º–µ—Å).',
          soulChatDefault: 'Soul Chat ‚Äî –¥–∏–∞–ª–æ–≥–∏ —Å –¥—É—à–æ–π –ø–æ –∑–∞—è–≤–∫–µ. –î–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ.',
          soulChatNoApi: 'Soul Chat ‚Äî –¥–∏–∞–ª–æ–≥–∏ —Å –¥—É—à–æ–π –ø–æ –∑–∞—è–≤–∫–µ. –î–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ Soul Basic –∏–ª–∏ Soul Plus. –û—Ñ–æ—Ä–º–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: ¬´–ö –æ–ø–ª–∞—Ç–µ¬ª.',
          greeting: '–ü—Ä–∏–≤–µ—Ç, {name}! –ó–∞—Ö–æ–¥–∏, –∫–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å –≤—Å–ø–æ–º–Ω–∏—Ç—å, –∫—Ç–æ —Ç—ã.',
          greetingDefault: '–ó–∞—Ö–æ–¥–∏, –∫–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å –≤—Å–ø–æ–º–Ω–∏—Ç—å, –∫—Ç–æ —Ç—ã.',
          alertNameShort: '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞', alertBirthdate: '–í—ã–±–µ—Ä–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è',
          alertBirthplace: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞', alertBirthplaceHint: '–í—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫',
          alertBirthtime: '–£–∫–∞–∂–∏ –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–º–µ—Ç—å "–ù–µ –∑–Ω–∞—é"', alertGender: '–£–∫–∞–∂–∏ –ø–æ–ª', alertLanguage: '–í—ã–±–µ—Ä–∏ —è–∑—ã–∫',
          alertName2Short: '–ò–º—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ ‚Äî –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞', alertBirthdate2: '–£–∫–∞–∂–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
          alertBirthplace2: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞',
          alertBirthtime2: '–£–∫–∞–∂–∏ –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞', alertGender2: '–í—ã–±–µ—Ä–∏ –ø–æ–ª –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
          alertTransitDate: '–£–∫–∞–∂–∏ –¥–∞—Ç—É —Å–æ–±—ã—Ç–∏—è', alertTransitLocation: '–£–∫–∞–∂–∏ –ª–æ–∫–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏—è', alertTransitConfirm: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏, —á—Ç–æ –ª–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ',
          alertRequestShort: '–î–æ–±–∞–≤—å –∑–∞–ø—Ä–æ—Å (5+ —Å–∏–º–≤–æ–ª–æ–≤)', alertRequestLong: '–†–∞—Å—Å–∫–∞–∂–∏ –í—Å–µ–ª–µ–Ω–Ω–æ–π –ø–æ–¥—Ä–æ–±–Ω–µ–µ (–º–∏–Ω–∏–º—É–º 15 —Å–∏–º–≤–æ–ª–æ–≤)',
          alertYourPath: '–í—ã–±–µ—Ä–∏ —Å–≤–æ–π –ø—É—Ç—å', alertNoApi: '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–¥—Ä–µ—Å API.', alertOpenFromBot: '–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º –≤ Telegram ‚Äî –∏–Ω–∞—á–µ –∑–∞—è–≤–∫—É –Ω–µ–ª—å–∑—è –ø—Ä–∏–Ω—è—Ç—å.',
          alertServerSleep: '–°–µ—Ä–≤–µ—Ä –ø—Ä–æ—Å–Ω—É–ª—Å—è –Ω–µ —Å—Ä–∞–∑—É. –ü–æ–¥–æ–∂–¥–∏ –æ–∫–æ–ª–æ –º–∏–Ω—É—Ç—ã –∏ –Ω–∞–∂–º–∏ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É¬ª —Å–Ω–æ–≤–∞.',
          universeHeard: '‚ú® {name}, –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å.\n\n–¢–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –æ–Ω –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç.',
          universeHeardCouple: '‚ú® {name} –∏ {name2}, –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ –≤–∞—à –∑–∞–ø—Ä–æ—Å.\n\n–í–∞—à –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –æ–Ω –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç.',
          universeHeardTransit: '‚ú® {name}, –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å.\n\n–ó–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –≠–Ω–µ—Ä–≥–∏–∏ –î–Ω—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –æ–Ω –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç.',
          langSong: '–Ø–∑—ã–∫ –ø–µ—Å–Ω–∏', langRu: '–†—É—Å—Å–∫–∏–π', langEn: 'English', langDe: 'Deutsch', langFr: 'Fran√ßais', langUk: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞',
          quick1: '–ì–∞—Ä–º–æ–Ω–∏—è –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ', quick2: '–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ', quick3: '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª', quick4: '–û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ',
          quick5: '–ë–∞–ª–∞–Ω—Å –∂–∏–∑–Ω–∏', quick6: '–î–æ–≤–µ—Ä–∏–µ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ', quick7: '–ò—Å—Ü–µ–ª–µ–Ω–∏–µ –∏ —Å–≤–æ–±–æ–¥–∞', quick8: '–ü—É—Ç—å –∫ —Å—á–∞—Å—Ç—å—é',
          quick9: '–°–∏–ª–∞ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ', quick10: '–ì–ª—É–±–∏–Ω–∞ –∏ —Ç–∏—à–∏–Ω–∞', quick11: '–ù–µ–∂–Ω–æ—Å—Ç—å –∏ –∑–∞–±–æ—Ç–∞', quick12: '–Æ–º–æ—Ä –∏ –ª—ë–≥–∫–æ—Å—Ç—å',
          quick1t: '–ì–∞—Ä–º–æ–Ω–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ', quick2t: '–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –æ–ø–æ—Ä–∞ –Ω–∞ —Å–µ–±—è',
          quick3t: '–†–∞—Å–∫—Ä—ã—Ç—å —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –±–µ–∑ —Å—Ç—Ä–∞—Ö–∞', quick4t: '–û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ –∏ –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
          quick5t: '–ë–∞–ª–∞–Ω—Å —Ä–∞–±–æ—Ç—ã –∏ –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏', quick6t: '–î–æ–≤–µ—Ä—è—Ç—å –∂–∏–∑–Ω–∏ –∏ –æ—Ç–ø—É—Å–∫–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å',
          quick7t: '–ò—Å—Ü–µ–ª–∏—Ç—å –¥–µ—Ç—Å–∫–∏–µ —Ç—Ä–∞–≤–º—ã –∏ –æ–±—Ä–µ—Å—Ç–∏ —Å–≤–æ–±–æ–¥—É', quick8t: '–ù–∞–π—Ç–∏ —Å–≤–æ–π –ø—É—Ç—å –∫ —Å—á–∞—Å—Ç—å—é –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—é',
          quick9t: '–ú–æ—â–Ω–∞—è –ø–µ—Å–Ω—è –æ –º–æ–µ–π —Å–∏–ª–µ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–∏', quick10t: '–ú–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è –ø–µ—Å–Ω—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ –∏—Å—Ü–µ–ª–µ–Ω–∏—è',
          quick11t: '–¢—ë–ø–ª–∞—è –ø–µ—Å–Ω—è –æ –∑–∞–±–æ—Ç–µ –∏ –Ω–µ–∂–Ω–æ—Å—Ç–∏', quick12t: '–í–µ—Å—ë–ª–∞—è –ø–µ—Å–Ω—è —Å —Å–∞–º–æ–∏—Ä–æ–Ω–∏–µ–π –ø—Ä–æ –º–æ–∏ —Å–ª–∞–±–æ—Å—Ç–∏',
          promoError: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥',
          promoCleared: '–ü—Ä–æ–º–æ–∫–æ–¥ –æ—á–∏—â–µ–Ω.', promoApplied: '–ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω: –∏—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ {amount} {currency}',
          promoAppliedHint: '–ü—Ä–æ–º–æ–∫–æ–¥ {code}: -{amount} {currency}',
          paymentRequiredOpening: '–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞. –û—Ç–∫—Ä—ã–≤–∞—é HOT Checkout...',
          promoFreeGen: '–ü—Ä–æ–º–æ–∫–æ–¥ –¥–∞–ª –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é. –ó–∞–ø—É—Å–∫...',
          hotCheckoutOpened: '–û—Ç–∫—Ä—ã—Ç HOT Checkout. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –≤–µ—Ä–Ω–∏—Å—å –≤ Mini App ‚Äî —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.',
          paymentNotConfirmed: '–û–ø–ª–∞—Ç–∞ –ø–æ–∫–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å –ø–æ–∑–∂–µ –∏–ª–∏ –æ—Ç–∫—Ä–æ–π –æ–ø–ª–∞—Ç—É –ø–æ–≤—Ç–æ—Ä–Ω–æ.',
          paymentConfirmed: '–û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ó–∞–ø—É—Å–∫–∞—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...',
          paymentReceivedNoStart: '–û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞, –Ω–æ –∞–≤—Ç–æ‚Äë—Å—Ç–∞—Ä—Ç –Ω–µ —É–¥–∞–ª—Å—è. –ó–∞–ø—É—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤ –∞–¥–º–∏–Ω–∫–µ –ø–æ request_id: {id}',
          submitFailed: '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É. –ü–æ–¥–æ–∂–¥–∏ –º–∏–Ω—É—Ç—É –∏ –Ω–∞–∂–º–∏ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É¬ª —Å–Ω–æ–≤–∞ –∏–ª–∏ –æ—Ç–∫—Ä–æ–π Mini App –∑–∞–Ω–æ–≤–æ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º.',
          errorOp: '–û—à–∏–±–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–ø–ª–∞—Ç—ã/–∑–∞—è–≤–∫–∏'
        },
        en: {
          tagline: 'Explore your edges the way you want',
          startBtn: 'Start', myHeroes: 'üë• My Heroes', admin: 'üëë Admin',
          heroesTitle: 'My Heroes', heroesSubtitle: 'Client directory',
          searchByName: 'Search by name', searchPlaceholder: 'Enter name...', searchBtn: 'Search',
          addHero: '‚ûï Add Hero', heroName: 'Name *', heroBirthdate: 'Date of birth', heroBirthtime: 'Time of birth',
          heroBirthplace: 'Place of birth', heroBirthplacePh: 'City, country', heroNotes: 'Notes', heroNotesPh: 'Client notes',
          unknownTime: "I don't know exact time", cancel: 'Cancel', save: 'Save', back: '‚Üê Back',
          gender: 'Gender', genderSelect: 'Choose', male: 'Male', female: 'Female', other: 'Other',
          modeType: 'Key type', modeSubtitle: 'This determines the form fields below',
          modeSingle: 'For myself', modeSingleDesc: 'Deep analysis',
          modeCouple: 'For two', modeCoupleDesc: 'Duet / couple',
          modeTransit: 'Day energy', modeTransitDesc: 'Energy of the moment',
          namePh: "What's your name?", birthdateLabel: 'Date of birth', birthplacePh: 'City or country ‚Äî choose from suggestions',
          birthplaceHint: 'Pick a location from the suggestions ‚Äî coordinates will be added automatically.',
          unknownTimeShort: "Don't know", secondPersonTitle: 'For two', name2Ph: "Second person's name",
          birthplace2Ph: "Second person's place of birth", birthtime2Ph: 'Time of birth',
          transitTitle: 'Energy of the moment', transitDatePh: 'Event date', transitTimePh: 'Event time',
          transitLocationPh: 'City for the moment energy', transitLocationOk: 'Location is correct',
          transitIntentPh: 'Intention for this moment (optional)',
          sendRequest: 'Send request', quickRequests: 'Quick requests', hide: 'Hide',
          requestPh: 'What would you like to explore today?', toPayment: 'To payment',
          paymentSubtitle: 'Your sound key', paymentAndAccess: 'Payment & access',
          paymentIntro: 'First song is free. You can pay for individual items or subscribe for full access.',
          loadingPricing: 'Loading plans...', currentItem: 'Current item',
          promoCode: 'Promo code', apply: 'Apply', backFromPayment: '‚Üê Back',
          submitAndContinue: 'Checkout & continue', submitRequest: 'Submit request',
          firstFree: 'Your first sound key is free.',
          paymentRequired: 'Payment required for new requests.',
          promoApplied: 'Promo {code}: -{amount} {currency}',
          creatingKey: 'Creating your key...',
          creatingKeyDesc: 'Magic happens in real time. Your personal sound key is being formed from your unique data.',
          keyActivated: 'Key activated!', done: 'Done!',
          successText: 'Your personal sound key is created! Your unique artifact of strength for the game of life.',
          yourSong: 'üéµ Your song',
          songPreviewText: 'Your unique audio piece is waiting for you in the bot. Listen every morning to tune into success.',
          whatNext: 'What next:', openBot: 'Open the bot',
          soulChat: 'Talk to your soul', soulChatPay: 'To payment ‚Äî Soul Basic / Soul Plus',
          newKey: 'Create another key',
          paymentThanks: 'Thank you for payment', thanksSubtitle: 'request accepted',
          songInProgress: 'Song is being generated. It will arrive in the bot chat in 2‚Äì3 minutes.',
          songInProgressConfirmed: 'Request accepted. Song is being generated ‚Äî no need to pay again. It will arrive in the bot chat in 2‚Äì3 minutes.',
          thanksDone: 'Done',
          notFromTelegram: 'Open the app from the bot chat in Telegram (menu button) ‚Äî otherwise the request cannot be sent.',
          notFound: 'Not found', searchError: 'Search error',
          soulChatLoad: 'Loading‚Ä¶',
          soulChatHasAccess: "You have Soul Chat access. Tap below ‚Äî the bot will open. In the bot, type /soulchat and ask your soul a question.",
          soulChatNoAccess: 'Soul Chat ‚Äî dialogues with your soul. Available with Soul Basic (10/month) or Soul Plus (30/month) subscription.',
          soulChatDefault: 'Soul Chat ‚Äî dialogues with your soul per request. Available by subscription.',
          soulChatNoApi: 'Soul Chat ‚Äî dialogues with your soul. Available with Soul Basic or Soul Plus subscription. Go to ¬´To payment¬ª in the app.',
          greeting: "Hi, {name}! Come back whenever you want to remember who you are.",
          greetingDefault: "Come back whenever you want to remember who you are.",
          alertNameShort: 'Name must be at least 2 characters', alertBirthdate: 'Choose date of birth',
          alertBirthplace: 'Place of birth must be at least 3 characters', alertBirthplaceHint: 'Pick a location from the suggestions',
          alertBirthtime: 'Enter time of birth or check "Don\'t know"', alertGender: 'Select gender', alertLanguage: 'Choose language',
          alertName2Short: "Second person's name ‚Äî at least 2 characters", alertBirthdate2: "Enter second person's date of birth",
          alertBirthplace2: "Second person's place of birth must be at least 3 characters",
          alertBirthtime2: "Enter second person's time of birth", alertGender2: "Select second person's gender",
          alertTransitDate: 'Enter event date', alertTransitLocation: 'Enter event location', alertTransitConfirm: 'Confirm the location is correct',
          alertRequestShort: 'Add a request (5+ characters)', alertRequestLong: 'Tell the Universe more (at least 15 characters)',
          alertYourPath: 'Choose your path', alertNoApi: 'API address not configured.', alertOpenFromBot: 'Open the app from the bot chat in Telegram ‚Äî otherwise the request cannot be accepted.',
          alertServerSleep: 'Server was slow to wake up. Wait about a minute and tap ¬´Submit request¬ª again.',
          universeHeard: '‚ú® {name}, the Universe heard your request.\n\nYour sound key is being created. It will arrive in this chat in 2‚Äì3 minutes.',
          universeHeardCouple: '‚ú® {name} and {name2}, the Universe heard your request.\n\nYour sound key is being created. It will arrive in this chat in 2‚Äì3 minutes.',
          universeHeardTransit: '‚ú® {name}, the Universe heard your request.\n\nYour Day Energy sound key is being created. It will arrive in this chat in 2‚Äì3 minutes.',
          langSong: 'Song language', langRu: 'Russian', langEn: 'English', langDe: 'German', langFr: 'French', langUk: 'Ukrainian',
          quick1: 'Harmony and self-love', quick2: 'Confidence and purpose', quick3: 'Creative potential', quick4: 'Let go of the past',
          quick5: 'Life balance', quick6: 'Trust and acceptance', quick7: 'Healing and freedom', quick8: 'Path to happiness',
          quick9: 'Strength and overcoming', quick10: 'Depth and silence', quick11: 'Tenderness and care', quick12: 'Humor and lightness',
          quick1t: 'Harmony in relationships and self-love', quick2t: 'Confidence, purpose, and self-reliance',
          quick3t: 'Unlock creative potential without fear', quick4t: 'Let go of the past and open to new possibilities',
          quick5t: 'Balance of work and personal life', quick6t: 'Trust life and release control',
          quick7t: 'Heal childhood wounds and find freedom', quick8t: 'Find your path to happiness and peace',
          quick9t: 'Powerful song about my strength and overcoming', quick10t: 'Meditative song for practice and healing',
          quick11t: 'Warm song about care and tenderness', quick12t: 'Playful song with self-irony about my quirks',
          promoError: 'Could not apply promo code',
          promoCleared: 'Promo code cleared.', promoApplied: 'Promo applied: final amount {amount} {currency}',
          promoAppliedHint: 'Promo {code}: -{amount} {currency}',
          paymentRequiredOpening: 'Payment required. Opening HOT Checkout...',
          promoFreeGen: 'Promo gives free generation. Starting...',
          hotCheckoutOpened: 'HOT Checkout opened. After payment, return to the Mini App ‚Äî status will update automatically.',
          paymentNotConfirmed: 'Payment not yet confirmed. Check status later or open payment again.',
          paymentConfirmed: 'Payment confirmed. Starting generation...',
          paymentReceivedNoStart: 'Payment received, but auto-start failed. Start generation in admin by request_id: {id}',
          submitFailed: 'Could not submit request. Wait a minute and tap ¬´Submit request¬ª again or reopen the Mini App from the bot chat.',
          errorOp: 'Payment/request operation error'
        },
        de: {
          tagline: 'Erkunde deine Facetten, wie du es m√∂chtest',
          startBtn: 'Start', myHeroes: 'üë• Meine Helden', admin: 'üëë Admin',
          heroesTitle: 'Meine Helden', heroesSubtitle: 'Klientenkartei',
          searchByName: 'Suche nach Name', searchPlaceholder: 'Name eingeben...', searchBtn: 'Suchen',
          addHero: '‚ûï Held hinzuf√ºgen', heroName: 'Name *', heroBirthdate: 'Geburtsdatum', heroBirthtime: 'Geburtszeit',
          heroBirthplace: 'Geburtsort', heroBirthplacePh: 'Stadt, Land', heroNotes: 'Notizen', heroNotesPh: 'Klientennotizen',
          unknownTime: 'Exakte Zeit unbekannt', cancel: 'Abbrechen', save: 'Speichern', back: '‚Üê Zur√ºck',
          gender: 'Geschlecht', genderSelect: 'W√§hlen', male: 'M√§nnlich', female: 'Weiblich', other: 'Divers',
          modeType: 'Schl√ºsseltyp', modeSubtitle: 'Das bestimmt die Formularfelder unten',
          modeSingle: 'F√ºr mich', modeSingleDesc: 'Tiefenanalyse',
          modeCouple: 'Zu zweit', modeCoupleDesc: 'Duett / Paar',
          modeTransit: 'Tagesenergie', modeTransitDesc: 'Energie des Augenblicks',
          namePh: 'Wie hei√üt du?', birthdateLabel: 'Geburtsdatum', birthplacePh: 'Stadt oder Land ‚Äî w√§hle aus den Vorschl√§gen',
          birthplaceHint: 'W√§hle einen Ort aus der Liste ‚Äî so werden die Koordinaten erg√§nzt.',
          unknownTimeShort: 'Unbekannt', secondPersonTitle: 'Zu zweit', name2Ph: 'Name der zweiten Person',
          birthplace2Ph: 'Geburtsort der zweiten Person', birthtime2Ph: 'Geburtszeit',
          transitTitle: 'Energie des Augenblicks', transitDatePh: 'Ereignisdatum', transitTimePh: 'Ereigniszeit',
          transitLocationPh: 'Stadt f√ºr die Momentenergie', transitLocationOk: 'Ort ist korrekt',
          transitIntentPh: 'Absicht f√ºr diesen Moment (optional)',
          sendRequest: 'Anfrage senden', quickRequests: 'Schnellanfragen', hide: 'Ausblenden',
          requestPh: 'Was m√∂chtest du heute erkunden?', toPayment: 'Zur Kasse',
          paymentSubtitle: 'Dein Klangschl√ºssel', paymentAndAccess: 'Zahlung & Zugang',
          paymentIntro: 'Das erste Lied ist gratis. Du kannst Einzelelemente kaufen oder ein Abo f√ºr vollen Zugang abschlie√üen.',
          loadingPricing: 'Tarife laden...', currentItem: 'Aktuelles Element',
          promoCode: 'Gutscheincode', apply: 'Anwenden', backFromPayment: '‚Üê Zur√ºck',
          submitAndContinue: 'Zur Kasse & weiter', submitRequest: 'Anfrage senden',
          firstFree: 'Dein erster Klangschl√ºssel ist kostenlos.',
          paymentRequired: 'Zahlung f√ºr neue Anfragen erforderlich.',
          promoApplied: 'Gutschein {code}: -{amount} {currency}',
          creatingKey: 'Dein Schl√ºssel wird erstellt...',
          creatingKeyDesc: 'Magie passiert in Echtzeit. Dein pers√∂nlicher Klangschl√ºssel wird aus deinen einzigartigen Daten geformt.',
          keyActivated: 'Schl√ºssel aktiviert!', done: 'Fertig!',
          successText: 'Dein pers√∂nlicher Klangschl√ºssel ist erstellt! Dein einzigartiges Kraftartefakt f√ºr das Spiel des Lebens.',
          yourSong: 'üéµ Dein Lied',
          songPreviewText: 'Deine einzigartige Komposition wartet im Bot. H√∂re sie jeden Morgen, um dich auf Erfolg einzustimmen.',
          whatNext: 'Was weiter:', openBot: 'Bot √∂ffnen',
          soulChat: 'Mit deiner Seele sprechen', soulChatPay: 'Zur Kasse ‚Äî Soul Basic / Soul Plus',
          newKey: 'Weiteren Schl√ºssel erstellen',
          paymentThanks: 'Danke f√ºr die Zahlung', thanksSubtitle: 'Anfrage angenommen',
          songInProgress: 'Das Lied wird generiert. In 2‚Äì3 Minuten kommt es im Bot-Chat.',
          songInProgressConfirmed: 'Anfrage angenommen. Lied wird generiert ‚Äî erneute Zahlung nicht n√∂tig. In 2‚Äì3 Minuten im Bot-Chat.',
          thanksDone: 'Fertig',
          notFromTelegram: '√ñffne die App aus dem Bot-Chat in Telegram (Men√º) ‚Äî sonst kann die Anfrage nicht gesendet werden.',
          notFound: 'Nicht gefunden', searchError: 'Suchfehler',
          soulChatLoad: 'Laden‚Ä¶',
          soulChatHasAccess: 'Du hast Soul Chat. Tippe unten ‚Äî der Bot √∂ffnet sich. Im Bot: /soulchat und stelle deiner Seele eine Frage.',
          soulChatNoAccess: 'Soul Chat ‚Äî Dialoge mit deiner Seele. Mit Soul Basic (10/Monat) oder Soul Plus (30/Monat) Abo.',
          soulChatDefault: 'Soul Chat ‚Äî Dialoge mit deiner Seele pro Anfrage. Per Abo.',
          soulChatNoApi: 'Soul Chat ‚Äî Dialoge mit deiner Seele. Mit Soul Basic oder Soul Plus Abo. Gehe zu ¬´Zur Kasse¬ª in der App.',
          greeting: 'Hallo, {name}! Komm zur√ºck, wann immer du dich erinnern willst, wer du bist.',
          greetingDefault: 'Komm zur√ºck, wann immer du dich erinnern willst, wer du bist.',
          alertNameShort: 'Name muss mindestens 2 Zeichen haben', alertBirthdate: 'W√§hle Geburtsdatum',
          alertBirthplace: 'Geburtsort muss mindestens 3 Zeichen haben', alertBirthplaceHint: 'W√§hle einen Ort aus den Vorschl√§gen',
          alertBirthtime: 'Geburtszeit eingeben oder "Unbekannt" w√§hlen', alertGender: 'Geschlecht w√§hlen', alertLanguage: 'Sprache w√§hlen',
          alertName2Short: 'Name der zweiten Person ‚Äî mindestens 2 Zeichen', alertBirthdate2: 'Geburtsdatum der zweiten Person eingeben',
          alertBirthplace2: 'Geburtsort der zweiten Person muss mindestens 3 Zeichen haben',
          alertBirthtime2: 'Geburtszeit der zweiten Person eingeben', alertGender2: 'Geschlecht der zweiten Person w√§hlen',
          alertTransitDate: 'Ereignisdatum eingeben', alertTransitLocation: 'Ereignisort eingeben', alertTransitConfirm: 'Best√§tige, dass der Ort korrekt ist',
          alertRequestShort: 'Anfrage hinzuf√ºgen (5+ Zeichen)', alertRequestLong: 'Erz√§hle dem Universum mehr (mindestens 15 Zeichen)',
          alertYourPath: 'W√§hle deinen Weg', alertNoApi: 'API-Adresse nicht konfiguriert.', alertOpenFromBot: '√ñffne die App aus dem Bot-Chat in Telegram ‚Äî sonst wird die Anfrage nicht angenommen.',
          alertServerSleep: 'Server brauchte etwas zum Aufwachen. Warte etwa eine Minute und tippe erneut auf ¬´Anfrage senden¬ª.',
          universeHeard: '‚ú® {name}, das Universum hat deine Anfrage geh√∂rt.\n\nDein Klangschl√ºssel wird erstellt. In 2‚Äì3 Minuten kommt er in diesen Chat.',
          universeHeardCouple: '‚ú® {name} und {name2}, das Universum hat eure Anfrage geh√∂rt.\n\nEuer Klangschl√ºssel wird erstellt. In 2‚Äì3 Minuten kommt er in diesen Chat.',
          universeHeardTransit: '‚ú® {name}, das Universum hat deine Anfrage geh√∂rt.\n\nDein Tagesenergie-Klangschl√ºssel wird erstellt. In 2‚Äì3 Minuten kommt er in diesen Chat.',
          langSong: 'Liedsprache', langRu: 'Russisch', langEn: 'Englisch', langDe: 'Deutsch', langFr: 'Franz√∂sisch', langUk: 'Ukrainisch',
          quick1: 'Harmonie und Selbstliebe', quick2: 'Selbstvertrauen und Bestimmung', quick3: 'Kreatives Potenzial', quick4: 'Vergangenheit loslassen',
          quick5: 'Lebensbalance', quick6: 'Vertrauen und Akzeptanz', quick7: 'Heilung und Freiheit', quick8: 'Weg zum Gl√ºck',
          quick9: 'Kraft und √úberwindung', quick10: 'Tiefe und Stille', quick11: 'Z√§rtlichkeit und F√ºrsorge', quick12: 'Humor und Leichtigkeit',
          quick1t: 'Harmonie in Beziehungen und Selbstliebe', quick2t: 'Selbstvertrauen, Bestimmung und Selbstst√§ndigkeit',
          quick3t: 'Kreatives Potenzial ohne Angst entfalten', quick4t: 'Vergangenheit loslassen und neue M√∂glichkeiten √∂ffnen',
          quick5t: 'Balance von Arbeit und Privatleben', quick6t: 'Dem Leben vertrauen und Kontrolle loslassen',
          quick7t: 'Kindheitstraumen heilen und Freiheit finden', quick8t: 'Deinen Weg zu Gl√ºck und Frieden finden',
          quick9t: 'Kraftvolles Lied √ºber meine St√§rke und √úberwindung', quick10t: 'Meditatives Lied f√ºr Praxis und Heilung',
          quick11t: 'Warmes Lied √ºber F√ºrsorge und Z√§rtlichkeit', quick12t: 'Verspieltes Lied mit Selbstironie √ºber meine Eigenheiten',
          promoError: 'Gutscheincode konnte nicht angewendet werden',
          promoCleared: 'Gutscheincode entfernt.', promoApplied: 'Gutschein angewendet: Endsumme {amount} {currency}',
          promoAppliedHint: 'Gutschein {code}: -{amount} {currency}',
          paymentRequiredOpening: 'Zahlung erforderlich. √ñffne HOT Checkout...',
          promoFreeGen: 'Gutschein erm√∂glicht kostenlose Generierung. Starte...',
          hotCheckoutOpened: 'HOT Checkout ge√∂ffnet. Nach der Zahlung kehre zur Mini App zur√ºck ‚Äî der Status wird automatisch aktualisiert.',
          paymentNotConfirmed: 'Zahlung noch nicht best√§tigt. Sp√§ter pr√ºfen oder Zahlung erneut √∂ffnen.',
          paymentConfirmed: 'Zahlung best√§tigt. Generierung startet...',
          paymentReceivedNoStart: 'Zahlung erhalten, aber Auto-Start fehlgeschlagen. Starte Generierung in der Admin per request_id: {id}',
          submitFailed: 'Anfrage konnte nicht gesendet werden. Warte eine Minute und tippe erneut auf ¬´Anfrage senden¬ª oder √∂ffne die Mini App neu aus dem Bot-Chat.',
          errorOp: 'Fehler bei Zahlung/Anfrage'
        },
        fr: {
          tagline: 'Explore tes facettes comme tu le souhaites',
          startBtn: 'Commencer', myHeroes: 'üë• Mes h√©ros', admin: 'üëë Admin',
          heroesTitle: 'Mes h√©ros', heroesSubtitle: 'R√©pertoire des clients',
          searchByName: 'Rechercher par nom', searchPlaceholder: 'Entrer le nom...', searchBtn: 'Rechercher',
          addHero: '‚ûï Ajouter un h√©ros', heroName: 'Nom *', heroBirthdate: 'Date de naissance', heroBirthtime: 'Heure de naissance',
          heroBirthplace: 'Lieu de naissance', heroBirthplacePh: 'Ville, pays', heroNotes: 'Notes', heroNotesPh: 'Notes client',
          unknownTime: "Heure exacte inconnue", cancel: 'Annuler', save: 'Enregistrer', back: '‚Üê Retour',
          gender: 'Genre', genderSelect: 'Choisir', male: 'Homme', female: 'Femme', other: 'Autre',
          modeType: "Type de cl√©", modeSubtitle: 'Cela d√©termine les champs du formulaire ci-dessous',
          modeSingle: 'Pour moi', modeSingleDesc: 'Analyse approfondie',
          modeCouple: '√Ä deux', modeCoupleDesc: 'Duo / couple',
          modeTransit: "√ânergie du jour", modeTransitDesc: "√ânergie du moment",
          namePh: "Comment tu t'appelles ?", birthdateLabel: 'Date de naissance', birthplacePh: 'Ville ou pays ‚Äî choisis parmi les suggestions',
          birthplaceHint: 'Choisis un lieu dans la liste ‚Äî les coordonn√©es seront ajout√©es automatiquement.',
          unknownTimeShort: 'Inconnu', secondPersonTitle: '√Ä deux', name2Ph: "Nom de la deuxi√®me personne",
          birthplace2Ph: "Lieu de naissance de la deuxi√®me personne", birthtime2Ph: 'Heure de naissance',
          transitTitle: "√ânergie du moment", transitDatePh: 'Date de l\'√©v√©nement', transitTimePh: "Heure de l'√©v√©nement",
          transitLocationPh: 'Ville pour l\'√©nergie du moment', transitLocationOk: 'Le lieu est correct',
          transitIntentPh: 'Intention pour ce moment (optionnel)',
          sendRequest: 'Envoyer la demande', quickRequests: 'Demandes rapides', hide: 'Masquer',
          requestPh: 'Que souhaites-tu explorer aujourd\'hui ?', toPayment: 'Paiement',
          paymentSubtitle: 'Ta cl√© sonore', paymentAndAccess: 'Paiement et acc√®s',
          paymentIntro: 'La premi√®re chanson est offerte. Tu peux payer des √©l√©ments individuels ou t\'abonner pour un acc√®s complet.',
          loadingPricing: 'Chargement des tarifs...', currentItem: '√âl√©ment actuel',
          promoCode: 'Code promo', apply: 'Appliquer', backFromPayment: '‚Üê Retour',
          submitAndContinue: 'Payer et continuer', submitRequest: 'Envoyer la demande',
          firstFree: 'Ta premi√®re cl√© sonore est gratuite.',
          paymentRequired: 'Paiement requis pour les nouvelles demandes.',
          promoApplied: 'Code promo {code}: -{amount} {currency}',
          creatingKey: 'Cr√©ation de ta cl√©...',
          creatingKeyDesc: 'La magie op√®re en temps r√©el. Ta cl√© sonore personnelle se forme √† partir de tes donn√©es uniques.',
          keyActivated: 'Cl√© activ√©e !', done: 'Termin√© !',
          successText: 'Ta cl√© sonore personnelle est cr√©√©e ! Ton artefact unique de force pour le jeu de la vie.',
          yourSong: 'üéµ Ta chanson',
          songPreviewText: 'Ta composition unique t\'attend dans le bot. √âcoute-la chaque matin pour te mettre sur la voie du succ√®s.',
          whatNext: 'Et apr√®s :', openBot: 'Ouvre le bot',
          soulChat: 'Parler √† ton √¢me', soulChatPay: 'Paiement ‚Äî Soul Basic / Soul Plus',
          newKey: 'Cr√©er une autre cl√©',
          paymentThanks: 'Merci pour le paiement', thanksSubtitle: 'demande accept√©e',
          songInProgress: 'La chanson est en cours de g√©n√©ration. Elle arrivera dans le chat du bot dans 2‚Äì3 minutes.',
          songInProgressConfirmed: 'Demande accept√©e. Chanson en g√©n√©ration ‚Äî pas besoin de payer √† nouveau. Elle arrivera dans le chat du bot dans 2‚Äì3 minutes.',
          thanksDone: 'Termin√©',
          notFromTelegram: 'Ouvre l\'app depuis le chat du bot dans Telegram (bouton menu) ‚Äî sinon la demande ne peut pas √™tre envoy√©e.',
          notFound: 'Non trouv√©', searchError: 'Erreur de recherche',
          soulChatLoad: 'Chargement‚Ä¶',
          soulChatHasAccess: "Tu as acc√®s √† Soul Chat. Appuie ci-dessous ‚Äî le bot s'ouvrira. Dans le bot, tape /soulchat et pose une question √† ton √¢me.",
          soulChatNoAccess: 'Soul Chat ‚Äî dialogues avec ton √¢me. Avec abonnement Soul Basic (10/mois) ou Soul Plus (30/mois).',
          soulChatDefault: 'Soul Chat ‚Äî dialogues avec ton √¢me par demande. Sur abonnement.',
          soulChatNoApi: 'Soul Chat ‚Äî dialogues avec ton √¢me. Avec abonnement Soul Basic ou Soul Plus. Va dans ¬´Paiement¬ª dans l\'app.',
          greeting: 'Salut, {name} ! Reviens quand tu veux te souvenir de qui tu es.',
          greetingDefault: 'Reviens quand tu veux te souvenir de qui tu es.',
          alertNameShort: 'Le nom doit contenir au moins 2 caract√®res', alertBirthdate: 'Choisis la date de naissance',
          alertBirthplace: 'Le lieu de naissance doit contenir au moins 3 caract√®res', alertBirthplaceHint: 'Choisis un lieu dans les suggestions',
          alertBirthtime: 'Entre l\'heure de naissance ou coche "Inconnu"', alertGender: 'Choisis le genre', alertLanguage: 'Choisis la langue',
          alertName2Short: 'Le nom de la 2e personne ‚Äî au moins 2 caract√®res', alertBirthdate2: 'Entre la date de naissance de la 2e personne',
          alertBirthplace2: 'Le lieu de naissance de la 2e personne doit contenir au moins 3 caract√®res',
          alertBirthtime2: 'Entre l\'heure de naissance de la 2e personne', alertGender2: 'Choisis le genre de la 2e personne',
          alertTransitDate: 'Entre la date de l\'√©v√©nement', alertTransitLocation: 'Entre le lieu de l\'√©v√©nement', alertTransitConfirm: 'Confirme que le lieu est correct',
          alertRequestShort: 'Ajoute une demande (5+ caract√®res)', alertRequestLong: 'Dis-en plus √† l\'Univers (au moins 15 caract√®res)',
          alertYourPath: 'Choisis ton chemin', alertNoApi: 'Adresse API non configur√©e.', alertOpenFromBot: 'Ouvre l\'app depuis le chat du bot dans Telegram ‚Äî sinon la demande ne peut pas √™tre accept√©e.',
          alertServerSleep: 'Le serveur s\'est r√©veill√© lentement. Attends environ une minute et appuie √† nouveau sur ¬´Envoyer la demande¬ª.',
          universeHeard: '‚ú® {name}, l\'Univers a entendu ta demande.\n\nTa cl√© sonore est en cours de cr√©ation. Elle arrivera dans ce chat dans 2‚Äì3 minutes.',
          universeHeardCouple: '‚ú® {name} et {name2}, l\'Univers a entendu votre demande.\n\nVotre cl√© sonore est en cours de cr√©ation. Elle arrivera dans ce chat dans 2‚Äì3 minutes.',
          universeHeardTransit: '‚ú® {name}, l\'Univers a entendu ta demande.\n\nTa cl√© sonore √ânergie du jour est en cours de cr√©ation. Elle arrivera dans ce chat dans 2‚Äì3 minutes.',
          langSong: 'Langue de la chanson', langRu: 'Russe', langEn: 'Anglais', langDe: 'Allemand', langFr: 'Fran√ßais', langUk: 'Ukrainien',
          quick1: 'Harmonie et amour de soi', quick2: 'Confiance et but', quick3: 'Potentiel cr√©atif', quick4: 'L√¢cher le pass√©',
          quick5: '√âquilibre de vie', quick6: 'Confiance et acceptation', quick7: 'Gu√©rison et libert√©', quick8: 'Chemin vers le bonheur',
          quick9: 'Force et d√©passement', quick10: 'Profondeur et silence', quick11: 'Tendresse et soin', quick12: 'Humor et l√©g√®ret√©',
          quick1t: 'Harmonie dans les relations et amour de soi', quick2t: 'Confiance, but et autonomie',
          quick3t: 'Lib√©rer ton potentiel cr√©atif sans peur', quick4t: 'L√¢cher le pass√© et ouvrir de nouvelles possibilit√©s',
          quick5t: '√âquilibre travail et vie personnelle', quick6t: 'Faire confiance √† la vie et l√¢cher le contr√¥le',
          quick7t: 'Gu√©rir les blessures d\'enfance et trouver la libert√©', quick8t: 'Trouver ton chemin vers le bonheur et la paix',
          quick9t: 'Chanson puissante sur ma force et mon d√©passement', quick10t: 'Chanson m√©ditative pour la pratique et la gu√©rison',
          quick11t: 'Chanson chaleureuse sur le soin et la tendresse', quick12t: 'Chanson ludique avec auto-ironie sur mes travers',
          promoError: 'Code promo non appliqu√©',
          promoCleared: 'Code promo effac√©.', promoApplied: 'Code promo appliqu√©: montant final {amount} {currency}',
          promoAppliedHint: 'Code promo {code}: -{amount} {currency}',
          paymentRequiredOpening: 'Paiement requis. Ouverture de HOT Checkout...',
          promoFreeGen: 'Le code promo donne une g√©n√©ration gratuite. D√©marrage...',
          hotCheckoutOpened: 'HOT Checkout ouvert. Apr√®s paiement, reviens dans la Mini App ‚Äî le statut se mettra √† jour automatiquement.',
          paymentNotConfirmed: 'Paiement pas encore confirm√©. V√©rifie plus tard ou rouvre le paiement.',
          paymentConfirmed: 'Paiement confirm√©. D√©marrage de la g√©n√©ration...',
          paymentReceivedNoStart: 'Paiement re√ßu, mais d√©marrage auto √©chou√©. Lance la g√©n√©ration dans l\'admin par request_id: {id}',
          submitFailed: 'Demande non envoy√©e. Attends une minute et appuie √† nouveau sur ¬´Envoyer la demande¬ª ou rouvre la Mini App depuis le chat du bot.',
          errorOp: 'Erreur op√©ration paiement/demande'
        }
      };
      var currentLang = 'ru';
      function detectLang() {
        try {
          var stored = localStorage.getItem(LANG_STORAGE_KEY);
          if (stored === 'ru' || stored === 'en') return stored;
          var lc = (tg && tg.initDataUnsafe && tg.initDataUnsafe.user && tg.initDataUnsafe.user.language_code) || '';
          if (lc && /^en/.test(lc)) return 'en';
          return 'ru';
        } catch (_) { return 'ru'; }
      }
      function t(k, vars) {
        var s = (LANG[currentLang] && LANG[currentLang][k]) || (LANG.ru && LANG.ru[k]) || k;
        if (vars && typeof s === 'string') {
          Object.keys(vars).forEach(function(key) { s = s.replace(new RegExp('\\{' + key + '\\}', 'g'), vars[key]); });
        }
        return s;
      }
      function applyTranslations() {
        document.documentElement.lang = currentLang === 'en' ? 'en' : 'ru';
        var map = [
          ['tagline','#homeTagline'], ['startBtn','#startBtn'], ['myHeroes','#goHeroesBtn'], ['admin','#adminLinkBtn'],
          ['heroesTitle','#heroesPage .page header h1'], ['heroesSubtitle','#heroesPage .subtitle'],
          ['searchByName','#heroesPage label[for="heroesSearch"]'], ['searchPlaceholder','#heroesSearch'], ['searchBtn','#heroesSearchBtn'],
          ['addHero','#addHeroBtn'], ['heroName','#heroFormWrap label[for="heroName"]'], ['heroBirthdate','#heroFormWrap label[for="heroBirthdate"]'],
          ['heroBirthtime','#heroFormWrap label[for="heroBirthtime"]'], ['heroBirthplace','#heroFormWrap label[for="heroBirthplace"]'],
          ['heroNotes','#heroFormWrap label[for="heroNotes"]'], ['unknownTime','#heroFormWrap label[for="heroBirthtimeUnknown"]'],
          ['cancel','#heroFormCancel'], ['save','#heroFormSave'], ['back','#heroesBackBtn'],
          ['modeType','.mode-selector h3'], ['modeSubtitle','.mode-subtitle'],
          ['modeSingle','.mode-btn[data-mode="single"] .mode-label'], ['modeSingleDesc','.mode-btn[data-mode="single"] .mode-desc'],
          ['modeCouple','.mode-btn[data-mode="couple"] .mode-label'], ['modeCoupleDesc','.mode-btn[data-mode="couple"] .mode-desc'],
          ['modeTransit','.mode-btn[data-mode="transit"] .mode-label'], ['modeTransitDesc','.mode-btn[data-mode="transit"] .mode-desc'],
          ['secondPersonTitle','#secondPersonForm h3'], ['transitTitle','#transitForm h3'],
          ['quickRequests','#quickRequestsToggle'], ['sendRequest','.request-label'], ['toPayment','#stepNext'],
          ['paymentSubtitle','#paymentPage .subtitle'], ['paymentAndAccess','#paymentPage .tagline'],
          ['promoCode','#promoCodeInput'], ['apply','#promoApplyBtn'], ['backFromPayment','#backFromPaymentBtn'],
          ['paymentIntro','#paymentIntro'], ['loadingDesc','#loadingDesc'], ['priceSummaryLabel','#priceSummaryLabel'],
          ['submitAndContinue','#payBtn'], ['creatingKey','.loading-text'], ['keyActivated','#successPage .subtitle'],
          ['done','.success-title'], ['soulChat','#soulChatBtn'], ['soulChatPay','#soulChatPayBtn'], ['newKey','#newKeyBtn'],
          ['paymentThanks','#paymentThanksPage .success-title'], ['thanksSubtitle','#paymentThanksPage .subtitle'],
          ['thanksDone','#paymentThanksBackBtn'], ['gender','#genderLabel'], ['genderSelect','#gender option[value=""]']
        ];
        map.forEach(function(pair) {
          var el = document.querySelector(pair[1]);
          if (el) {
            if (pair[1].indexOf('placeholder') === -1 && (pair[1].indexOf('#') === 0 || pair[1].indexOf('label') >= 0 || pair[1].indexOf('h3') >= 0 || pair[1].indexOf('.') >= 0)) {
              if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.placeholder = t(pair[0]);
              else el.textContent = t(pair[0]);
            } else if (pair[1].indexOf('placeholder') >= 0 || (el.tagName === 'INPUT' && pair[0] === 'searchPlaceholder')) el.placeholder = t(pair[0]);
            else el.textContent = t(pair[0]);
          }
        });
        var phMap = [
          ['namePh','#name'], ['birthplacePh','#birthplace'], ['name2Ph','#name2'], ['birthplace2Ph','#birthplace2'],
          ['transitDatePh','#transitDate'], ['transitTimePh','#transitTime'], ['transitLocationPh','#transitLocation'],
          ['transitIntentPh','#transitIntent'], ['requestPh','#request'], ['heroBirthplacePh','#heroBirthplace'],
          ['heroNotesPh','#heroNotes'], ['heroName','#heroName'], ['promoCode','#promoCodeInput']
        ];
        phMap.forEach(function(p) { var e = document.querySelector(p[1]); if (e) e.placeholder = t(p[0]); });
        var selectOpts = [['genderSelect','gender'],['male','male'],['female','female'],['other','other'],['langSong','language'],['langRu','ru'],['langEn','en'],['langUk','uk']];
        var genderSelect = document.getElementById('gender'); if (genderSelect) {
          var opts = genderSelect.querySelectorAll('option'); if (opts[0]) opts[0].textContent = t('genderSelect');
          if (opts[1]) opts[1].textContent = t('male'); if (opts[2]) opts[2].textContent = t('female');
          var o3 = genderSelect.querySelector('option[value="other"]'); if (o3) o3.textContent = t('other');
        }
        var gender2 = document.getElementById('gender2'); if (gender2) {
          var o2 = gender2.querySelectorAll('option'); if (o2[0]) o2[0].textContent = t('genderSelect');
          if (o2[1]) o2[1].textContent = t('female'); if (o2[2]) o2[2].textContent = t('male');
        }
        var langSelect = document.getElementById('language'); if (langSelect) {
          var lo = langSelect.querySelectorAll('option');
          if (lo[0]) lo[0].textContent = t('langSong');
          if (lo[1]) lo[1].textContent = t('langRu'); if (lo[2]) lo[2].textContent = t('langEn');
          if (lo[3]) lo[3].textContent = t('langDe');
          if (lo[4]) lo[4].textContent = t('langFr');
          if (lo[5]) lo[5].textContent = t('langUk');
          var langMap = { ru: 'ru', en: 'en', de: 'de', fr: 'fr' };
          var songLang = langMap[currentLang] || langSelect.value || 'ru';
          if (langSelect.querySelector('option[value="' + songLang + '"]')) langSelect.value = songLang;
        }
        var heroOpt = document.querySelector('#heroGender option[value=""]'); if (heroOpt) heroOpt.textContent = t('genderSelect');
        var heroMale = document.querySelector('#heroGender option[value="male"]'); if (heroMale) heroMale.textContent = t('male');
        var heroFemale = document.querySelector('#heroGender option[value="female"]'); if (heroFemale) heroFemale.textContent = t('female');
        document.getElementById('birthplaceHint') && (document.getElementById('birthplaceHint').textContent = t('birthplaceHint'));
        document.querySelector('label[for="transitLocationConfirmed"]') && (document.querySelector('label[for="transitLocationConfirmed"]').textContent = t('transitLocationOk'));
        document.querySelector('label[for="unknown"]') && (document.querySelector('label[for="unknown"]').textContent = t('unknownTime'));
        document.querySelector('label[for="unknown2"]') && (document.querySelector('label[for="unknown2"]').textContent = t('unknownTimeShort'));
        var quickBtns = document.querySelectorAll('.example-btn'); var quickK = ['quick1','quick2','quick3','quick4','quick5','quick6','quick7','quick8','quick9','quick10','quick11','quick12']; var quickT = ['quick1t','quick2t','quick3t','quick4t','quick5t','quick6t','quick7t','quick8t','quick9t','quick10t','quick11t','quick12t'];
        quickBtns.forEach(function(btn, i) { if (btn) { btn.textContent = t(quickK[i]); btn.setAttribute('data-text', t(quickT[i])); } });
        var gh = document.getElementById('homeGreeting');
        if (gh) gh.textContent = (userProfile && userProfile.name) ? t('greeting', { name: userProfile.name }) : t('greetingDefault');
        var lr = document.getElementById('langRu'); var le = document.getElementById('langEn');
        if (lr) { lr.style.fontWeight = currentLang === 'ru' ? '700' : '400'; lr.style.opacity = currentLang === 'ru' ? '1' : '0.7'; }
        if (le) { le.style.fontWeight = currentLang === 'en' ? '700' : '400'; le.style.opacity = currentLang === 'en' ? '1' : '0.7'; }
      }
      function setLang(lang) {
        currentLang = lang;
        try { localStorage.setItem(LANG_STORAGE_KEY, lang); } catch (_) {}
        var langMap = { ru: 'ru', en: 'en', de: 'de', fr: 'fr' };
        var songLang = langMap[lang] || 'ru';
        var langSelect = document.getElementById('language');
        if (langSelect && langSelect.querySelector('option[value="' + songLang + '"]')) {
          langSelect.value = songLang;
        }
        applyTranslations();
      }
      function isTelegramWebApp() {
        return !!(window.Telegram && window.Telegram.WebApp);
      }
      function getInitData() {
        var current = '';
        try {
          var wa = window.Telegram && window.Telegram.WebApp;
          current = (wa && wa.initData) ? String(wa.initData) : (tg && tg.initData) ? String(tg.initData) : '';
        } catch (_) { current = ''; }
        if (current) {
          try { localStorage.setItem(INIT_DATA_STORAGE_KEY, current); } catch (_) {}
          return current;
        }
        try { return localStorage.getItem(INIT_DATA_STORAGE_KEY) || ''; } catch (_) { return ''; }
      }
      function logColorSnapshot(stage, pageId) {
        try {
          var rootStyles = getComputedStyle(document.documentElement);
          var bodyStyles = getComputedStyle(document.body);
          var formPage = document.getElementById('formPage');
          var scope = formPage || document;
          var labelEl = scope.querySelector('label');
          var fieldEl = scope.querySelector('input,select,textarea');
          var requestLabelEl = scope.querySelector('.request-label');
          var tgParams = (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.themeParams) ? window.Telegram.WebApp.themeParams : {};
          void 0;
        } catch (e) {
          void 0;
        }
      }
      function initApp() {
        try {
      if (window.Telegram && window.Telegram.WebApp) {
            tg = window.Telegram.WebApp;
        tg.ready();
            tg.expand();
            if (tg.enableClosingConfirmation) tg.enableClosingConfirmation();
            getInitData();
            logColorSnapshot('init-app', 'homePage');
            return true;
          }
        } catch (e) { console.warn('Telegram init:', e); }
        return false;
      }
      if (!initApp()) {
        var attempts = 0;
        var t = setInterval(function() {
          attempts++;
          if (initApp() || attempts >= 50) {
            clearInterval(t);
            if (!tg) showNotFromTelegramBanner();
            logColorSnapshot('init-retry-finished', 'homePage');
          }
        }, 100);
      }
      function showNotFromTelegramBanner() {
        var banner = document.createElement('div');
        banner.id = 'not-telegram-banner';
        banner.style.cssText = 'position:fixed;top:0;left:0;right:0;z-index:9999;background:#fef3c7;color:#92400e;padding:12px 16px;text-align:center;font-size:0.95rem;border-bottom:1px solid #f59e0b;';
        banner.textContent = t('notFromTelegram');
        document.body.insertBefore(banner, document.body.firstChild);
      }
      async function showLocationSuggestions(inputElement, suggestionsContainerId, confirmCheckboxId) {
        var value = inputElement.value.trim();
        var suggestionsContainer = document.getElementById(suggestionsContainerId);
        if (value.length < 2) {
          if (suggestionsContainer) suggestionsContainer.style.display = 'none';
          return;
        }
        try {
          var response = await fetch('https://nominatim.openstreetmap.org/search?format=json&q=' + encodeURIComponent(value) + '&addressdetails=1&limit=5', { headers: { 'Accept': 'application/json', 'User-Agent': 'YupSoulMiniApp/1.0' } });
          var locations = await response.json();
          if (locations.length === 0) {
            if (suggestionsContainer) {
              suggestionsContainer.innerHTML = '<div style="padding: 10px; color: var(--tg-theme-hint-color, rgba(255,255,255,0.6)); text-align: center;">' + t('notFound') + '</div>';
              suggestionsContainer.style.display = 'block';
            }
            return;
          }
          if (suggestionsContainer) {
            suggestionsContainer.innerHTML = locations.map(function(loc) {
              var display = (loc.display_name || '')
                .replace(', –†–æ—Å—Å–∏—è', '').replace(', –ë–µ–ª–∞—Ä—É—Å—å', '').replace(', –†–æ—Å—Å–∏–π—Å–∫–∞—è –§–µ–¥–µ—Ä–∞—Ü–∏—è', '').replace(', Republic of Belarus', '');
              return '<div class="location-suggestion" data-value="' + (display.replace(/"/g, '&quot;')) + '">' + (display.replace(/</g, '&lt;')) + '</div>';
            }).join('');
            suggestionsContainer.style.display = 'block';
            suggestionsContainer.querySelectorAll('.location-suggestion').forEach(function(item) {
              item.addEventListener('click', function() {
                inputElement.value = item.getAttribute('data-value');
                suggestionsContainer.style.display = 'none';
                if (confirmCheckboxId) {
                  var checkbox = document.getElementById(confirmCheckboxId);
                  if (checkbox) checkbox.checked = true;
                }
              });
            });
          }
        } catch (err) {
          console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è:', err);
          if (suggestionsContainer) {
            suggestionsContainer.innerHTML = '<div style="padding: 10px; color: #ef4444; text-align: center;">' + t('searchError') + '</div>';
            suggestionsContainer.style.display = 'block';
          }
        }
      }
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.location-input-wrapper')) {
          document.querySelectorAll('.location-suggestions').forEach(function(el) { el.style.display = 'none'; });
        }
      });
      var userTariff = 'basic';
      var userProfile = null;
      var heroesCache = [];
      var editingHeroId = null;
      var pricingCatalog = [];
      var freeTrialAvailable = true;
      var activePromo = null;

      function getCurrentSku() {
        var modeSku = selectedMode || 'single';
        if (modeSku === 'couple') return 'couple_song';
        if (modeSku === 'transit') return 'transit_energy_song';
        return 'single_song';
      }
      function setPaymentStatus(text, tone) {
        var el = document.getElementById('paymentStatus');
        if (!el) return;
        if (!text) { el.style.display = 'none'; return; }
        el.style.display = 'block';
        el.textContent = text;
        el.style.color = 'rgba(255,255,255,.95)';
        if (tone === 'ok') { el.style.borderColor = 'rgba(212,175,55,.5)'; el.style.background = 'rgba(212,175,55,.15)'; return; }
        if (tone === 'warn') { el.style.borderColor = 'rgba(212,175,55,.45)'; el.style.background = 'rgba(212,175,55,.12)'; return; }
        if (tone === 'error') { el.style.borderColor = 'rgba(236,72,153,.5)'; el.style.background = 'rgba(236,72,153,.12)'; return; }
        el.style.borderColor = 'rgba(212,175,55,.35)';
        el.style.background = 'rgba(212,175,55,.1)';
      }
      function updatePaymentUiFromCatalog() {
        var sku = getCurrentSku();
        var item = pricingCatalog.find(function(x) { return x && x.sku === sku; }) || null;
        var priceLabel = document.getElementById('priceLabel');
        var priceValue = document.getElementById('priceValue');
        var priceHint = document.getElementById('priceHint');
        var notice = document.getElementById('pricingNotice');
        if (priceLabel) priceLabel.textContent = item ? (item.title || sku) : sku;
        if (priceValue) {
          if (item && activePromo && activePromo.sku === sku) {
            priceValue.textContent = String(activePromo.amount_after) + ' ' + (activePromo.currency || item.currency || 'USDT');
          } else {
            priceValue.textContent = item ? (String(item.price) + ' ' + (item.currency || 'USDT')) : '‚Äî';
          }
        }
        if (priceHint) {
          if (item && activePromo && activePromo.sku === sku) {
            priceHint.textContent = t('promoAppliedHint', { code: activePromo.code, amount: activePromo.discount_amount, currency: activePromo.currency || item.currency || 'USDT' });
          } else {
            priceHint.textContent = '';
          }
        }
        if (notice) {
          if (freeTrialAvailable) {
            notice.textContent = t('firstFree');
            notice.style.borderColor = 'rgba(212,175,55,.4)';
            notice.style.background = 'rgba(212,175,55,.12)';
            notice.style.color = 'rgba(255,255,255,.95)';
          } else {
            notice.textContent = t('paymentRequired');
            notice.style.borderColor = 'rgba(212,175,55,.35)';
            notice.style.background = 'rgba(212,175,55,.1)';
            notice.style.color = 'rgba(255,255,255,.95)';
          }
        }
      }
      async function loadPricingCatalog() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = (tg && tg.initData) ? tg.initData : '';
        if (!apiBase) return;
        try {
          var url = apiBase + '/api/pricing/catalog';
          var sep = url.indexOf('?') >= 0 ? '&' : '?';
          if (initData) url += sep + 'initData=' + encodeURIComponent(initData);
          var resp = await fetch(url, { headers: { 'X-Telegram-Init': initData } });
          var json = await resp.json().catch(function() { return {}; });
          if (resp.ok && json.success) {
            pricingCatalog = Array.isArray(json.catalog) ? json.catalog : [];
            freeTrialAvailable = !!(json.free_trial && json.free_trial.available);
            updatePaymentUiFromCatalog();
          }
        } catch (_) {}
      }
      async function applyPromoCode() {
        var input = document.getElementById('promoCodeInput');
        if (!input) return;
        var code = String(input.value || '').trim().toUpperCase();
        if (!code) {
          activePromo = null;
          updatePaymentUiFromCatalog();
          setPaymentStatus(t('promoCleared'), 'warn');
          return;
        }
        var sku = getCurrentSku();
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = (tg && tg.initData) ? tg.initData : '';
        try {
          var resp = await fetch(apiBase + '/api/promos/validate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ promo_code: code, sku: sku, initData: initData })
          });
          var json = await resp.json().catch(function() { return {}; });
          if (!resp.ok || !json.success || !json.valid) {
            activePromo = null;
            updatePaymentUiFromCatalog();
            throw new Error(json.error || '–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –ø—Ä–∏–Ω—è—Ç');
          }
          activePromo = {
            code: code,
            sku: sku,
            amount_before: json.amount_before,
            discount_amount: json.discount_amount,
            amount_after: json.amount_after,
            currency: json.currency || 'USDT'
          };
          updatePaymentUiFromCatalog();
          setPaymentStatus(t('promoApplied', { amount: json.amount_after, currency: json.currency || 'USDT' }), 'ok');
        } catch (e) {
          setPaymentStatus((e && e.message) ? e.message : t('promoError'), 'error');
        }
      }
      function heroesApi(path, opts) {
        var base = (window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!base) return Promise.reject(new Error('API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω'));
        var initData = (tg && tg.initData) ? tg.initData : '';
        var url = base + '/api' + path;
        var sep = path.indexOf('?') >= 0 ? '&' : '?';
        if (initData && (!opts || opts.method === 'GET')) url += sep + 'initData=' + encodeURIComponent(initData);
        if (opts && opts.query) url += (url.indexOf('?') >= 0 ? '&' : '?') + opts.query;
        var options = { headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData } };
        if (opts && opts.method) options.method = opts.method;
        if (opts && opts.body) options.body = JSON.stringify(opts.body);
        return fetch(url, options).then(function(r) {
          if (r.status === 204) return null;
          return r.json().then(function(j) { if (!r.ok) throw new Error(j.error || r.statusText); return j; });
        });
      }
      function loadMe() {
        if (!(window.HEROES_API_BASE || '').replace(/\/$/, '')) return;
        heroesApi('/me', { method: 'POST', body: { initData: (tg && tg.initData) || '' } }).then(function(d) {
          userTariff = (d && d.tariff) || 'basic';
          var masterNav = document.getElementById('masterNav');
          if (masterNav && userTariff === 'master') masterNav.style.display = 'block';
        }).catch(function() {});
      }
      async function fetchUserProfile() {
        var base = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!base || !tg || !tg.initData) return null;
        try {
          var res = await fetch(base + '/api/user/profile', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': tg.initData },
            body: JSON.stringify({ initData: tg.initData })
          });
          var json = await res.json().catch(function() { return {}; });
          return json.profile || null;
        } catch (e) { return null; }
      }
      if (tg) loadMe();
      currentLang = detectLang();
      applyTranslations();
      var langRuEl = document.getElementById('langRu');
      var langEnEl = document.getElementById('langEn');
      if (langRuEl) langRuEl.addEventListener('click', function() { setLang('ru'); });
      if (langEnEl) langEnEl.addEventListener('click', function() { setLang('en'); });

      setTimeout(function() {
        try {
        (function initProfile() {
          if (!tg || !tg.initData) return;
          fetchUserProfile().then(function(p) {
            userProfile = p;
            var greetEl = document.getElementById('homeGreeting');
            if (greetEl) {
              greetEl.textContent = (p && p.name) ? t('greeting', { name: p.name }) : t('greetingDefault');
              greetEl.style.display = 'block';
            }
          });
        })();
        if (!tg) {
          var p = document.getElementById('previewNav');
          if (p) p.classList.add('show');
        }
        var birthdateEl = document.getElementById('birthdate');
        if (birthdateEl) {
          var today = new Date();
          birthdateEl.max = today.toISOString().split('T')[0];
          var minDate = new Date();
      minDate.setFullYear(minDate.getFullYear() - 100);
          birthdateEl.min = minDate.toISOString().split('T')[0];
        }
        var unknown = document.getElementById('unknown');
        var birthtime = document.getElementById('birthtime');
        if (unknown && birthtime) unknown.addEventListener('change', function() {
        birthtime.required = !unknown.checked;
        });
        var birthdateWrap = document.getElementById('birthdateWrap');
        var birthdateCheck = document.getElementById('birthdateCheck');
        var birthdateInput = document.getElementById('birthdate');
        var birthplaceInput = document.getElementById('birthplace');
        var monthsRu = ['—è–Ω–≤–∞—Ä—è','—Ñ–µ–≤—Ä–∞–ª—è','–º–∞—Ä—Ç–∞','–∞–ø—Ä–µ–ª—è','–º–∞—è','–∏—é–Ω—è','–∏—é–ª—è','–∞–≤–≥—É—Å—Ç–∞','—Å–µ–Ω—Ç—è–±—Ä—è','–æ–∫—Ç—è–±—Ä—è','–Ω–æ—è–±—Ä—è','–¥–µ–∫–∞–±—Ä—è'];
        function formatDateRu(dateStr) {
          if (!dateStr) return '';
          var d = new Date(dateStr + 'T12:00:00');
          if (isNaN(d.getTime())) return dateStr;
          return d.getDate() + ' ' + monthsRu[d.getMonth()] + ' ' + d.getFullYear() + ' –≥.';
        }
        if (birthdateInput && birthdateWrap) {
          birthdateInput.addEventListener('change', function() {
            if (birthdateInput.value) {
              birthdateWrap.classList.add('has-date');
              if (birthdateCheck) birthdateCheck.setAttribute('aria-hidden', 'false');
            } else {
              birthdateWrap.classList.remove('has-date');
              if (birthdateCheck) birthdateCheck.setAttribute('aria-hidden', 'true');
            }
          });
          if (birthdateInput.value) {
            birthdateWrap.classList.add('has-date');
            if (birthdateCheck) birthdateCheck.setAttribute('aria-hidden', 'false');
          }
        }
        if (birthplaceInput) {
          var suggestionsEl = document.getElementById('birthplaceSuggestions');
          var wrap = document.getElementById('birthplaceWrap');
          var checkEl = document.getElementById('birthplaceCheck');
          var hintEl = document.getElementById('birthplaceHint');
          var debounceTimer = null;
          var lastSearch = '';
          function hideSuggestions() {
            if (suggestionsEl) { suggestionsEl.innerHTML = ''; suggestionsEl.setAttribute('aria-hidden', 'true'); suggestionsEl.style.display = 'none'; }
          }
          function showPlaceConfirm(displayName) {}
          function selectPlace(displayName, lat, lon) {
            var full = (displayName || '').trim();
            birthplaceInput.value = full;
            birthplaceInput.setAttribute('title', full);
            birthplaceInput.setAttribute('data-place-selected', '1');
            if (lat != null && lon != null) {
              birthplaceInput.setAttribute('data-lat', String(lat));
              birthplaceInput.setAttribute('data-lon', String(lon));
            }
            if (wrap) wrap.classList.add('has-place');
            if (checkEl) checkEl.setAttribute('aria-hidden', 'false');
            if (hintEl) hintEl.style.display = 'none';
            showPlaceConfirm(displayName);
            hideSuggestions();
          }
          function clearPlaceSelection() {
            birthplaceInput.removeAttribute('data-place-selected');
            birthplaceInput.removeAttribute('data-lat');
            birthplaceInput.removeAttribute('data-lon');
            if (wrap) wrap.classList.remove('has-place');
            if (checkEl) checkEl.setAttribute('aria-hidden', 'true');
            if (hintEl) hintEl.style.display = 'none';
          }
          function fetchPlaces(q) {
            if (!q || q.length < 2) { hideSuggestions(); return; }
            var url = 'https://nominatim.openstreetmap.org/search?q=' + encodeURIComponent(q) + '&format=json&limit=8&addressdetails=1';
            fetch(url, { headers: { 'Accept': 'application/json', 'Accept-Language': 'ru', 'User-Agent': 'YupSoulMiniApp/1.0 (contact@yupsoul.com)' } })
              .then(function(r) { return r.json(); })
              .then(function(list) {
                if (lastSearch !== q) return;
                if (!suggestionsEl) return;
                suggestionsEl.innerHTML = '';
                (list || []).forEach(function(item) {
                  var li = document.createElement('li');
                  var main = item.display_name || (item.address && (item.address.city || item.address.town || item.address.village || item.address.state || item.address.country));
                  var sub = item.address && item.address.country ? (item.address.country + (item.address.country_code ? ' (' + item.address.country_code.toUpperCase() + ')' : '')) : '';
                  li.textContent = main;
                  if (sub) { var sp = document.createElement('div'); sp.className = 'place-type'; sp.textContent = sub; li.appendChild(sp); }
                  var lat = item.lat; var lon = item.lon;
                  li.addEventListener('click', function() { selectPlace(item.display_name || main, lat, lon); });
                  suggestionsEl.appendChild(li);
                });
                suggestionsEl.style.display = (list && list.length) ? 'block' : 'none';
                suggestionsEl.setAttribute('aria-hidden', list && list.length ? 'false' : 'true');
              })
              .catch(function() { hideSuggestions(); });
          }
          birthplaceInput.addEventListener('input', function() {
            var v = birthplaceInput.value.trim();
            clearPlaceSelection();
            if (v) {
              lastSearch = v;
              clearTimeout(debounceTimer);
              debounceTimer = setTimeout(function() { fetchPlaces(v); }, 320);
            } else {
              hideSuggestions();
            }
          });
          birthplaceInput.addEventListener('focus', function() {
            if (hintEl) hintEl.style.display = 'none';
            var v = birthplaceInput.value.trim();
            if (v && v.length >= 2) { lastSearch = v; fetchPlaces(v); }
          });
          birthplaceInput.addEventListener('blur', function() {
            setTimeout(hideSuggestions, 200);
          });
          if (birthplaceInput.value.trim() && birthplaceInput.getAttribute('data-place-selected') && wrap) {
            wrap.classList.add('has-place');
            if (checkEl) checkEl.setAttribute('aria-hidden', 'false');
          }
        }
        var birthplace2Input = document.getElementById('birthplace2');
        if (birthplace2Input) {
          var debounce2 = null;
          birthplace2Input.addEventListener('input', function() {
            var self = this;
            clearTimeout(debounce2);
            debounce2 = setTimeout(function() { showLocationSuggestions(self, 'birthplaceSuggestions2', null); }, 320);
          });
        }
        var transitLocationInput = document.getElementById('transitLocation');
        if (transitLocationInput) {
          var debounceTransit = null;
          transitLocationInput.addEventListener('input', function() {
            var self = this;
            clearTimeout(debounceTransit);
            debounceTransit = setTimeout(function() { showLocationSuggestions(self, 'transitLocationSuggestions', 'transitLocationConfirmed'); }, 320);
          });
        }
        var formPage = document.getElementById('formPage');
        if (formPage && userTariff === 'master') loadForWhoSelect();
      
      // –ü–æ–¥—Å–∫–∞–∑–∫–∞ Soul Chat: –µ—Å—Ç—å –ª–∏ –¥–æ—Å—Ç—É–ø –∏ –∫–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å
      function updateSoulChatHint() {
        var hintEl = document.getElementById('soulChatHint');
        if (!hintEl) return;
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!apiBase) { hintEl.style.display = 'block'; hintEl.textContent = t('soulChatNoApi'); return; }
        var initData = typeof getInitData === 'function' ? getInitData() : '';
        hintEl.textContent = t('soulChatLoad');
        hintEl.style.display = 'block';
        fetch(apiBase + '/api/soul-chat/access', { headers: { 'X-Telegram-Init': initData } })
          .then(function(r) { return r.json(); })
          .then(function(d) {
            var payBtn = document.getElementById('soulChatPayBtn');
            if (d && d.allowed) {
              hintEl.textContent = t('soulChatHasAccess');
              if (payBtn) payBtn.style.display = 'none';
            } else {
              hintEl.textContent = (d && d.reason) ? d.reason : t('soulChatNoAccess');
              if (payBtn) payBtn.style.display = 'block';
            }
          })
          .catch(function() {
            hintEl.textContent = t('soulChatDefault');
            var payBtn = document.getElementById('soulChatPayBtn');
            if (payBtn) payBtn.style.display = 'block';
          });
      }
      // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º
      function goToPage(pageId) {
        if (tg && tg.MainButton && tg.MainButton.hide) tg.MainButton.hide();
        if (pageId !== 'paymentPage') {
          var payBtnReset = document.getElementById('payBtn');
          if (payBtnReset) { payBtnReset.disabled = false; payBtnReset.textContent = t('submitRequest'); }
        }
        document.querySelectorAll('.page').forEach(function(page) {
          page.classList.remove('active');
        });
        var target = document.getElementById(pageId);
        if (target) target.classList.add('active');
        if (pageId === 'formPage' && userTariff === 'master') loadForWhoSelect();
        if (pageId === 'paymentPage') { loadPricingCatalog(); updatePaymentUiFromCatalog(); setPaymentStatus('',''); }
        if (pageId === 'successPage') updateSoulChatHint();
        if (pageId === 'homePage' || pageId === 'formPage' || pageId === 'paymentPage') {
          logColorSnapshot('go-to-page', pageId);
        }
        if (document.getElementById('previewNav') && document.getElementById('previewNav').classList.contains('show')) {
          document.querySelectorAll('.preview-nav button').forEach(function(btn) {
            btn.classList.remove('active');
          });
          var pageMap = { 'homePage': 'home', 'formPage': 'form', 'paymentPage': 'payment', 'loadingPage': 'loading', 'successPage': 'success', 'heroesPage': 'heroes', 'paymentThanksPage': 'payment' };
          var activeBtn = document.querySelector('.preview-nav button[data-page="' + (pageMap[pageId] || '') + '"]');
          if (activeBtn) activeBtn.classList.add('active');
        }
      }

      // –†–µ–¥–∏—Ä–µ–∫—Ç —Å HOT: –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å ?payment=success –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É ¬´–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É¬ª
      var search = typeof window.location !== 'undefined' && window.location.search ? window.location.search : '';
      var paymentThanksMsg = document.getElementById('paymentThanksMessage');
      if (search.indexOf('payment=success') !== -1) {
        goToPage('paymentThanksPage');
        var requestIdMatch = search.match(/request_id=([^&\s]+)/);
        var thanksRequestId = requestIdMatch ? decodeURIComponent(requestIdMatch[1]) : null;
        (async function checkPaymentAndConfirm() {
          if (!paymentThanksMsg) return;
          if (!thanksRequestId) {
            paymentThanksMsg.textContent = t('songInProgress');
            return;
          }
          var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
          var initData = (tg && tg.initData) ? tg.initData : (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initData) || '';
          if (!apiBase || !initData) {
            if (paymentThanksMsg) paymentThanksMsg.textContent = t('songInProgress');
            return;
          }
          try {
            var payStatus = '';
            for (var attempt = 0; attempt < 3; attempt++) {
              var statusResp = await fetch(apiBase + '/api/payments/hot/status?request_id=' + encodeURIComponent(thanksRequestId), {
                headers: { 'X-Telegram-Init': initData }
              });
              var statusJson = await statusResp.json().catch(function() { return {}; });
              payStatus = statusJson && statusJson.data && statusJson.data.payment_status ? String(statusJson.data.payment_status).toLowerCase() : '';
              if (payStatus === 'paid') break;
              if (attempt < 2) await new Promise(function(r) { setTimeout(r, 2000); });
            }
            if (payStatus === 'paid') {
              var confirmResp = await fetch(apiBase + '/api/payments/hot/confirm', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
                body: JSON.stringify({ request_id: thanksRequestId, initData: initData })
              });
              confirmResp.json().catch(function() {});
            }
            paymentThanksMsg.textContent = t('songInProgressConfirmed');
          } catch (e) {
            paymentThanksMsg.textContent = t('songInProgress');
          }
        })();
        if (window.history && window.history.replaceState) {
          var cleanUrl = window.location.pathname + (window.location.hash || '');
          window.history.replaceState({}, '', cleanUrl);
        }
      }
      var paymentThanksBackBtn = document.getElementById('paymentThanksBackBtn');
      if (paymentThanksBackBtn) paymentThanksBackBtn.addEventListener('click', function() {
        var sp = document.getElementById('songPreviewText');
        if (sp) sp.textContent = '–¢–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ß–µ—Ä–µ–∑ 2‚Äì3 –º–∏–Ω—É—Ç—ã –æ–Ω –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç.';
        goToPage('successPage');
      });

      // –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
      var startBtn = document.getElementById('startBtn');
      if (startBtn) startBtn.addEventListener('click', function() {
        fillFormFromProfile(userProfile || (tg && tg.initDataUnsafe && tg.initDataUnsafe.user));
        goToPage('formPage');
      });

      var stepNext = document.getElementById('stepNext');
      var quickToggle = document.getElementById('quickRequestsToggle');
      var quickPanel = document.getElementById('quickRequestsPanel');
      var selectedMode = 'single';
      var hotDebugToggle = document.getElementById('hotDebugToggle');
      var hotDebugPanel = document.getElementById('hotDebugPanel');
      var hotDebugList = document.getElementById('hotDebugList');

      function hotLog(message, data) {
        if (!hotDebugList) return;
        var row = document.createElement('div');
        row.className = 'row';
        var payload = '';
        if (data) {
          try { payload = JSON.stringify(data); } catch (e) { payload = String(data); }
        }
        row.textContent = '[' + new Date().toLocaleTimeString() + '] ' + message + (payload ? ' ' + payload : '');
        hotDebugList.prepend(row);
        while (hotDebugList.children.length > 20) hotDebugList.removeChild(hotDebugList.lastChild);
      }
      function ensureHotDebugVisible() {
        if (hotDebugToggle && !tg) hotDebugToggle.style.display = 'block';
      }
      if (hotDebugToggle && hotDebugPanel) {
        hotDebugToggle.addEventListener('click', function() {
          var visible = hotDebugPanel.style.display === 'block';
          hotDebugPanel.style.display = visible ? 'none' : 'block';
        });
      }

      function applyTheme() {
        var hour = new Date().getHours();
        var theme = (hour >= 7 && hour < 19) ? 'theme-light' : 'theme-dark';
        document.body.classList.remove('theme-light', 'theme-dark');
        document.body.classList.add(theme);
      }
      applyTheme();

      function toggleFormsByMode(mode) {
        var secondForm = document.getElementById('secondPersonForm');
        var transitForm = document.getElementById('transitForm');
        if (secondForm) secondForm.style.display = 'none';
        if (transitForm) transitForm.style.display = 'none';
        if (mode === 'couple' && secondForm) {
          secondForm.style.display = 'block';
        } else if (mode === 'transit' && transitForm) {
          transitForm.style.display = 'block';
        }
      }

      function updateStepUI() {
        document.querySelectorAll('.mode-btn').forEach(function(btn) { btn.style.display = ''; });
      }

      function setMode(mode) {
        selectedMode = mode || 'single';
        document.querySelectorAll('.mode-btn').forEach(function(btn) {
          btn.classList.toggle('active', btn.getAttribute('data-mode') === selectedMode);
        });
        toggleFormsByMode(selectedMode);
        updatePaymentUiFromCatalog();
      }

      function validateStep(step) {
        if (step === 1) {
          selectedMode = selectedMode || 'single';
          return true;
        }
        if (step === 2) {
          var nameEl = document.getElementById('name');
          var name = (nameEl ? nameEl.value : '').trim();
          var birthdateEl = document.getElementById('birthdate');
          var birthdate = birthdateEl ? birthdateEl.value : '';
          var birthplaceEl = document.getElementById('birthplace');
          var birthplace = (birthplaceEl ? birthplaceEl.value : '').trim();
          var unknownEl = document.getElementById('unknown');
          var birthtimeEl = document.getElementById('birthtime');
          var birthtimeVal = (unknownEl && unknownEl.checked) ? 'ok' : (birthtimeEl ? birthtimeEl.value : '');
          var genderEl = document.getElementById('gender');
          var gender = genderEl ? genderEl.value : '';
          var langEl = document.getElementById('language');
          var language = langEl ? langEl.value : '';
          if (name.length < 2) { alert(t('alertNameShort')); return false; }
          if (!birthdate) { alert(t('alertBirthdate')); return false; }
          if (birthplace.length < 3) { alert(t('alertBirthplace')); return false; }
          var birthplaceField = document.getElementById('birthplace');
          var hasCoords = birthplaceField && birthplaceField.getAttribute('data-lat') && birthplaceField.getAttribute('data-lon');
          var hasPlaceSelected = birthplaceField && birthplaceField.getAttribute('data-place-selected');
          var fromProfile = birthplaceField && birthplaceField.getAttribute('data-from-profile') === '1';
          if (!hasCoords && !hasPlaceSelected && !fromProfile) {
            var birthplaceHint = document.getElementById('birthplaceHint');
            if (birthplaceHint) birthplaceHint.style.display = 'block';
            return false;
          }
          if (!birthtimeVal) { alert(t('alertBirthtime')); return false; }
          if (!gender) { alert(t('alertGender')); return false; }
          if (!language) { alert(t('alertLanguage')); return false; }
          if (selectedMode === 'couple') {
            var name2 = (document.getElementById('name2').value || '').trim();
            var birthdate2 = document.getElementById('birthdate2').value;
            if (name2.length < 2) { alert(t('alertName2Short')); return false; }
            if (!birthdate2) { alert(t('alertBirthdate2')); return false; }
          }
          if (selectedMode === 'transit') {
            var tDate = document.getElementById('transitDate').value;
            var tLoc = document.getElementById('transitLocation').value.trim();
            if (!tDate) { alert('–£–∫–∞–∂–∏ –¥–∞—Ç—É —Å–æ–±—ã—Ç–∏—è'); return false; }
            if (!tLoc) { alert('–£–∫–∞–∂–∏ –ª–æ–∫–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏—è'); return false; }
          }
          return true;
        }
        if (step === 3) {
          var request = document.getElementById('request').value.trim();
          if (request.length < 5) { alert('–î–æ–±–∞–≤—å –∑–∞–ø—Ä–æ—Å (5+ —Å–∏–º–≤–æ–ª–æ–≤)'); return false; }
          return true;
        }
        return true;
      }

      document.querySelectorAll('.mode-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
          setMode(this.getAttribute('data-mode'));
        });
      });

      if (quickToggle && quickPanel) {
        quickToggle.addEventListener('click', function(e) {
          e.stopPropagation();
          var isOpen = quickPanel.classList.toggle('open');
          this.classList.toggle('open', isOpen);
          this.setAttribute('aria-expanded', String(isOpen));
          this.textContent = isOpen ? t('hide') : t('quickRequests');
        });
        document.addEventListener('click', function closeQuickPanel(e) {
          if (!quickPanel.classList.contains('open')) return;
          var drop = quickPanel.closest('.quick-dropdown');
          if (drop && drop.contains(e.target)) return;
          quickPanel.classList.remove('open');
          if (quickToggle) {
            quickToggle.classList.remove('open');
            quickToggle.setAttribute('aria-expanded', 'false');
            quickToggle.textContent = t('quickRequests');
          }
        });
      }
      document.querySelectorAll('.example-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
          var requestField = document.getElementById('request');
          if (requestField) {
            requestField.value = this.getAttribute('data-text') || '';
            requestField.focus();
          }
          if (quickPanel) {
            quickPanel.classList.remove('open');
            if (quickToggle) {
              quickToggle.classList.remove('open');
              quickToggle.setAttribute('aria-expanded', 'false');
              quickToggle.textContent = t('quickRequests');
            }
          }
        });
      });

      if (stepNext) stepNext.addEventListener('click', function() {
        if (!validateStep(1)) return;
        if (!validateStep(2)) return;
        if (!validateStep(3)) return;
        goToPage('paymentPage');
      });
      setMode('single');
      updateStepUI();
      var promoApplyBtn = document.getElementById('promoApplyBtn');
      if (promoApplyBtn) promoApplyBtn.addEventListener('click', applyPromoCode);
      
      var backFromPaymentBtn = document.getElementById('backFromPaymentBtn');
      if (backFromPaymentBtn) backFromPaymentBtn.addEventListener('click', function() {
        if (tg && tg.MainButton && tg.MainButton.hide) tg.MainButton.hide();
        var payBtnEl = document.getElementById('payBtn');
        if (payBtnEl) { payBtnEl.disabled = false; payBtnEl.textContent = t('submitRequest'); }
        goToPage('formPage');
      });
      var payBtn = document.getElementById('payBtn');
      if (payBtn) payBtn.addEventListener('click', async function() {
        if (payBtn.disabled) return;
        var mode = selectedMode || 'single';
        var name1 = document.getElementById('name').value.trim();
        var birthdate1 = document.getElementById('birthdate').value;
        var birthplace1 = document.getElementById('birthplace').value.trim();
        var birthtime1 = document.getElementById('birthtime').value;
        var birthtimeUnknown1 = document.getElementById('unknown').checked;
        var gender1 = document.getElementById('gender').value;
        var requestText = document.getElementById('request').value.trim();
        if (name1.length < 2) { alert('‚ú® –ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞'); return; }
        if (!birthdate1) { alert('‚ú® –í—ã–±–µ—Ä–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è'); return; }
        if (birthplace1.length < 3) { alert('‚ú® –ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞'); return; }
        if (!birthtimeUnknown1 && !birthtime1) { alert('‚ú® –£–∫–∞–∂–∏ –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–º–µ—Ç—å "–ù–µ –∑–Ω–∞—é"'); return; }
        if (!gender1) { alert('‚ú® –í—ã–±–µ—Ä–∏ —Å–≤–æ–π –ø—É—Ç—å'); return; }
        if (requestText.length < 15) { alert('‚ú® –†–∞—Å—Å–∫–∞–∂–∏ –í—Å–µ–ª–µ–Ω–Ω–æ–π –ø–æ–¥—Ä–æ–±–Ω–µ–µ (–º–∏–Ω–∏–º—É–º 15 —Å–∏–º–≤–æ–ª–æ–≤)'); return; }
        var payload = {
          mode: mode,
          person1: { name: name1, birthdate: birthdate1, birthplace: birthplace1, birthtime: birthtimeUnknown1 ? null : birthtime1, birthtimeUnknown: birthtimeUnknown1, gender: gender1 },
          request: requestText,
          language: currentLang || 'ru'
        };
        var birthplaceField = document.getElementById('birthplace');
        if (birthplaceField && birthplaceField.getAttribute('data-lat') && birthplaceField.getAttribute('data-lon')) {
          payload.person1.birthplaceLat = parseFloat(birthplaceField.getAttribute('data-lat'));
          payload.person1.birthplaceLon = parseFloat(birthplaceField.getAttribute('data-lon'));
        }
        var forWho = document.getElementById('forWho');
        if (forWho && forWho.value && userTariff === 'master') payload.clientId = forWho.value;
        if (mode === 'couple') {
          var name2 = document.getElementById('name2').value.trim();
          var birthdate2 = document.getElementById('birthdate2').value;
          var birthplace2 = document.getElementById('birthplace2').value.trim();
          var birthtime2 = document.getElementById('birthtime2').value;
          var birthtimeUnknown2 = document.getElementById('unknown2').checked;
          var gender2 = document.getElementById('gender2').value;
          if (name2.length < 2) { alert('‚ú® –ò–º—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞'); return; }
          if (!birthdate2) { alert('‚ú® –í—ã–±–µ—Ä–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞'); return; }
          if (birthplace2.length < 3) { alert('‚ú® –ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞'); return; }
          if (!birthtimeUnknown2 && !birthtime2) { alert('‚ú® –£–∫–∞–∂–∏ –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞'); return; }
          if (!gender2) { alert('‚ú® –í—ã–±–µ—Ä–∏ –ø–æ–ª –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞'); return; }
          payload.person2 = { name: name2, birthdate: birthdate2, birthplace: birthplace2, birthtime: birthtimeUnknown2 ? null : birthtime2, birthtimeUnknown: birthtimeUnknown2, gender: gender2 };
        }
        if (mode === 'transit') {
          var transitDate = document.getElementById('transitDate').value;
          var transitTime = document.getElementById('transitTime').value;
          var transitLocation = (document.getElementById('transitLocation') && document.getElementById('transitLocation').value) ? document.getElementById('transitLocation').value.trim() : '';
          var transitIntent = (document.getElementById('transitIntent') && document.getElementById('transitIntent').value) ? document.getElementById('transitIntent').value.trim() : null;
          if (!transitDate) { alert('‚ú® –í—ã–±–µ—Ä–∏ –¥–∞—Ç—É —Å–æ–±—ã—Ç–∏—è'); return; }
          if (!transitLocation) { alert('‚ú® –£–∫–∞–∂–∏ –ª–æ–∫–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏—è'); return; }
          if (!(document.getElementById('transitLocationConfirmed') && document.getElementById('transitLocationConfirmed').checked)) { alert('‚ú® –ü–æ–¥—Ç–≤–µ—Ä–¥–∏, —á—Ç–æ –ª–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ'); return; }
          payload.transit = { date: transitDate, time: transitTime || null, location: transitLocation, intent: transitIntent || null };
        }
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!apiBase) {
          alert('–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–¥—Ä–µ—Å API. –£–∫–∞–∂–∏ HEROES_API_BASE.'); return;
        }
        var initData = getInitData();
        if (!initData) {
          // #region agent log
          // #endregion
          alert('–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º –≤ Telegram ‚Äî –∏–Ω–∞—á–µ –∑–∞—è–≤–∫—É –Ω–µ–ª—å–∑—è –ø—Ä–∏–Ω—è—Ç—å.'); return;
        }
        payload.initData = initData;
        try {
          // #region agent log
          // #endregion
          hotLog('pay click', { mode: mode, hasPerson2: !!payload.person2, hasTransit: !!payload.transit });
          var submitTimeoutMs = 90000;
          var controller = new AbortController();
          var timeoutId = setTimeout(function() { controller.abort(); }, submitTimeoutMs);
          var response;
          try {
            response = await fetch(apiBase + '/api/submit-request', { method: 'POST', headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData }, body: JSON.stringify(payload), signal: controller.signal });
          } catch (e) {
            clearTimeout(timeoutId);
            if (e && e.name === 'AbortError') {
              setPaymentStatus(t('alertServerSleep'), 'error');
              alert(t('alertServerSleep'));
              return;
            }
            throw e;
          }
          clearTimeout(timeoutId);
          var result = await response.json().catch(function() { return {}; });
          // #region agent log
          // #endregion
          hotLog('submit result', { ok: !!(response.ok && result.ok), paymentRequired: !!(result && result.payment_required), requestId: result && result.requestId ? String(result.requestId).slice(0, 8) : null, httpStatus: response.status });
          if (response.ok && result.ok && result.requestId) {
            goToPage('loadingPage');
            var sp = document.getElementById('songPreviewText');
            if (sp) {
              if (mode === 'single') sp.textContent = '‚ú® ' + name1 + ', –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å.\n\n–¢–≤–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –æ–Ω –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç.';
              else if (mode === 'couple') sp.textContent = '‚ú® ' + name1 + ' –∏ ' + payload.person2.name + ', –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ –≤–∞—à –∑–∞–ø—Ä–æ—Å.\n\n–í–∞—à –∑–≤—É–∫–æ–≤–æ–π –∫–ª—é—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –æ–Ω –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç.';
              else sp.textContent = '‚ú® ' + name1 + ', –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å.\n\n–ó–≤—É–∫–æ–≤–æ–π –∫–ª—é—á –≠–Ω–µ—Ä–≥–∏–∏ –î–Ω—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –æ–Ω –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç.';
            }
            if (tg && tg.disableClosingConfirmation) try { tg.disableClosingConfirmation(); } catch (e) {}
            goToPage('successPage');
            console.log('[MiniApp] –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞, requestId:', result.requestId);
          } else if (result && result.payment_required && result.requestId) {
            setPaymentStatus(t('paymentRequiredOpening'), 'warn');
            var hotCtrl = new AbortController();
            var hotTimeout = setTimeout(function() { hotCtrl.abort(); }, 30000);
            var hotResp;
            try {
              hotResp = await fetch(apiBase + '/api/payments/hot/create', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
                body: JSON.stringify({ request_id: result.requestId, sku: result.sku || getCurrentSku(), promo_code: activePromo ? activePromo.code : null, initData: initData }),
                signal: hotCtrl.signal
              });
            } catch (hotErr) {
              clearTimeout(hotTimeout);
              if (hotErr && hotErr.name === 'AbortError') {
                setPaymentStatus(t('alertServerSleep'), 'error');
                alert(t('alertServerSleep'));
                return;
              }
              throw hotErr;
            }
            clearTimeout(hotTimeout);
            var hotJson = await hotResp.json().catch(function() { return {}; });
            // #region agent log
            // #endregion
            hotLog('hot create', { status: hotResp.status, success: !!(hotJson && hotJson.success), freeApplied: !!hotJson.free_applied, hasCheckout: !!hotJson.checkout_url, requestId: result.requestId ? String(result.requestId).slice(0, 8) : null });
            if (!hotResp.ok || !hotJson.success) {
              throw new Error(hotJson.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ–ø–ª–∞—Ç—É HOT');
            }
            if (hotJson.free_applied) {
              setPaymentStatus(t('promoFreeGen'), 'ok');
              goToPage('loadingPage');
              setTimeout(function() { goToPage('successPage'); }, 1800);
              return;
            }
            if (!hotJson.checkout_url) throw new Error('Checkout URL –Ω–µ –ø–æ–ª—É—á–µ–Ω');
            setPaymentStatus(t('hotCheckoutOpened'), 'warn');
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.openLink) window.Telegram.WebApp.openLink(hotJson.checkout_url);
            else window.open(hotJson.checkout_url, '_blank');
            var maxAttempts = 60;
            var attempt = 0;
            var paid = false;
            while (attempt < maxAttempts) {
              attempt += 1;
              await new Promise(function(resolve) { setTimeout(resolve, 3000); });
              var statusResp = await fetch(apiBase + '/api/payments/hot/status?request_id=' + encodeURIComponent(result.requestId), {
                headers: { 'X-Telegram-Init': initData }
              });
              var statusJson = await statusResp.json().catch(function() { return {}; });
              var paymentStatus = statusJson && statusJson.data && statusJson.data.payment_status ? String(statusJson.data.payment_status).toLowerCase() : '';
              if (attempt === 1 || paymentStatus === 'paid') {
                // #region agent log
                // #endregion
                hotLog('status poll', { attempt: attempt, status: paymentStatus || null, httpStatus: statusResp.status });
              }
              if (paymentStatus === 'paid') { paid = true; break; }
            }
            if (!paid) {
              setPaymentStatus(t('paymentNotConfirmed'), 'warn');
              return;
            }
            setPaymentStatus(t('paymentConfirmed'), 'ok');
            var restartResp = await fetch(apiBase + '/api/payments/hot/confirm', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
              body: JSON.stringify({ request_id: result.requestId, initData: initData })
            });
            // #region agent log
            // #endregion
            hotLog('confirm', { httpStatus: restartResp.status, ok: restartResp.ok, requestId: result.requestId ? String(result.requestId).slice(0, 8) : null });
            if (!restartResp.ok) {
              setPaymentStatus(t('paymentReceivedNoStart', { id: result.requestId }), 'warn');
              return;
            }
            goToPage('loadingPage');
            setTimeout(function() { goToPage('successPage'); }, 1800);
          } else {
            var errMsg = (result && result.error) ? String(result.error) : (result && result.message) ? String(result.message) : ('HTTP ' + response.status);
            if (response.status === 401) {
              errMsg = (result && result.error) ? String(result.error) : '–°–µ—Å—Å–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞. –ó–∞–∫—Ä–æ–π Mini App –∏ –æ—Ç–∫—Ä–æ–π —Å–Ω–æ–≤–∞ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º, –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤—å –∑–∞—è–≤–∫—É.';
            }
            throw new Error(errMsg);
          }
        } catch (error) {
          console.error('[MiniApp] –û—à–∏–±–∫–∞:', error);
          var msg = (error && error.message) ? String(error.message) : '';
          if (!msg || /^HTTP\s+\d+$/i.test(msg)) {
            msg = t('submitFailed');
          }
          setPaymentStatus(msg || t('errorOp'), 'error');
          alert('‚ùå ' + (msg || t('errorOp')));
          // #region agent log
          // #endregion
          hotLog('error', { message: msg || null });
        }
      });
      
      var goHeroesBtn = document.getElementById('goHeroesBtn');
      if (goHeroesBtn) goHeroesBtn.addEventListener('click', function() { goToPage('heroesPage'); loadHeroesList(); });

      function loadHeroesList() {
        var listEl = document.getElementById('heroesList');
        if (!listEl) return;
        listEl.innerHTML = '<p style="color:#6b7280">–ó–∞–≥—Ä—É–∑–∫–∞...</p>';
        var search = (document.getElementById('heroesSearch') || {}).value;
        var q = search ? '?search=' + encodeURIComponent(search) : '';
        heroesApi('/heroes' + q, { method: 'GET' }).then(function(d) {
          heroesCache = (d && d.clients) || [];
          if (!heroesCache.length) { listEl.innerHTML = '<p style="color:#6b7280">–ü–æ–∫–∞ –Ω–µ—Ç –≥–µ—Ä–æ–µ–≤. –ù–∞–∂–º–∏ ¬´–î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è¬ª.</p>'; return; }
          listEl.innerHTML = heroesCache.map(function(h) {
            var dateStr = h.birth_date || '‚Äî';
            var addStr = h.created_at ? new Date(h.created_at).toLocaleDateString('ru-RU') : '';
            return '<div class="section" style="margin-bottom:12px" data-hero-id="' + (h.id || '') + '">' +
              '<div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px">' +
              '<strong>' + (h.name || '‚Äî') + '</strong>' +
              '<span style="font-size:.9rem;color:#6b7280">' + dateStr + (addStr ? ' ¬∑ ' + addStr : '') + '</span>' +
              '</div>' +
              (h.birth_place ? '<div style="font-size:.95rem;color:#6b7280;margin-top:6px">' + h.birth_place + '</div>' : '') +
              '<div style="margin-top:10px;display:flex;gap:8px">' +
              '<button type="button" class="secondary hero-edit-btn" style="padding:8px 14px;font-size:.9rem" data-id="' + (h.id || '') + '">–ò–∑–º–µ–Ω–∏—Ç—å</button>' +
              '<button type="button" class="secondary hero-delete-btn" style="padding:8px 14px;font-size:.9rem;color:#dc2626" data-id="' + (h.id || '') + '" data-name="' + (h.name || '').replace(/"/g, '&quot;') + '">–£–¥–∞–ª–∏—Ç—å</button>' +
              '</div></div>';
          }).join('');
          listEl.querySelectorAll('.hero-edit-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
              var id = btn.getAttribute('data-id');
              var h = heroesCache.find(function(c) { return c.id === id; });
              if (!h) return;
              editingHeroId = id;
              document.getElementById('heroName').value = h.name || '';
              document.getElementById('heroBirthdate').value = h.birth_date || '';
              document.getElementById('heroBirthtime').value = (h.birth_time || '').substring(0, 5);
              document.getElementById('heroBirthplace').value = h.birth_place || '';
              document.getElementById('heroBirthtimeUnknown').checked = !!h.birthtime_unknown;
              document.getElementById('heroGender').value = h.gender || '';
              document.getElementById('heroNotes').value = h.notes || '';
              document.getElementById('heroFormWrap').style.display = 'block';
            });
          });
          listEl.querySelectorAll('.hero-delete-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
              var id = btn.getAttribute('data-id');
              var name = btn.getAttribute('data-name') || '—ç—Ç–æ–≥–æ –≥–µ—Ä–æ—è';
              if (!confirm('–£–¥–∞–ª–∏—Ç—å ¬´' + name + '¬ª? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) return;
              heroesApi('/heroes/' + id, { method: 'DELETE' }).then(function() { loadHeroesList(); }).catch(function(e) { alert('–û—à–∏–±–∫–∞: ' + (e.message || e)); });
            });
          });
        }).catch(function(e) {
          listEl.innerHTML = '<p style="color:#dc2626">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É API.</p>';
        });
      }
      var addHeroBtn = document.getElementById('addHeroBtn');
      var heroFormWrap = document.getElementById('heroFormWrap');
      var heroFormCancel = document.getElementById('heroFormCancel');
      if (addHeroBtn) addHeroBtn.addEventListener('click', function() {
        editingHeroId = null;
        document.getElementById('heroName').value = '';
        document.getElementById('heroBirthdate').value = '';
        document.getElementById('heroBirthtime').value = '';
        document.getElementById('heroBirthplace').value = '';
        document.getElementById('heroBirthtimeUnknown').checked = false;
        document.getElementById('heroGender').value = '';
        document.getElementById('heroNotes').value = '';
        heroFormWrap.style.display = 'block';
      });
      if (heroFormCancel) heroFormCancel.addEventListener('click', function() { heroFormWrap.style.display = 'none'; editingHeroId = null; });
      var heroFormSave = document.getElementById('heroFormSave');
      if (heroFormSave) heroFormSave.addEventListener('click', function() {
        var name = (document.getElementById('heroName') || {}).value.trim();
        if (!name) { alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è'); return; }
        var payload = {
          initData: (tg && tg.initData) || '',
          name: name,
          birth_date: (document.getElementById('heroBirthdate') || {}).value || null,
          birth_time: (document.getElementById('heroBirthtime') || {}).value || null,
          birth_place: (document.getElementById('heroBirthplace') || {}).value.trim() || null,
          birthtime_unknown: (document.getElementById('heroBirthtimeUnknown') || {}).checked,
          gender: (document.getElementById('heroGender') || {}).value || null,
          notes: (document.getElementById('heroNotes') || {}).value.trim() || null
        };
        if (editingHeroId) {
          heroesApi('/heroes/' + editingHeroId, { method: 'PATCH', body: payload }).then(function() {
            heroFormWrap.style.display = 'none';
            editingHeroId = null;
            loadHeroesList();
          }).catch(function(e) { alert('–û—à–∏–±–∫–∞: ' + (e.message || e)); });
        } else {
          heroesApi('/heroes', { method: 'POST', body: payload }).then(function() {
            heroFormWrap.style.display = 'none';
            loadHeroesList();
          }).catch(function(e) { alert('–û—à–∏–±–∫–∞: ' + (e.message || e)); });
        }
      });
      var heroesSearchBtn = document.getElementById('heroesSearchBtn');
      if (heroesSearchBtn) heroesSearchBtn.addEventListener('click', loadHeroesList);
      var heroesBackBtn = document.getElementById('heroesBackBtn');
      if (heroesBackBtn) heroesBackBtn.addEventListener('click', function() { goToPage('homePage'); });
      var todayHero = new Date();
      var heroBirthdateEl = document.getElementById('heroBirthdate');
      if (heroBirthdateEl) {
        heroBirthdateEl.max = todayHero.toISOString().split('T')[0];
        var minH = new Date(); minH.setFullYear(minH.getFullYear() - 100);
        heroBirthdateEl.min = minH.toISOString().split('T')[0];
      }

      function fillFormFromProfile(profileOrTgUser) {
        if (!profileOrTgUser) return;
        var nameEl = document.getElementById('name');
        var bd = document.getElementById('birthdate');
        var bt = document.getElementById('birthtime');
        var bp = document.getElementById('birthplace');
        var unk = document.getElementById('unknown');
        var g = document.getElementById('gender');
        var langEl = document.getElementById('language');
        var isProfile = profileOrTgUser && (profileOrTgUser.birthdate != null || profileOrTgUser.birthplace != null);
        var firstName = profileOrTgUser.first_name || profileOrTgUser.name;
        if (nameEl && firstName) nameEl.value = firstName;
        if (isProfile) {
          if (bd) bd.value = (profileOrTgUser.birthdate || '').toString().slice(0, 10);
          if (bt) bt.value = (profileOrTgUser.birthtime || '').toString().slice(0, 5);
          if (bp) {
            bp.value = profileOrTgUser.birthplace || '';
            if (profileOrTgUser.birthplace && profileOrTgUser.birthplace.length >= 3) {
              bp.setAttribute('data-from-profile', '1');
              bp.setAttribute('data-place-selected', '1');
              var bw = document.getElementById('birthplaceWrap'); if (bw) bw.classList.add('has-place');
              var bch = document.getElementById('birthplaceCheck'); if (bch) bch.setAttribute('aria-hidden', 'false');
              if (profileOrTgUser.birthplace_lat != null && profileOrTgUser.birthplace_lon != null) {
                bp.setAttribute('data-lat', String(profileOrTgUser.birthplace_lat));
                bp.setAttribute('data-lon', String(profileOrTgUser.birthplace_lon));
              }
            } else { bp.removeAttribute('data-from-profile'); bp.removeAttribute('data-place-selected'); }
          }
          if (unk) unk.checked = !!profileOrTgUser.birthtime_unknown;
          if (g) g.value = profileOrTgUser.gender || '';
          if (langEl && profileOrTgUser.language) langEl.value = profileOrTgUser.language;
          var bdWrap = document.getElementById('birthdateWrap');
          if (bdWrap) {
            if (profileOrTgUser.birthdate) { bdWrap.classList.add('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'false'); }
            else { bdWrap.classList.remove('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'true'); }
          }
        }
      }
      function fillFormFromHero(hero) {
        if (!hero) return;
        var nameEl = document.getElementById('name');
        var bd = document.getElementById('birthdate');
        var bt = document.getElementById('birthtime');
        var bp = document.getElementById('birthplace');
        var unk = document.getElementById('unknown');
        var g = document.getElementById('gender');
        if (nameEl) nameEl.value = hero.name || '';
        if (bd) bd.value = hero.birth_date || '';
        if (bt) bt.value = (hero.birth_time || '').substring(0, 5);
        if (bp) bp.value = hero.birth_place || '';
        if (unk) unk.checked = !!hero.birthtime_unknown;
        if (g) g.value = hero.gender || '';
        var langEl = document.getElementById('language');
        if (langEl && hero.language) langEl.value = hero.language;
        var bdWrap = document.getElementById('birthdateWrap');
        if (bdWrap) {
          if (hero.birth_date) { bdWrap.classList.add('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'false'); }
          else { bdWrap.classList.remove('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'true'); }
        }
      }
      function loadForWhoSelect() {
        var wrap = document.getElementById('forWhoWrap');
        var sel = document.getElementById('forWho');
        if (!wrap || !sel) return;
        if (userTariff !== 'master') { wrap.style.display = 'none'; return; }
        wrap.style.display = 'block';
        heroesApi('/heroes', { method: 'GET' }).then(function(d) {
          heroesCache = (d && d.clients) || [];
          sel.innerHTML = '<option value="">–î–ª—è —Å–µ–±—è</option>' + heroesCache.map(function(h) { return '<option value="' + (h.id || '') + '">–î–ª—è: ' + (h.name || '‚Äî') + '</option>'; }).join('');
          sel.addEventListener('change', function() {
            var id = sel.value;
            if (!id) { fillFormFromHero(null); return; }
            var hero = heroesCache.find(function(c) { return c.id === id; });
            if (hero) fillFormFromHero(hero);
          });
        }).catch(function() { wrap.style.display = 'none'; });
      }

      var soulChatBtn = document.getElementById('soulChatBtn');
      if (soulChatBtn) soulChatBtn.addEventListener('click', function() {
        var botUrl = 'https://t.me/Yup_Soul_bot';
        if (tg && tg.openTelegramLink) tg.openTelegramLink(botUrl);
        else window.open(botUrl, '_blank');
      });
      var soulChatPayBtn = document.getElementById('soulChatPayBtn');
      if (soulChatPayBtn) soulChatPayBtn.addEventListener('click', function() { goToPage('formPage'); setTimeout(function() { var stepNext = document.getElementById('stepNext'); if (stepNext) stepNext.click(); }, 100); });
      var newKeyBtn = document.getElementById('newKeyBtn');
      if (newKeyBtn) newKeyBtn.addEventListener('click', function() {
        var n = document.getElementById('name');
        var bd = document.getElementById('birthdate');
        var bp = document.getElementById('birthplace');
        var bt = document.getElementById('birthtime');
        var g = document.getElementById('gender');
        var langEl = document.getElementById('language');
        var r = document.getElementById('request');
        if (n) n.value = '';
        if (bd) bd.value = '';
        if (bp) bp.value = '';
        if (bt) bt.value = '';
        var unknownChk = document.getElementById('unknown'); if (unknownChk) unknownChk.checked = false;
        if (g) g.value = '';
        if (langEl) langEl.value = '';
        if (r) r.value = '';
        var bdWrap = document.getElementById('birthdateWrap');
        if (bdWrap) { bdWrap.classList.remove('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'true'); }
        var birthplaceHint = document.getElementById('birthplaceHint');
        if (birthplaceHint) birthplaceHint.style.display = 'none';
        var bpEl = document.getElementById('birthplace');
        if (bpEl) { bpEl.removeAttribute('data-place-selected'); bpEl.removeAttribute('data-lat'); bpEl.removeAttribute('data-lon'); }
        var wrap = document.getElementById('birthplaceWrap');
        if (wrap) wrap.classList.remove('has-place');
        goToPage('formPage');
      });
      
      document.querySelectorAll('.preview-nav button').forEach(function(button) {
        button.addEventListener('click', function() {
          var pageMap = { 'home': 'homePage', 'form': 'formPage', 'payment': 'paymentPage', 'loading': 'loadingPage', 'success': 'successPage', 'heroes': 'heroesPage' };
          document.querySelectorAll('.preview-nav button').forEach(function(btn) { btn.classList.remove('active'); });
          this.classList.add('active');
          goToPage(pageMap[button.getAttribute('data-page')] || 'homePage');
        });
      });
      
      (function checkAdminAndShowLink() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = (tg && tg.initData) ? tg.initData : (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initData) || '';
        if (!apiBase || !initData) return;
        fetch(apiBase + '/api/admin/me', { headers: { 'X-Telegram-Init': initData } })
          .then(function(r) { return r.json(); })
          .then(function(data) {
            if (!data || !data.admin) return;
            var wrap = document.getElementById('adminLinkWrap');
            var btn = document.getElementById('adminLinkBtn');
            if (!wrap || !btn) return;
            wrap.style.display = 'block';
            btn.addEventListener('click', function(e) {
              e.preventDefault();
              var url = apiBase + '/admin';
              if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.openLink) window.Telegram.WebApp.openLink(url);
              else window.open(url, '_blank');
            });
          })
          .catch(function() {});
      })();
        } catch (e) {
          console.warn('App init error:', e);
        }
      }, 50);
    });
  </script>
</body>
</html>
