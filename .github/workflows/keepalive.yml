# Пинг сервиса на Render каждые 5 минут, чтобы free tier не засыпал.
# Иначе с телефона кнопка «Отправить заявку» часто не срабатывает (сервер спит, холодный старт 30–60 сек).
# В репо: Settings → Actions → Allow all workflows.
# Бесплатно: GitHub Actions + Render free tier.
name: Keepalive Render
on:
  schedule:
    - cron: '*/5 * * * *'   # каждые 5 минут
  workflow_dispatch:        # можно запустить вручную
jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render service
        run: |
          url="${RENDER_APP_URL:-https://telegram-miniapp-ar09.onrender.com}"
          echo "Pinging $url/healthz ..."
          curl -sf --max-time 120 "$url/healthz" -o /dev/null && echo "OK" || echo "Failed (server may be waking up)"
        env:
          # Переопредели в Settings → Secrets and variables → Actions → Variables при другом URL
          RENDER_APP_URL: ${{ vars.RENDER_APP_URL }}
