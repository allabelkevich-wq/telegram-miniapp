<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
  <meta name="theme-color" content="#08071a">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>YupSoul</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <!-- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö URL (v=22) –Ω–∞ —Å–≤–µ–∂–∏–π timestamp -->
  <script>
    (function(){
      try {
        var APP_VERSION = '1.2.19';
        var CACHE_KEY = 'yupsoul_app_version';
        var cached = localStorage.getItem(CACHE_KEY);
        
        // –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è –∏–∑–º–µ–Ω–∏–ª–∞—Å—å ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –±–µ–∑ –∫—ç—à–∞
        if (cached && cached !== APP_VERSION) {
          localStorage.setItem(CACHE_KEY, APP_VERSION);
          window.location.reload(true);
          return;
        }
        localStorage.setItem(CACHE_KEY, APP_VERSION);
        
        var qs = window.location.search;
        var m = qs.match(/[?&]v=(\d+)/);
        if (m && m[1] && m[1].length <= 6) {
          // –°—Ç–∞—Ä—ã–π –∫–æ—Ä–æ—Ç–∫–∏–π v= (–Ω–∞–ø—Ä. v=22) ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Å timestamp —á—Ç–æ–±—ã —Å–±–∏—Ç—å –∫–µ—à
          var fresh = window.location.href.replace(/([?&])v=\d+/, '$1v=' + Date.now());
          window.location.replace(fresh);
        }
      } catch(e) {}
    })();
  </script>
  <!-- API: –Ω–∞ Render –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ origin, –∏–Ω–∞—á–µ —Ö–∞—Ä–¥–∫–æ–¥. -->
  <script>
    (function(){
      var origin = (typeof window !== 'undefined' && window.location && window.location.origin) ? window.location.origin : '';
      var isRender = /\.onrender\.com$/i.test(origin);
      window.HEROES_API_BASE = isRender ? origin : 'https://telegram-miniapp-ar09.onrender.com';
      window.BACKEND_URL = window.HEROES_API_BASE;
    })();
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
    /* –ê–î–ê–ü–¢–ò–í–ù–´–ï –°–¢–ò–õ–ò –° –ü–û–î–î–ï–†–ñ–ö–û–ô –¢–ï–ú–´ –¢–ï–õ–ï–ì–†–ê–ú */
    :root {
      --primary-color: #d4af37;
      --secondary-color: #ec4899;
      --success-color: #10b981;
      --subtitle-readable: rgba(255,255,255,0.92);
      /* Fluid scaling ‚Äî –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ Apple: —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —ç–∫—Ä–∞–Ω—É */
      --fluid-xs: clamp(0.7rem, 1.8vw, 0.8rem);
      --fluid-sm: clamp(0.8rem, 2.2vw, 0.95rem);
      --fluid-base: clamp(0.9rem, 2.8vw, 1.05rem);
      --fluid-md: clamp(1rem, 3.2vw, 1.2rem);
      --fluid-lg: clamp(1.1rem, 3.8vw, 1.4rem);
      --fluid-xl: clamp(1.2rem, 4.5vw, 1.6rem);
      --fluid-2xl: clamp(1.4rem, 5.5vw, 2.4rem);
      --spacing-xs: clamp(4px, 1.2vw, 8px);
      --spacing-sm: clamp(6px, 1.8vw, 12px);
      --spacing-md: clamp(10px, 2.5vw, 18px);
      --spacing-lg: clamp(14px, 3.5vw, 24px);
      --spacing-xl: clamp(18px, 4.5vw, 28px);
      --radius-sm: clamp(6px, 1.8vw, 10px);
      --radius-md: clamp(8px, 2.2vw, 14px);
      --radius-lg: clamp(12px, 3vw, 20px);
      /* –±–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (dark premium) */
      --tg-theme-bg-color: #0A0A1A;
      --tg-theme-secondary-bg-color: rgba(255,255,255,0.08);
      --tg-theme-text-color: #ffffff;
      --tg-theme-hint-color: rgba(224, 224, 240, 0.7);
      --tg-theme-border-color: rgba(212, 175, 55, 0.3);
      --tg-theme-button-color: #d4af37;
      --tg-theme-button-text-color: #0A0A1A;
    }
    .theme-light {
      --tg-theme-bg-color: #f5f3ff;
      --tg-theme-secondary-bg-color: rgba(255,255,255,0.92);
      --tg-theme-text-color: #1f2937;
      --tg-theme-hint-color: rgba(31, 41, 55, 0.6);
      --tg-theme-border-color: rgba(212,175,55,0.35);
      --tg-theme-button-color: #d4af37;
      --tg-theme-button-text-color: #1f2937;
      --subtitle-readable: rgba(31,41,55,0.88);
    }
    .theme-dark {
      --tg-theme-bg-color: #0A0A1A;
      --tg-theme-secondary-bg-color: rgba(255,255,255,0.08);
      --tg-theme-text-color: #ffffff;
      --tg-theme-hint-color: rgba(224,224,240,0.7);
      --tg-theme-border-color: rgba(212,175,55,0.3);
      --tg-theme-button-color: #d4af37;
      --tg-theme-button-text-color: #0A0A1A;
      --subtitle-readable: rgba(255,255,255,0.92);
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    html { height: 100%; }
    body {
      background: linear-gradient(160deg,#08071a 0%,#100828 40%,#0b1022 70%,#08071a 100%) !important;
      color: var(--tg-theme-text-color) !important;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: var(--fluid-base);
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      -webkit-tap-highlight-color: transparent;
    }
    body::before {
      content:"";
      position:fixed;
      inset:0;
      z-index:0;
      /* –û–¥–∏–Ω –ø–ª–∞–≤–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –±–µ–∑ —Å—Ç–æ–ø–æ–≤ ‚Äî —Ä–µ–∑–∫–∏–µ —Å—Ç–æ–ø—ã –¥–∞–≤–∞–ª–∏ –ø–æ–ª–æ—Å—É —á–µ—Ä–µ–∑ –ª–æ–≥–æ—Ç–∏–ø –≤ –ø—Ä–µ–≤—å—é */
      background: linear-gradient(180deg, rgba(1,6,26,0.5) 0%, rgba(8,10,38,0.65) 100%);
      pointer-events:none;
    }
    body::after {
      content:"";
      position:fixed;
      inset:0;
      z-index:0;
      /* –ü–ª–∞–≤–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –±–µ–∑ —Å—Ç–æ–ø–æ–≤ ‚Äî –∏–Ω–∞—á–µ –≤ –ø—Ä–µ–≤—å—é –≤–∏–¥–Ω–∞ –ø–æ–ª–æ—Å–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–æ—Ç–∏–ø */
      background: linear-gradient(180deg, rgba(1,6,26,0.22) 0%, rgba(8,10,38,0.2) 100%);
      pointer-events:none;
    }
    .content-wrapper { max-width: min(600px,100%); margin: 0 auto; padding: var(--spacing-lg); width: 100%; }
    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; color: var(--tg-theme-text-color, #fff); font-size: 14px; margin-bottom: 8px; font-weight: 500; }
    input::placeholder, textarea::placeholder { color: var(--tg-theme-hint-color, rgba(255,255,255,.45)); opacity: .85; }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%; padding: 12px 16px; background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05));
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1)); border-radius: 8px;
      color: var(--tg-theme-text-color, #fff); font-size: 14px; box-sizing: border-box;
    }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      outline: none; border-color: rgba(212,175,55,0.6); box-shadow: 0 0 0 2px rgba(212,175,55,0.12);
    }
    .checkbox-group { display: flex; align-items: center; margin-top: 8px; }
    .checkbox-group input[type="checkbox"] { width: 18px; height: 18px; margin-right: 8px; cursor: pointer; }
    .checkbox-group label { margin: 0; font-size: 13px; color: var(--tg-theme-text-color, #fff); opacity: 0.9; }
    small { color: var(--tg-theme-hint-color, rgba(255, 255, 255, 0.6)); font-size: 12px; }
    h3 { color: var(--tg-theme-text-color, #fff); font-size: 18px; margin: 0 0 15px 0; font-weight: 600; }
    #payBtn {
      width: 100%; padding: 13px 24px; background: linear-gradient(135deg, #d4af37, #ec4899);
      border: none; border-radius: 14px; color: var(--tg-theme-button-text-color, #fff); font-size: 1rem; font-weight: 600;
      cursor: pointer; transition: all 0.3s; margin-top: 16px; box-shadow: 0 4px 15px rgba(212,175,55,0.3);
    }
    #payBtn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4); }
    #payBtn:active { transform: translateY(0); }
    .form-section {
      background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05)); border-radius: 12px; padding: 20px; margin-bottom: 20px;
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1));
    }
    .request-examples {
      margin: 20px 0; padding: 15px; background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05));
      border-radius: 12px; border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1));
    }
    .request-examples h3 { font-size: 16px; color: var(--tg-theme-text-color, #fff); margin: 0 0 12px 0; font-weight: 500; }
    .examples-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 8px; }
    .example-btn {
      background: linear-gradient(135deg, #d4af37, #e8c547, #d4af37);
      border: 1px solid rgba(212, 175, 55, 0.7); color: #0A0A1A;
      padding: 10px 12px; border-radius: 8px; font-size: 12px; font-weight: 600;
      cursor: pointer; text-align: left; transition: all 0.2s; width: 100%;
      white-space: normal; word-wrap: break-word; word-break: break-word;
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
    }
    .example-btn:hover { opacity: 0.95; transform: translateY(-2px); box-shadow: 0 6px 18px rgba(212, 175, 55, 0.5); background: linear-gradient(135deg, #e0b83a, #f0d050, #e0b83a); }
    .example-btn.special { background: linear-gradient(135deg, #d4af37, #e8c547); border-color: rgba(212, 175, 55, 0.7); }
    .mode-selector {
      margin: 20px 0; padding: 20px 18px; background: rgba(255,255,255,0.04); backdrop-filter: blur(12px);
      border-radius: 18px; border: 1px solid rgba(255,255,255,0.1);
    }
    .mode-selector h3 { font-size: 1rem; color: #fff; margin: 0 0 4px; font-weight: 700; text-align: center; letter-spacing: 0.01em; }
    .mode-subtitle { font-size: 0.78rem; color: rgba(255,255,255,0.4); margin: 0 0 16px; text-align: center; }
    .mode-buttons { display: flex; flex-direction: column; gap: 10px; }
    .mode-btn {
      background: rgba(255,255,255,0.06); border: 1.5px solid rgba(255,255,255,0.1);
      color: #fff; padding: 16px 18px; border-radius: 14px; cursor: pointer;
      transition: background 0.2s, border-color 0.2s, box-shadow 0.2s, transform 0.15s;
      display: flex; flex-direction: column; align-items: flex-start; gap: 4px;
      text-align: left; width: 100%; box-sizing: border-box; animation: none; box-shadow: none; margin: 0;
    }
    .mode-btn:active { transform: scale(0.985); }
    .mode-btn.active {
      background: linear-gradient(135deg, #d4af37 0%, #ec4899 100%);
      border-color: transparent; color: #fff;
      box-shadow: 0 6px 22px rgba(212,175,55,0.3);
    }
    .mode-icon { display: none; }
    .mode-label { font-weight: 700; font-size: 1rem; line-height: 1.2; }
    .mode-desc { display: block; font-size: 0.78rem; font-weight: 400; opacity: 0.65; line-height: 1.4; }
    .mode-btn.active .mode-desc { opacity: 0.85; }
    .mode-info {
      width: 20px; height: 20px; border-radius: 50%; border: 1px solid rgba(212,175,55,0.4);
      color: rgba(212,175,55,0.7); font-size: 0.7rem; font-weight: 700;
      display: inline-flex; align-items: center; justify-content: center;
      flex-shrink: 0; cursor: pointer; line-height: 1; transition: border-color 0.2s, color 0.2s;
      font-style: normal; user-select: none;
    }
    .mode-info:active { color: #d4af37; border-color: #d4af37; }
    /* –¢—É–ª—Ç–∏–ø –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
    #modeTooltip {
      display: none; position: fixed; z-index: 9999;
      background: rgba(25,25,35,0.97); border: 1px solid rgba(212,175,55,0.3);
      color: rgba(255,255,255,0.88); font-size: 0.8rem; line-height: 1.45;
      padding: 9px 13px; border-radius: 10px; max-width: 220px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.4); pointer-events: none;
    }
    .location-input-wrapper { position: relative; }
    .location-input {
      width: 100%; padding: 12px 16px; background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.05));
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1)); border-radius: 8px;
      color: var(--tg-theme-text-color, #fff); font-size: 14px; box-sizing: border-box;
    }
    .location-input:focus {
      outline: none; border-color: rgba(212,175,55,0.6); box-shadow: 0 0 0 2px rgba(212,175,55,0.12);
    }
    .location-suggestions {
      position: absolute; z-index: 1000; background: var(--tg-theme-bg-color, #1a1a1a);
      border: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1)); border-radius: 8px;
      max-height: 200px; overflow-y: auto; width: 100%; margin-top: 4px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      display: none;
    }
    .location-suggestion {
      padding: 10px 12px; cursor: pointer; border-bottom: 1px solid var(--tg-theme-border-color, rgba(255, 255, 255, 0.1));
      color: var(--tg-theme-text-color, #fff); font-size: 14px; transition: background 0.2s;
    }
    .location-suggestion:hover { background: var(--tg-theme-secondary-bg-color, rgba(255, 255, 255, 0.1)); }
    .location-suggestion:last-child { border-bottom: none; }
    .stepper {
      display: flex; gap: 8px; align-items: center; margin-bottom: 16px; position: relative;
    }
    .step-line {
      position: absolute; left: 12px; right: 12px; height: 2px; background: var(--tg-theme-border-color); top: 18px; z-index: 0;
    }
    .step-indicator {
      position: relative; z-index: 1; padding: 8px 12px; border-radius: 10px; border: 1px solid var(--tg-theme-border-color);
      background: var(--tg-theme-secondary-bg-color); color: var(--tg-theme-text-color); font-weight: 600; font-size: 13px;
      flex: 1; text-align: center;
    }
    .step-indicator.active {
      border-color: var(--tg-theme-button-color); background: linear-gradient(135deg, var(--tg-theme-button-color), #ec4899);
      color: var(--tg-theme-button-text-color); box-shadow: 0 6px 18px rgba(212,175,55,0.25);
    }
    .step-panel { margin-top: 20px; }
    .step-nav { display: flex; gap: 12px; margin-top: 16px; }
    .step-nav button { flex: 1; text-transform: none; letter-spacing: 0; }
    .form-submit-sticky { position: sticky; bottom: 0; background: linear-gradient(to top, #08071a 85%, transparent); padding: 16px 0 8px; margin: 0; z-index: 5; display: flex; flex-direction: column; align-items: stretch; gap: 0; }
    .form-submit-sticky button#stepNext { flex: none; width: 100%; }
    .form-nav-links{display:flex;justify-content:center;gap:14px;margin-top:18px;padding:10px 0}
    .form-nav-link{background:none;border:none;color:rgba(212,175,55,0.55);font-size:0.8rem;cursor:pointer;font-family:inherit;padding:0;min-height:unset;box-shadow:none;animation:none;font-weight:500}
    .form-nav-link:hover{color:rgba(212,175,55,0.8)}
    @media (max-width: 600px) {
      .examples-grid { grid-template-columns: 1fr; }
      .content-wrapper { padding: 15px; }
      #payBtn { padding: 14px; font-size: 15px; }
    }
    /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Comfortaa',sans-serif}
    .container{max-width:min(600px,100%);margin:0 auto;width:100%;position:relative;z-index:1;padding:0 var(--spacing-md)}
    .page{position:fixed;inset:0;display:none !important;flex-direction:column;overflow:hidden}
    .page.active{display:flex !important}
    .page-scroll{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:0 var(--spacing-md) calc(env(safe-area-inset-bottom) + 24px)}
    .page-header{flex-shrink:0}
    .page-footer{flex-shrink:0;padding:var(--spacing-md);padding-bottom:max(var(--spacing-md),env(safe-area-inset-bottom))}
    header{text-align:center;margin:var(--spacing-xl) 0 var(--spacing-lg);position:relative}
    .lang-switcher-compact{position:fixed;top:max(8px,env(safe-area-inset-top));right:max(10px,env(safe-area-inset-right));z-index:100}
    .lang-switcher-btn{display:inline-flex !important;align-items:center;justify-content:center;gap:2px;width:32px !important;height:32px !important;padding:0 !important;min-width:0 !important;min-height:unset !important;font-size:9px;line-height:1;background:rgba(0,0,0,0.28) !important;border:1px solid rgba(255,255,255,0.1) !important;border-radius:50% !important;color:rgba(255,255,255,0.6);cursor:pointer;font-family:inherit;font-weight:500;letter-spacing:0;transition:background .2s, border-color .2s, color .2s;box-shadow:none !important;animation:none !important;transform:none !important}
    .lang-switcher-btn:hover{background:rgba(0,0,0,0.4);border-color:rgba(255,255,255,0.15);color:rgba(255,255,255,0.85)}
    #langSwitcherIcon{font-size:10px;opacity:0.6;line-height:1}
    #langSwitcherCurrent{text-align:center;font-size:9px;font-weight:600}
    .lang-dropdown{position:absolute;top:calc(100% + 4px);right:0;left:auto;margin-top:0;width:40px;padding:2px;background:rgba(18,15,40,0.97);border:1px solid rgba(212,175,55,0.18);border-radius:8px;box-shadow:0 4px 14px rgba(0,0,0,0.55);overflow:hidden;z-index:9999}
    .lang-dropdown[hidden]{display:none !important}
    .lang-opt{display:block;width:100%;padding:5px 0;text-align:center;background:transparent;border:none;border-radius:4px;color:rgba(255,255,255,0.55);font-size:9px;font-weight:600;letter-spacing:0.04em;cursor:pointer;font-family:inherit;transition:color .15s,background .15s;min-height:unset;animation:none;box-shadow:none;margin:0}
    .lang-opt:hover,.lang-opt:active{background:rgba(212,175,55,0.12);color:#d4af37}
    h1{font-size:var(--fluid-2xl);background:linear-gradient(135deg,#d4af37,#ec4899,#d4af37);background-size:300% 300%;animation:gradientShift 4s ease infinite;-webkit-background-clip:text;background-clip:text;color:transparent;font-weight:700;letter-spacing:-1px;line-height:1.2;padding-bottom:4px}
    .subtitle{color:var(--subtitle-readable,var(--tg-theme-text-color));font-size:var(--fluid-base);margin-top:8px;font-weight:400}
    .tagline{color:#d4af37;font-size:var(--fluid-sm);font-weight:400;margin:6px 0 0;letter-spacing:0.1px;opacity:0.75}
    .section{background:var(--tg-theme-secondary-bg-color);border-radius:var(--radius-lg);padding:var(--spacing-lg) var(--spacing-lg);box-shadow:0 4px 18px rgba(212,175,55,0.08);border:1px solid rgba(255,255,255,0.06);position:relative;overflow:hidden;margin-bottom:var(--spacing-lg)}
    #paymentPage .section{background:rgba(20,18,45,0.98);min-height:300px;color:#fff}
    body.theme-light #paymentPage .section{background:rgba(250,248,255,0.98);color:#1f2937}
    .section::before{display:none}
    .field{margin-bottom:var(--spacing-md);text-align:left}
    .field label{font-size:0.85rem;font-weight:500;color:rgba(255,255,255,0.85);margin-bottom:6px;display:flex;align-items:center;gap:8px}
    .field input:not([type="checkbox"]):not([type="radio"]),.field select,.field textarea{font-size:0.92rem;padding:10px 14px}
    label{display:block;margin-bottom:10px;color:var(--tg-theme-text-color,#2d2d2d);font-weight:500;font-size:1.05rem;display:flex;align-items:center;gap:10px}
    label::before{content:attr(data-icon);font-size:1.25rem}
    input,textarea,select{width:100%;padding:var(--spacing-md);border-radius:var(--radius-md);border:1px solid var(--tg-theme-border-color,#e5e7eb);background:var(--tg-theme-secondary-bg-color,#fff);color:var(--tg-theme-text-color,#2d2d2d);font-size:var(--fluid-base);transition:all .3s ease;font-family:'Comfortaa',sans-serif}
    input:focus,textarea:focus,select:focus{outline:none;border-color:rgba(212,175,55,0.6);box-shadow:0 0 0 3px rgba(212,175,55,.12)}
    input.valid,textarea.valid{border-color:#4ade80}
    /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è date/time inputs –Ω–∞ Android */
    input[type="date"],input[type="time"]{
      font-size:1.2rem;
      min-height:56px;
      font-weight:500;
      letter-spacing:0.3px;
      padding:15px 18px;
      font-weight:600;
      letter-spacing:0.4px;
      -webkit-appearance:none;
      -moz-appearance:none;
      appearance:none;
      background:rgba(255,255,255,0.12);
      border:2px solid rgba(212,175,55,0.4);
      color:#fff;
      border-radius:12px;
      transition:all 0.2s ease;
    }
    input[type="date"]:focus,input[type="time"]:focus{
      border-color:rgba(212,175,55,0.8);
      background:rgba(255,255,255,0.16);
      outline:none;
      box-shadow:0 0 0 3px rgba(212,175,55,0.15);
    }
    input[type="date"]::-webkit-calendar-picker-indicator,
    input[type="time"]::-webkit-calendar-picker-indicator{
      width:32px;
      height:32px;
      min-width:32px;
      min-height:32px;
      opacity:0.85;
      cursor:pointer;
      filter:invert(1) brightness(1.2);
      padding:4px;
      border-radius:6px;
      transition:all 0.2s ease;
    }
    input[type="date"]::-webkit-calendar-picker-indicator:hover,
    input[type="time"]::-webkit-calendar-picker-indicator:hover{
      opacity:1;
      background:rgba(212,175,55,0.2);
    }
    /* Placeholder –¥–ª—è –ø—É—Å—Ç—ã—Ö date/time inputs */
    input[type="date"]:not(:focus):invalid,
    input[type="time"]:not(:focus):invalid{
      color:rgba(255,255,255,0.5);
      font-weight:500;
    }
    /* –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å –¥–ª—è Android Xiaomi –∏ –¥—Ä—É–≥–∏—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
    @media (max-width: 600px) {
      input[type="date"],input[type="time"]{
        font-size:1.3rem;
        min-height:60px;
        padding:17px 22px;
        border-width:2.5px;
        font-weight:700;
        letter-spacing:0.5px;
        text-shadow:0 1px 2px rgba(0,0,0,0.3);
      }
      input[type="date"]::-webkit-calendar-picker-indicator,
      input[type="time"]::-webkit-calendar-picker-indicator{
        width:38px;
        height:38px;
        min-width:38px;
        min-height:38px;
        filter:invert(1) brightness(1.5) contrast(1.2);
      }
      input[type="date"]::-webkit-datetime-edit-fields-wrapper,
      input[type="time"]::-webkit-datetime-edit-fields-wrapper{
        padding:2px 0;
      }
      input[type="date"]::-webkit-datetime-edit-text,
      input[type="time"]::-webkit-datetime-edit-text{
        padding:0 4px;
        font-weight:500;
      }
      input[type="date"]::-webkit-datetime-edit-day-field,
      input[type="date"]::-webkit-datetime-edit-month-field,
      input[type="date"]::-webkit-datetime-edit-year-field,
      input[type="time"]::-webkit-datetime-edit-hour-field,
      input[type="time"]::-webkit-datetime-edit-minute-field{
        padding:2px 4px;
        border-radius:0;
        background:transparent;
        font-weight:500;
      }
    }
    .birthdate-wrap{position:relative}
    .birthdate-wrap.has-date{padding-right:2.75rem}
    #birthdate{padding-right:2.5rem;min-width:0}
    .birthdate-check{position:absolute;right:16px;top:50%;transform:translateY(-50%);pointer-events:none;color:#4ade80;font-size:1.15rem;display:none;font-weight:700}
    .birthdate-wrap.has-date .birthdate-check{display:block}
    /* –£–¥–æ–±–Ω—ã–π –≤–≤–æ–¥ –¥–∞—Ç—ã —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞: —Ç—Ä–∏ –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–∞ */
    .date-group{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .date-group select{flex:1 1 auto;min-width:80px;max-width:120px}
    .date-group .date-group-day{min-width:70px}
    .date-group .date-group-month{min-width:110px}
    .date-group .date-group-year{min-width:90px}
    .birthdate-wrap .date-group + input[type="date"]{position:absolute;width:1px;height:1px;clip:rect(0,0,0,0);opacity:0;pointer-events:none;overflow:hidden}
    @media (max-width:480px){
      .date-group{flex-direction:column;align-items:stretch;gap:12px}
      .date-group select{width:100%;max-width:none;min-width:0;min-height:48px;font-size:1rem;-webkit-tap-highlight-color:rgba(212,175,55,0.15)}
    }
    .time-group{display:flex;flex-direction:row;align-items:center;gap:var(--spacing-sm);flex-wrap:wrap;margin:0}
    .time-group-input{flex:0 0 auto;min-width:0;width:140px;max-width:160px}
    .time-group-checkbox{margin:0;flex:1 1 auto;align-self:center}
    @media (max-width: 420px){
      .time-group{flex-direction:column;align-items:stretch}
      .time-group-input{width:100%;max-width:none}
      .time-group-checkbox{justify-content:flex-start}
    }
    .checkbox{display:flex;align-items:center;gap:10px;margin-top:0}
    .checkbox input{width:22px;height:22px;min-width:22px;accent-color:#d4af37;opacity:.65}
    .time-group .checkbox input{opacity:.45}
    .checkbox label{margin-bottom:0;font-weight:500;color:var(--tg-theme-text-color,#fff);font-size:1rem;display:flex;align-items:center;gap:6px;opacity:.88}
    select{appearance:none;background:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23d4af37' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") no-repeat right 16px center;background-size:20px;padding-right:48px}
    textarea{min-height:140px;line-height:1.6;resize:vertical}
    .request-label{font-size:var(--fluid-md);text-align:center;margin-bottom:var(--spacing-sm);color:#d4af37;font-weight:700;letter-spacing:-0.5px}
    .request-help-row{display:flex;align-items:center;justify-content:space-between;gap:var(--spacing-sm);margin-bottom:var(--spacing-sm)}
    .request-help-row .request-label{margin-bottom:0;text-align:left;font-size:var(--fluid-base);letter-spacing:-0.2px;line-height:1.2;flex:1;min-width:0}
    /* Apple-style quick picker */
    /* Referral card */
    .referral-card{background:linear-gradient(135deg,rgba(212,175,55,0.1),rgba(212,175,55,0.05));border:1px solid rgba(212,175,55,0.3);border-radius:16px;padding:18px;margin:0 0 16px}
    .referral-link-row{display:flex;gap:8px;align-items:center;margin:12px 0;min-width:0;flex-wrap:wrap}
    .referral-link-input{flex:1;min-width:120px;background:rgba(255,255,255,0.07);border:1px solid rgba(255,255,255,0.12);border-radius:10px;color:#fff;font-size:0.78rem;padding:10px 12px;font-family:monospace;outline:none;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
    .referral-share-btn{padding:10px 14px !important;border-radius:10px !important;background:rgba(212,175,55,0.12) !important;border:1px solid rgba(212,175,55,0.45) !important;color:#d4af37 !important;font-weight:700 !important;font-size:0.8rem !important;cursor:pointer;font-family:inherit;white-space:nowrap;flex-shrink:0;box-shadow:none !important;animation:none !important;transition:background .2s;letter-spacing:0 !important}
    .referral-share-btn:active{background:rgba(212,175,55,0.22) !important}
    .referral-stats{display:flex;gap:10px;margin-top:12px}
    .referral-stat-box{flex:1;background:rgba(255,255,255,0.05);border-radius:10px;padding:10px;text-align:center}
    .referral-stat-num{font-size:1.4rem;font-weight:700;color:#d4af37}
    .referral-stat-label{font-size:0.7rem;color:rgba(255,255,255,0.5);margin-top:2px}
    .quick-picker{position:relative;margin-bottom:12px}
    .quick-picker-btn{width:100%;padding:12px 16px;border-radius:12px;background:rgba(212,175,55,0.1);border:1px solid rgba(212,175,55,0.35);color:#d4af37;font-size:0.95rem;font-weight:600;cursor:pointer;font-family:inherit;display:flex;align-items:center;justify-content:space-between;transition:background .2s}
    .quick-picker-btn:hover{background:rgba(212,175,55,0.16)}
    .quick-picker-btn .qa{transition:transform .25s ease;font-size:0.75rem;opacity:0.7}
    .quick-picker-btn.open .qa{transform:rotate(180deg)}
    .quick-picker-sheet{position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:200;background:#1a1730;border:1px solid rgba(212,175,55,0.25);border-radius:16px;box-shadow:0 8px 40px rgba(0,0,0,.8);overflow:hidden;animation:sheetIn .2s ease}
    @keyframes sheetIn{from{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:translateY(0)}}
    .quick-picker-scroll{max-height:260px;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:6px 0}
    .quick-picker-scroll::-webkit-scrollbar{width:3px}
    .quick-picker-scroll::-webkit-scrollbar-track{background:transparent}
    .quick-picker-scroll::-webkit-scrollbar-thumb{background:rgba(212,175,55,0.3);border-radius:2px}
    .quick-cat{display:none}
    .quick-item{display:block;width:100%;padding:11px 16px;background:none;border:none;color:rgba(255,255,255,0.85);font-size:0.9rem;font-weight:500;cursor:pointer;font-family:inherit;text-align:left;transition:background .15s;border-bottom:1px solid rgba(255,255,255,0.04)}
    .quick-item:last-child{border-bottom:none}
    .quick-item:hover,.quick-item:active{background:rgba(212,175,55,0.1);color:#d4af37}
    /* –°—Ç–∞—Ä—ã–µ —Å—Ç–∏–ª–∏ (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏) */
    .quick-dropdown{position:relative;flex:1 1 auto;min-width:0;margin-bottom:var(--spacing-sm);min-width:120px}
    @media (max-width: 380px){
      .request-help-row{flex-wrap:wrap}
      .request-help-row .request-label{flex:1 1 100%;margin-bottom:var(--spacing-xs)}
      .quick-dropdown{flex:1 1 100%}
    }
    .request-help-toggle{width:100%;min-height:auto;margin:0;padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--radius-md);background:linear-gradient(135deg,rgba(212,175,55,0.2),rgba(212,175,55,0.12));color:#d4af37;border:1px solid rgba(212,175,55,0.5);box-shadow:none;text-transform:none;letter-spacing:0;font-size:var(--fluid-sm);font-weight:600;flex:0 0 auto;white-space:nowrap;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:all .2s}
    .request-help-toggle::after{content:'';width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:6px solid currentColor;margin-left:6px;opacity:.8;transition:transform .2s}
    .request-help-toggle.open::after{transform:rotate(180deg)}
    .request-help-toggle:hover{background:rgba(212,175,55,.25)}
    .request-examples{display:none;position:absolute;top:100%;left:0;right:0;margin-top:4px;padding:var(--spacing-md);background:rgba(255,255,255,0.08);backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,0.18);border-radius:var(--radius-md);box-shadow:0 8px 24px rgba(0,0,0,.5);max-height:min(45vh,220px);overflow-y:auto;z-index:100;-webkit-overflow-scrolling:touch}
    .request-examples.open{display:block}
    body.theme-light .request-examples{background:rgba(255,255,255,0.95);border-color:rgba(212,175,55,0.4);box-shadow:0 8px 24px rgba(0,0,0,0.12)}
    .quick-list{display:flex;flex-direction:column;gap:0;width:100%}
    .quick-list .example-btn{width:100% !important;padding:14px 18px !important;font-size:1.05rem !important;line-height:1.4 !important;min-height:auto !important;border-radius:0 !important;white-space:normal !important;overflow:visible !important;text-overflow:clip !important;box-sizing:border-box;background:transparent !important;border:none !important;border-bottom:1px solid rgba(255,255,255,0.1) !important;color:var(--tg-theme-text-color,#fff) !important;box-shadow:none !important;font-weight:500 !important;text-align:left !important;transition:all .2s !important}
    .quick-list .example-btn:last-child{border-bottom:none !important}
    .quick-list .example-btn:hover{background:rgba(212,175,55,.2) !important;color:#fbbf24 !important;transform:none !important}
    body.theme-light .quick-list .example-btn{color:#1f2937 !important;border-bottom-color:rgba(31,41,55,0.1) !important}
    body.theme-light .quick-list .example-btn:hover{background:rgba(212,175,55,.15) !important;color:#d4af37 !important}
    .example-btn{width:auto;min-width:0;max-width:none;flex-shrink:0;white-space:normal;text-transform:none;letter-spacing:0;font-size:.95rem;font-weight:600;padding:12px 16px;margin:0;min-height:auto;border-radius:12px;box-shadow:none;word-wrap:break-word;word-break:break-word;overflow:visible}
    .example-btn::after{display:none}
    .example-btn:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(212,175,55,0.45)}
    button{background:linear-gradient(135deg, #d4af37, #ec4899, #d4af37);background-size:300% 300%;animation:gradientShift 4s ease infinite;color:var(--tg-theme-button-text-color);border:none;padding:13px 24px;font-size:1rem;border-radius:14px;width:100%;font-weight:600;cursor:pointer;transition:all .25s ease;box-shadow:0 8px 22px rgba(212,175,55,0.4);margin-top:8px;letter-spacing:0;text-transform:none;min-height:48px;position:relative;overflow:hidden}
    button::after{display:none}
    button:hover{transform:translateY(-1px);box-shadow:0 10px 28px rgba(212,175,55,0.5)}
    button:active{transform:translateY(1px);box-shadow:0 4px 12px rgba(212,175,55,0.3)}
    button:disabled{background:rgba(255,255,255,0.15);cursor:not-allowed;transform:none;box-shadow:none;opacity:.6;animation:none}
    button.secondary{background:rgba(255,255,255,0.07);color:rgba(255,255,255,0.75);border:1px solid rgba(255,255,255,0.12);box-shadow:none;text-transform:none;letter-spacing:0;font-weight:500;min-height:42px;animation:none;font-size:0.92rem}
    button.secondary:hover{background:rgba(255,255,255,0.12);color:rgba(255,255,255,0.9)}
    .btn-group{display:flex;gap:15px;margin-top:25px}
    .btn-group button{flex:1}
    .price-tag{background:linear-gradient(90deg,#d4af37,#ec4899);color:white;padding:10px 18px;border-radius:12px;font-size:1.3rem;font-weight:700;text-align:center;margin:16px 0;box-shadow:0 4px 15px rgba(212,175,55,.3);letter-spacing:0.5px}
    .payment-info{background:rgba(212,175,55,.05);border-left:3px solid rgba(212,175,55,0.5);padding:14px;border-radius:0 12px 12px 0;margin:12px 0;font-size:.92rem;line-height:1.6}
    .payment-info::before{content:"üíé ";font-size:1.3rem}
    .success-icon{font-size:5rem;text-align:center;margin:20px 0;background:linear-gradient(90deg,#d4af37,#ec4899);-webkit-background-clip:text;background-clip:text;color:transparent}
    .keys-composition{display:flex;align-items:center;justify-content:center;gap:20px;margin:25px 0;flex-wrap:wrap}
    .keys-composition svg{filter:drop-shadow(0 4px 12px rgba(212,175,55,.2));transition:transform .3s ease}
    .keys-composition .key-music{transform:rotate(-10deg);width:56px;height:80px}
    .keys-composition .key-door{transform:rotate(8deg);width:52px;height:80px}
    .keys-composition .key-music:hover,.keys-composition .key-door:hover{transform:rotate(0) scale(1.05)}
    .keys-composition-small{display:flex;align-items:center;justify-content:center;gap:12px;margin:15px 0}
    .keys-composition-small .key-music{width:36px;height:50px;transform:rotate(-8deg);opacity:.9}
    .keys-composition-small .key-door{width:34px;height:50px;transform:rotate(6deg);opacity:.9}
    .app-logo{display:block;margin:0 auto;max-width:140px;width:100%;height:auto;border-radius:0;box-shadow:none;opacity:0.94}
    /* –ì–ª–∞–≤–Ω–∞—è ‚Äî –º–∏–Ω–∏–º–∞–ª–∏–∑–º: –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ —Ü–µ–Ω—Ç—Ä—É, –∑–∞–±–æ—Ç–∞ –æ –≤–∑–≥–ª—è–¥–µ */
    #homeHero{position:relative;text-align:center;background:linear-gradient(180deg,rgba(1,6,26,0.4) 0%,transparent 100%);flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--spacing-lg) var(--spacing-lg) var(--spacing-xl);gap:0;box-sizing:border-box;min-height:0}
    #homeHero .home-tagline{font-size:0.72rem;font-weight:400;letter-spacing:0.14em;color:rgba(212,175,55,0.45);margin-top:var(--spacing-md);text-transform:uppercase}
    #homeHero .home-greeting{font-size:0.95rem;color:rgba(255,255,255,0.6);line-height:1.6;max-width:240px;margin:var(--spacing-lg) auto var(--spacing-xl);letter-spacing:0.01em}
    #homeHero #startBtn{margin-top:0;width:auto;max-width:280px;padding:14px 36px;font-weight:600;letter-spacing:0.02em;border-radius:50px;align-self:center}
    #homeTopBar .lang-switcher-compact{position:static}
    .lang-switcher-compact{position:static}
    .app-logo.success{max-width:180px;margin-bottom:15px}
    /* ‚îÄ‚îÄ –°–¢–û–†–ò–°-–û–ù–ë–û–†–î–ò–ù–ì ‚îÄ‚îÄ */
    #onboardingPage{
      position:fixed;inset:0;z-index:10001;
      background:#0A0A1A url('assets/bg-yupsoul.png') center/cover no-repeat;
      overflow:hidden;user-select:none;
      display:flex;flex-direction:column;
      padding-top:max(28px,calc(env(safe-area-inset-top)+14px));
      padding-bottom:max(24px,calc(env(safe-area-inset-bottom)+12px));
    }
    #onboardingPage::before{content:"";position:fixed;inset:0;background:linear-gradient(180deg,rgba(4,4,20,.5) 0%,rgba(8,10,35,.75) 100%);z-index:0;pointer-events:none}
    /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã */
    .stories-bars{position:relative;display:flex;gap:5px;z-index:10;padding:0 44px 0 16px;flex-shrink:0;margin-bottom:0}
    .story-bar{flex:1;height:3px;border-radius:2px;background:rgba(255,255,255,0.25);overflow:hidden}
    .story-bar-fill{height:100%;width:0;background:rgba(255,255,255,0.9);border-radius:2px}
    .story-bar-fill.done{width:100%;transition:none}
    .story-bar-fill.playing{width:100%;transition:width var(--story-dur,4s) linear}
    /* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç—å */
    .stories-close{position:absolute;top:max(24px,calc(env(safe-area-inset-top)+10px));right:14px;z-index:11;background:rgba(15,12,40,0.72);border:1px solid rgba(255,255,255,0.15);color:rgba(255,255,255,0.8);font-size:0.9rem;width:30px;height:30px;min-width:30px;min-height:30px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s;padding:0;line-height:1;isolation:isolate;flex-shrink:0}
    .stories-close:hover{background:rgba(15,12,40,0.9)}
    /* –ó–æ–Ω—ã —Ç–∞–ø–∞ */
    .stories-tap-prev,.stories-tap-next{position:absolute;top:0;bottom:0;width:40%;z-index:5;cursor:pointer}
    .stories-tap-prev{left:0}
    .stories-tap-next{right:0}
    /* –ë—Ä–µ–Ω–¥-–±–ª–æ–∫ –ø—Ä–µ–≤—å—é ‚Äî –≤–æ–∑–¥—É—Ö, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è */
    .ob-brand{position:relative;z-index:6;text-align:center;padding:clamp(56px,11vh,96px) 28px 0;pointer-events:none;flex-shrink:0}
    .ob-brand-logo{width:72px;height:72px;margin:0 auto 10px;display:block;opacity:0.95;filter:drop-shadow(0 3px 12px rgba(212,175,55,0.2))}
    .ob-brand-divider{width:28px;height:1px;background:linear-gradient(90deg,transparent,rgba(212,175,55,0.35),transparent);margin:10px auto}
    .ob-brand-tag{font-size:0.72rem;color:rgba(212,175,55,0.45);line-height:1.6;max-width:220px;margin:0 auto;letter-spacing:0.03em}
    /* –°–ª–∞–π–¥—ã ‚Äî flex-grow, –∫–æ–Ω—Ç–µ–Ω—Ç —É –≤–µ—Ä—Ö–Ω–µ–≥–æ –∫—Ä–∞—è —Å–≤–æ–µ–π –∑–æ–Ω—ã */
    .onboarding-slide{position:relative;z-index:1;display:none;flex-direction:column;align-items:center;justify-content:flex-start;flex:1;padding:clamp(24px,7vh,60px) 36px clamp(16px,4vh,32px);text-align:center}
    .onboarding-slide.active{display:flex}
    /* –ê–∫—Ü–µ–Ω—Ç–Ω—ã–π –¥–µ–∫–æ—Ä –≤–º–µ—Å—Ç–æ –∏–∫–æ–Ω–∫–∏ */
    .ob-slide-accent{width:32px;height:2px;background:linear-gradient(90deg,transparent,rgba(212,175,55,0.7),transparent);border-radius:2px;margin:0 auto 28px;animation:accentFade .5s ease-out}
    .ob-icon-wrap{width:80px;height:80px;margin:0 auto 24px;flex-shrink:0;filter:drop-shadow(0 4px 18px rgba(212,175,55,0.35));}
    .ob-icon-wrap img{width:100%;height:100%;object-fit:contain;display:block;}
    .ob-icon-sm{width:36px;height:36px;flex-shrink:0;filter:drop-shadow(0 2px 8px rgba(212,175,55,0.3));}
    .ob-icon-sm img{width:100%;height:100%;object-fit:contain;display:block;}
    @keyframes accentFade{from{opacity:0;transform:scaleX(0.4)}to{opacity:1;transform:scaleX(1)}}
    .onboarding-title{font-size:1.25rem !important;font-weight:600 !important;color:rgba(255,248,225,0.96);margin:0 0 16px 0;line-height:1.35;max-width:260px;letter-spacing:-0.01em}
    .onboarding-text{font-size:0.85rem !important;line-height:1.7 !important;color:rgba(255,255,255,0.5);margin:0 0 28px 0;max-width:240px}
    .onboarding-btn{padding:14px 32px;border-radius:var(--radius-lg);background:linear-gradient(135deg,#d4af37,#c9922e);border:none;color:#0a0810;font-size:0.9rem !important;font-weight:700;cursor:pointer;font-family:inherit;box-shadow:0 4px 20px rgba(212,175,55,0.3);transition:transform .2s,box-shadow .2s;min-width:180px;width:auto;margin-top:0;min-height:unset;animation:none;letter-spacing:0.03em;text-transform:none}
    .onboarding-btn:hover{transform:translateY(-1px);box-shadow:0 6px 24px rgba(212,175,55,0.4)}
    .onboarding-btn:active{transform:translateY(1px)}
    .onboarding-dots{display:none}
    .onboarding-progress{display:none}
    .onboarding-progress-bar{display:none}
    .onboarding-skip{display:none}
    .success-title{font-size:2.2rem;font-weight:700;text-align:center;margin:20px 0;background:linear-gradient(90deg,#d4af37,#ec4899);-webkit-background-clip:text;background-clip:text;color:transparent}
    .success-text{font-size:1.15rem;line-height:1.7;margin:20px 0;text-align:center;padding:0 10px}
    .loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px 40px;text-align:center;min-height:70vh}
    .spinner{width:60px;height:60px;border:4px solid rgba(212,175,55,.15);border-top-color:#d4af37;border-radius:50%;margin:0 auto 25px;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loading-text{font-size:1.5rem;color:#d4af37;font-weight:600;margin-bottom:15px}
    .song-preview{background:white;border-radius:16px;padding:20px;margin:20px 0;text-align:left;border:1px solid rgba(212,175,55,0.4)}
    .song-preview h3{color:#d4af37;font-size:1.4rem;margin-bottom:10px;text-align:center}
    .song-preview p{font-size:1.05rem;line-height:1.7;color:var(--tg-theme-text-color,#2d2d2d)}
    footer{text-align:center;padding:20px 0 max(16px,env(safe-area-inset-bottom));color:rgba(255,255,255,0.22);font-size:0.72rem;margin-top:auto;letter-spacing:0.02em}
    .footer-help{display:inline-flex !important;align-items:center;justify-content:center;color:rgba(212,175,55,0.4) !important;font-size:.78rem !important;cursor:pointer;border:none !important;background:none !important;font-family:inherit;padding:8px 16px !important;margin:0 !important;border-radius:20px !important;box-shadow:none !important;animation:none !important;min-height:unset !important;width:auto !important;font-weight:400 !important;letter-spacing:0.04em !important;transition:color .2s,background .2s}
    .footer-help:hover,.footer-help:active{color:rgba(212,175,55,0.75) !important;background:rgba(212,175,55,0.06) !important}
    /* –ö–∞—Ä—Ç–æ—á–∫–∏ –≥–µ—Ä–æ–µ–≤ */
    .hero-card{background:rgba(255,255,255,0.04);border:1px solid rgba(212,175,55,0.12);border-radius:16px;padding:16px;margin-bottom:12px;transition:border-color .2s}
    .hero-card.expanded{border-color:rgba(212,175,55,0.28)}
    .hero-card-head{display:flex;align-items:center;gap:12px;cursor:pointer}
    .hero-avatar{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,rgba(212,175,55,0.3),rgba(212,175,55,0.08));display:flex;align-items:center;justify-content:center;font-size:1.15rem;font-weight:700;color:#d4af37;flex-shrink:0;border:1px solid rgba(212,175,55,0.22)}
    .hero-card-name{font-size:1rem;font-weight:600;color:#fff;line-height:1.25}
    .hero-card-meta{font-size:0.77rem;color:rgba(255,255,255,0.4);margin-top:3px;line-height:1.4}
    .hero-card-chevron{margin-left:auto;font-size:0.72rem;color:rgba(255,255,255,0.3);transition:transform .25s;flex-shrink:0}
    .hero-card.expanded .hero-card-chevron{transform:rotate(180deg)}
    .hero-card-body{display:none;margin-top:14px;padding-top:14px;border-top:1px solid rgba(255,255,255,0.07)}
    .hero-card.expanded .hero-card-body{display:block}
    .hca-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
    .hca-btn{padding:8px 13px;border-radius:10px;border:1px solid rgba(212,175,55,0.28);background:rgba(212,175,55,0.07);color:#d4af37;font-size:0.82rem;font-weight:600;cursor:pointer;font-family:inherit;white-space:nowrap;min-height:unset;width:auto;box-shadow:none;animation:none;margin:0;transition:background .2s;letter-spacing:0;line-height:1.3}
    .hca-btn:active{background:rgba(212,175,55,0.18)}
    .hca-btn.hca-danger{border-color:rgba(239,68,68,0.28);color:rgba(239,68,68,0.7);background:rgba(239,68,68,0.06)}
    .hca-btn.hca-secondary{border-color:rgba(255,255,255,0.15);color:rgba(255,255,255,0.55);background:rgba(255,255,255,0.04)}
    /* –ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –≥–µ—Ä–æ—è */
    .hero-hist-section{margin-top:14px}
    .hero-hist-loading{font-size:0.82rem;color:rgba(255,255,255,0.35);text-align:center;padding:12px 0}
    .hero-hist-empty{font-size:0.82rem;color:rgba(255,255,255,0.3);text-align:center;padding:12px 0}
    .hero-hist-item{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.07);border-radius:12px;padding:12px 14px;margin-bottom:8px}
    .hero-hist-title{font-size:0.88rem;font-weight:600;color:rgba(255,255,255,0.88);margin-bottom:4px}
    .hero-hist-meta{font-size:0.74rem;color:rgba(255,255,255,0.35);margin-bottom:10px}
    .hero-hist-block-label{font-size:0.74rem;font-weight:600;color:rgba(212,175,55,0.6);text-transform:uppercase;letter-spacing:0.06em;margin-bottom:5px}
    .hero-hist-text{font-size:0.8rem;color:rgba(255,255,255,0.55);line-height:1.55;white-space:pre-wrap;max-height:160px;overflow-y:auto;margin-bottom:10px}
    .hero-hist-audio{display:inline-flex;align-items:center;gap:6px;font-size:0.8rem;color:#d4af37;text-decoration:none;background:rgba(212,175,55,0.08);border:1px solid rgba(212,175,55,0.25);border-radius:8px;padding:6px 12px;margin-top:4px}
    .hero-hist-toggle{font-size:0.78rem;color:rgba(255,255,255,0.35);background:none;border:none;cursor:pointer;font-family:inherit;padding:0;margin-bottom:8px;min-height:unset;width:auto;box-shadow:none;animation:none;letter-spacing:0}
    .hero-style-badge{display:inline-block;font-size:0.72rem;background:rgba(212,175,55,0.1);border:1px solid rgba(212,175,55,0.22);color:rgba(212,175,55,0.75);border-radius:6px;padding:2px 8px;margin-top:5px}
    /* –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–º–æ—â–∏ */
    #helpPage .help-header{padding:max(20px,calc(env(safe-area-inset-top)+12px)) 20px 16px 20px}
    #loadingPage{align-items:center;justify-content:center}
    #successPage,.page#paymentThanksPage{flex-direction:column}
    .ppc-feature{display:flex;align-items:center;gap:4px}
    .ppc-info{width:14px;height:14px;border-radius:50%;border:1px solid rgba(212,175,55,0.35);color:rgba(212,175,55,0.6);font-size:0.6rem;font-weight:700;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;cursor:pointer;line-height:1;font-style:normal;user-select:none;margin-left:2px}
    .ppc-info:active{color:#d4af37;border-color:#d4af37}
    #helpPage .help-back-row{display:flex;align-items:center;margin-bottom:12px}
    #helpPage .help-back-btn{background:none;border:none;color:rgba(255,255,255,0.5);font-size:1.5rem;cursor:pointer;padding:6px 10px;line-height:1;min-height:unset;width:auto;box-shadow:none;animation:none;margin:0;flex-shrink:0}
    #helpPage .help-title-wrap{text-align:center;padding:0 40px}
    #helpPage .help-title{font-size:1.35rem;font-weight:700;color:#d4af37;margin-bottom:4px}
    #helpPage .help-subtitle{font-size:0.85rem;color:rgba(255,255,255,0.45);line-height:1.5}
    .help-section{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:14px;margin:0 0 12px;overflow:hidden}
    .help-section-title{width:100%;background:none;border:none;color:rgba(255,255,255,0.85);font-size:0.95rem;font-weight:600;padding:15px 16px;text-align:left;cursor:pointer;font-family:inherit;display:flex;justify-content:space-between;align-items:center;gap:8px;line-height:1.35}
    .help-section-title .hst-icon{font-size:1.1rem;flex-shrink:0}
    .help-section-title .hst-chevron{font-size:0.7rem;opacity:0.45;transition:transform .25s;flex-shrink:0}
    .help-section.open .hst-chevron{transform:rotate(180deg)}
    .help-section-body{display:none;padding:0 16px 16px;font-size:0.87rem;color:rgba(255,255,255,0.6);line-height:1.65}
    .help-section.open .help-section-body{display:block}
    .help-section-body p{margin:0 0 8px}
    .help-section-body p:last-child{margin:0}
    .help-section-body ul{margin:6px 0 8px;padding-left:18px}
    .help-section-body ul li{margin-bottom:4px}
    .help-section-body strong{color:rgba(255,255,255,0.82)}
    .help-support-btn{width:100%;padding:13px 24px;border-radius:14px;background:linear-gradient(135deg,rgba(212,175,55,0.18),rgba(212,175,55,0.08)) !important;border:1px solid rgba(212,175,55,0.35);color:#d4af37 !important;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;margin-top:16px;transition:background .2s;animation:none !important;box-shadow:none !important;min-height:48px}
    .help-support-btn:hover{background:rgba(212,175,55,0.22) !important}
    .help-support-btn:active{background:rgba(212,175,55,0.28) !important}
    .birthplace-wrap{position:relative}
    .birthplace-suggestions{display:none;position:absolute;left:0;right:0;top:100%;margin-top:4px;background:var(--tg-theme-bg-color,rgba(15,12,40,0.98));border:2px solid rgba(212,175,55,0.5);border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.3);max-height:280px;overflow-y:auto;z-index:50;list-style:none;padding:6px 0}
    .birthplace-suggestions li{padding:14px 18px;cursor:pointer;font-size:1.05rem;color:var(--tg-theme-text-color,#fff);border-bottom:1px solid rgba(255,255,255,0.1);transition:all .2s;font-weight:400}
    .birthplace-suggestions li:last-child{border-bottom:none}
    .birthplace-suggestions li:hover,.birthplace-suggestions li.selected{background:rgba(212,175,55,.2);color:#fbbf24}
    .birthplace-suggestions .place-type{font-size:.9rem;color:rgba(255,255,255,0.6);margin-top:3px;font-weight:400}
    #birthplace,#birthplace2,#heroBirthplace{padding-right:3rem;text-overflow:ellipsis;min-width:0;font-size:1.05rem;font-weight:500}
    .birthplace-check{position:absolute;right:16px;top:50%;transform:translateY(-50%);pointer-events:none;color:#4ade80;font-size:1.15rem;display:none;font-weight:700;flex-shrink:0}
    .birthplace-wrap.has-place .birthplace-check{display:block}
    .birthplace-hint{margin-top:8px;font-size:.95rem;color:rgba(212,175,55,0.9);line-height:1.6;font-weight:500;background:rgba(212,175,55,0.08);padding:10px 14px;border-radius:10px;border:1px solid rgba(212,175,55,0.25)}
    @media (max-width: 600px) {
      .birthplace-suggestions{max-height:240px;border-width:2.5px}
      .birthplace-suggestions li{padding:16px 20px;font-size:1.2rem;font-weight:400;letter-spacing:0}
      .birthplace-suggestions .place-type{font-size:0.95rem;font-weight:400}
      #birthplace,#birthplace2,#heroBirthplace{font-size:1rem;padding:12px 48px 12px 16px;font-weight:500;letter-spacing:0}
      .birthplace-hint{font-size:0.9rem;padding:10px 14px}
      .field input:not([type="checkbox"]):not([type="radio"]){
        font-size:0.95rem;
        padding:12px 14px;
      }
      .field select{
        font-size:0.95rem;
        padding:12px 14px;
      }
    }
    
    #formPage header h1{font-size:clamp(1.1rem,4vw,1.35rem)}
    #formPage header .subtitle{font-size:0.72rem}
    #transitForm{display:none;margin-top:24px;padding:16px;background:var(--tg-theme-secondary-bg-color,rgba(255,255,255,0.05));border-radius:12px;border:1px solid var(--tg-theme-border-color,rgba(255,255,255,0.1))}
    #transitForm h3{color:var(--tg-theme-text-color,#fff);margin:0 0 15px 0;font-size:18px}
    #secondPersonForm{display:none;margin-top:30px;padding:20px;background:var(--tg-theme-secondary-bg-color,rgba(255,255,255,0.05));border-radius:12px;border:1px solid var(--tg-theme-border-color,rgba(255,255,255,0.1))}
    #secondPersonForm h3{color:var(--tg-theme-text-color,#fff);margin:0 0 15px 0;font-size:18px}
    
    /* –ü–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–≤—å—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ */
    .preview-nav{background:white;border-radius:16px;padding:12px;margin-bottom:25px;box-shadow:0 4px 20px rgba(212,175,55,.12);text-align:center;border:1px solid #e5e7eb;display:none}
    .preview-nav.show{display:block}
    .preview-nav-buttons{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:10px}
    .preview-nav button{background:rgba(212,175,55,0.1);color:#d4af37;border:1px solid rgba(212,175,55,0.35);padding:6px 14px;margin:0 4px;border-radius:20px;cursor:pointer;font-weight:600;transition:all .2s;font-size:.9rem;min-width:90px;min-height:auto;animation:none}
    .preview-nav button:hover{background:rgba(212,175,55,0.2);color:#d4af37;transform:translateY(-1px)}
    .preview-nav button.active{background:linear-gradient(90deg,#d4af37,#ec4899);color:white;border-color:transparent;box-shadow:0 4px 15px rgba(212,175,55,.3)}
    
    @media (max-width:480px){.container{padding:0 var(--spacing-sm)}h1{font-size:var(--fluid-2xl)}.subtitle{font-size:var(--fluid-base)}.tagline{font-size:var(--fluid-md)}.section{padding:var(--spacing-lg) var(--spacing-md)}.btn-group{flex-direction:column}.btn-group button{width:100%}button{font-size:1rem;padding:13px 20px;min-height:48px}.price-tag{font-size:1.25rem;padding:10px 15px}.success-icon{font-size:4rem}.success-title{font-size:1.9rem}.success-text{font-size:1.05rem}.preview-nav-buttons{flex-direction:column;align-items:center}.preview-nav button{width:100%;max-width:200px}}

    /* ‚îÄ‚îÄ –ò–ö–û–ù–ö–ê –ü–†–û–§–ò–õ–Ø (–≤ —à–∞–ø–∫–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã) ‚îÄ‚îÄ */
    #profileIconBtn{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,rgba(212,175,55,0.18),rgba(236,72,153,0.14));border:1.5px solid rgba(212,175,55,0.4);cursor:pointer;padding:0;margin:0;min-height:unset;box-shadow:0 2px 12px rgba(0,0,0,0.3);animation:none;display:flex;align-items:center;justify-content:center;font-size:0.85rem;font-weight:700;color:#d4af37;font-family:inherit;letter-spacing:0;line-height:1;transition:background .2s,border-color .2s;flex-shrink:0}
    #profileIconBtn:active{background:rgba(212,175,55,0.28)}

    /* ‚îÄ‚îÄ –ü–†–û–§–ò–õ–¨ ‚Äî –ù–û–í–´–ô –î–ò–ó–ê–ô–ù (Suno-style) ‚îÄ‚îÄ */
    .profile-header{display:flex;align-items:center;gap:12px;padding:max(20px,calc(env(safe-area-inset-top)+12px)) 18px 16px;flex-shrink:0;background:#08071a;z-index:10}
    .profile-back-btn{background:none;border:none;color:rgba(255,255,255,0.5);font-size:1.4rem;cursor:pointer;padding:4px 8px;min-height:unset;width:auto;box-shadow:none;animation:none;margin:0;line-height:1}
    .profile-header-title{font-size:1.05rem;font-weight:600;color:rgba(255,255,255,0.85);letter-spacing:0.02em}
    .profile-scroll{padding:0 18px calc(env(safe-area-inset-bottom)+80px)}
    .profile-identity{text-align:center;margin-bottom:28px;padding-top:8px}
    .profile-avatar-wrap{position:relative;width:72px;height:72px;margin:0 auto 14px;cursor:pointer}
    .profile-avatar{width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,#d4af37,#ec4899);display:flex;align-items:center;justify-content:center;font-size:2rem;color:#fff;font-weight:700;letter-spacing:0;box-shadow:0 0 0 4px rgba(212,175,55,0.12),0 4px 24px rgba(212,175,55,0.18);overflow:hidden;transition:filter .2s}
    .profile-avatar img{width:100%;height:100%;object-fit:cover;border-radius:50%}
    .profile-avatar-wrap:active .profile-avatar{filter:brightness(0.75)}
    .profile-avatar-edit{position:absolute;bottom:0;right:0;width:22px;height:22px;border-radius:50%;background:#1a1628;border:1.5px solid rgba(212,175,55,0.5);display:flex;align-items:center;justify-content:center;font-size:0.65rem;color:rgba(212,175,55,0.85);pointer-events:none}
    .profile-avatar-spinner{position:absolute;inset:0;border-radius:50%;background:rgba(10,8,25,0.6);display:none;align-items:center;justify-content:center;font-size:0.7rem;color:rgba(212,175,55,0.8)}
    .profile-name{font-size:1.3rem;font-weight:700;color:#fff;letter-spacing:0.01em;margin-bottom:8px}
    .profile-plan-badge{display:inline-flex;align-items:center;gap:5px;background:rgba(212,175,55,0.1);border:1px solid rgba(212,175,55,0.28);border-radius:20px;padding:4px 12px;font-size:0.75rem;font-weight:600;color:rgba(212,175,55,0.85);letter-spacing:0.04em;text-transform:uppercase}
    .profile-balance-card{background:linear-gradient(135deg,rgba(212,175,55,0.07),rgba(236,72,153,0.04));border:1px solid rgba(212,175,55,0.2);border-radius:18px;padding:18px 20px;margin-bottom:28px;display:flex;align-items:center;justify-content:space-between;gap:16px}
    .profile-balance-left{}
    .profile-balance-label{font-size:0.78rem;color:rgba(255,255,255,0.5);margin-bottom:4px;letter-spacing:0.02em}
    .profile-balance-value{font-size:2.2rem;font-weight:800;color:#d4af37;line-height:1}
    .profile-balance-hint{font-size:0.72rem;color:rgba(255,255,255,0.35);margin-top:6px;line-height:1.4}
    .profile-balance-icon{font-size:1.8rem;color:rgba(212,175,55,0.3);line-height:1;font-family:Georgia,serif;font-style:italic}
    .profile-section-title{font-size:0.68rem;font-weight:700;letter-spacing:0.14em;color:rgba(255,255,255,0.3);text-transform:uppercase;margin-bottom:14px;display:flex;align-items:center;gap:10px}
    .profile-section-title::after{content:'';flex:1;height:1px;background:rgba(255,255,255,0.06)}
    /* –°–µ—Ç–∫–∞ –ø–ª–∞–Ω–æ–≤ */
    .profile-plans-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
    .profile-plan-card{background:rgba(255,255,255,0.04);border:1.5px solid rgba(255,255,255,0.1);border-radius:16px;padding:16px 14px;position:relative;display:flex;flex-direction:column;gap:4px;transition:border-color .2s,background .2s}
    .profile-plan-card.current{background:rgba(212,175,55,0.07);border-color:rgba(212,175,55,0.38)}
    .ppc-status-img{height:30px;width:auto;margin-top:8px;align-self:flex-start;display:block;}
    .profile-plan-card.popular{background:linear-gradient(135deg,rgba(236,72,153,0.08),rgba(212,175,55,0.06));border-color:rgba(236,72,153,0.35);grid-column:1 / -1}
    .ppc-badge{font-size:0.62rem;font-weight:700;letter-spacing:0.1em;text-transform:uppercase;color:rgba(212,175,55,0.7);margin-bottom:4px}
    .ppc-badge.hot{color:#ec4899}
    .ppc-name{font-size:1rem;font-weight:700;color:#fff;margin-bottom:8px}
    .ppc-features{display:flex;flex-direction:column;gap:4px;margin-bottom:10px;flex:1}
    .ppc-feature{font-size:0.75rem;color:rgba(255,255,255,0.55);line-height:1.4}
    .ppc-price-wrap{display:flex;align-items:baseline;gap:8px;margin-bottom:8px}
    .ppc-price{font-size:0.85rem;font-weight:700;color:rgba(212,175,55,0.85)}
    .ppc-save{font-size:0.68rem;font-weight:600;color:#ec4899;background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.25);border-radius:10px;padding:2px 6px;white-space:nowrap}
    .profile-plan-card.current .ppc-price{color:rgba(255,255,255,0.4);font-size:0.75rem;font-weight:400}
    .profile-plan-card.master{background:linear-gradient(135deg,rgba(212,175,55,0.1),rgba(236,72,153,0.07));border-color:rgba(212,175,55,0.5);grid-column:1 / -1}
    .ppc-badge.master-badge{color:#d4af37}
    .ppc-btn.master-btn{background:linear-gradient(135deg,rgba(212,175,55,0.3),rgba(236,72,153,0.25));border:1px solid rgba(212,175,55,0.5);color:#d4af37}
    .ppc-btn{padding:8px 14px;border-radius:10px;background:rgba(212,175,55,0.15);border:1px solid rgba(212,175,55,0.35);color:#d4af37;font-size:0.78rem;font-weight:600;cursor:pointer;font-family:inherit;min-height:unset;box-shadow:none;animation:none;margin:0;letter-spacing:0.02em;width:100%}
    .ppc-btn:active{background:rgba(212,175,55,0.25)}
    .ppc-btn.popular-btn{background:linear-gradient(135deg,rgba(236,72,153,0.25),rgba(212,175,55,0.18));border-color:rgba(236,72,153,0.45);color:#ec4899}
    /* –†–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–∫–∏ */
    .profile-track-list{display:flex;flex-direction:column;gap:6px;margin-bottom:28px}
    .profile-track-item{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.07);border-radius:13px;padding:13px 14px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:background .15s,border-color .15s}
    .profile-track-item:active{background:rgba(255,255,255,0.06);border-color:rgba(212,175,55,0.25)}
    .pti-name{font-size:0.88rem;font-weight:600;color:rgba(255,255,255,0.75)}
    .pti-desc{font-size:0.72rem;color:rgba(255,255,255,0.3);margin-top:3px}
    .pti-right{display:flex;align-items:center;gap:8px}
    .pti-price{font-size:0.88rem;font-weight:700;color:rgba(212,175,55,0.85)}
    .pti-arrow{font-size:0.8rem;color:rgba(255,255,255,0.2);line-height:1}
    /* –†–µ—Ñ–µ—Ä–∞–ª */
    .profile-referral-section{margin-bottom:28px;background:linear-gradient(135deg,rgba(212,175,55,0.06),rgba(212,175,55,0.02));border:1px solid rgba(212,175,55,0.15);border-radius:18px;padding:18px 16px}
    .profile-referral-section .profile-section-title{margin-bottom:8px}
    .profile-ref-tagline{font-size:0.82rem;color:rgba(255,255,255,0.5);margin-bottom:16px;line-height:1.5}
    .profile-ref-link-row{display:none}
    .profile-ref-share-btn{width:100%;padding:13px 20px;border-radius:13px;background:rgba(212,175,55,0.14);border:1.5px solid rgba(212,175,55,0.38);color:#d4af37;font-weight:700;font-size:0.92rem;cursor:pointer;font-family:inherit;min-height:unset;box-shadow:none;animation:none;margin:0 0 14px;letter-spacing:0.02em;transition:background .2s}
    .profile-ref-share-btn:active{background:rgba(212,175,55,0.25)}
    .profile-ref-stats{display:flex;gap:10px}
    .profile-ref-stats span{flex:1;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:12px;padding:10px 12px;display:flex;flex-direction:column;align-items:center;gap:2px}
    .profile-ref-stats strong{font-size:1.4rem;font-weight:800;color:#d4af37;line-height:1}
    .profile-ref-stats-label{font-size:0.68rem;color:rgba(255,255,255,0.38);margin-top:2px;text-align:center}
    .profile-create-btn{width:100%;padding:15px 24px;border-radius:16px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;margin-bottom:12px;letter-spacing:0.02em;box-shadow:0 4px 20px rgba(212,175,55,0.2);transition:transform .15s,box-shadow .15s}
    .profile-create-btn:active{transform:scale(0.98)}
    /* ‚îÄ‚îÄ –§–û–†–ú–ê: –ê–ö–ö–û–†–î–ï–û–ù –ü–†–û–§–ò–õ–Ø ‚îÄ‚îÄ */
    .pfa-header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:rgba(212,175,55,0.05);border:1px solid rgba(212,175,55,0.2);border-radius:14px;cursor:pointer;font-family:'Comfortaa',sans-serif;transition:background .2s,border-color .2s;user-select:none;-webkit-user-select:none;box-sizing:border-box;}
    .pfa-header:active{background:rgba(212,175,55,0.12);border-color:rgba(212,175,55,0.38);}
    .pfa-info{display:flex;align-items:center;gap:8px;min-width:0;flex:1;overflow:hidden;}
    .pfa-icon{color:rgba(212,175,55,0.7);flex-shrink:0;}
    .pfa-name{font-size:0.95rem;font-weight:700;color:rgba(255,255,255,0.92);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:'Comfortaa',sans-serif;}
    .pfa-sep{color:rgba(212,175,55,0.4);font-size:0.85rem;flex-shrink:0;}
    .pfa-date{font-size:0.85rem;color:rgba(212,175,55,0.82);white-space:nowrap;flex-shrink:0;font-family:'Comfortaa',sans-serif;}
    .pfa-chevron{color:rgba(212,175,55,0.65);flex-shrink:0;margin-left:12px;transition:transform .28s ease;display:flex;align-items:center;}
    .pfa-chevron.open{transform:rotate(180deg);}
    #formFieldsWrap{overflow:hidden;transition:max-height .38s cubic-bezier(.4,0,.2,1),opacity .3s ease;max-height:2400px;}
    #formFieldsWrap.pfw-collapsed{max-height:0!important;opacity:0;pointer-events:none;}
  </style>
</head>
<body>
  <!-- –ü–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–≤—å—é (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ) -->
  <div class="container">
    <div class="preview-nav" id="previewNav">
      <div style="font-weight:600;color:#d4af37;margin-bottom:8px">üé® –†–µ–∂–∏–º –ø—Ä–µ–≤—å—é</div>
      <div class="preview-nav-buttons">
        <button class="active" data-page="home">–ì–ª–∞–≤–Ω–∞—è</button>
        <button data-page="form">–§–æ—Ä–º–∞</button>
        <button data-page="payment">–û–ø–ª–∞—Ç–∞</button>
        <button data-page="loading">–ó–∞–≥—Ä—É–∑–∫–∞</button>
        <button data-page="success">–£—Å–ø–µ—Ö</button>
      </div>
    </div>
  </div>

  <!-- –û–Ω–±–æ—Ä–¥–∏–Ω–≥ ‚Äî —Ñ–æ—Ä–º–∞—Ç —Å—Ç–æ—Ä–∏—Å -->
  <!-- ‚îÄ‚îÄ –ì–µ–π—Ç-—ç–∫—Ä–∞–Ω: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â—ë –Ω–µ –Ω–∞–∂–∞–ª /start –≤ –±–æ—Ç–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="botGatePage" style="display:none;position:fixed;inset:0;z-index:9999;background:linear-gradient(165deg,#0a0818 0%,#130826 50%,#0d1525 100%);flex-direction:column;align-items:center;justify-content:center;padding:32px 28px;text-align:center;font-family:'Comfortaa',sans-serif;">
    <img src="assets/logo-yupsoul.png" alt="YupSoul" style="width:80px;height:80px;object-fit:contain;border-radius:50%;border:2px solid rgba(212,175,55,0.25);margin-bottom:28px;">
    <div style="font-size:1.4rem;font-weight:700;color:#d4af37;margin-bottom:12px;line-height:1.3;">–û–¥–∏–Ω —à–∞–≥ –¥–æ —Ç–≤–æ–µ–π –ø–µ—Å–Ω–∏</div>
    <div style="font-size:0.92rem;color:rgba(255,255,255,0.6);line-height:1.8;max-width:290px;margin-bottom:8px;">–ì–æ—Ç–æ–≤—É—é –ø–µ—Å–Ω—é –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º —Ç–µ–±–µ –ø—Ä—è–º–æ –≤ Telegram.</div>
    <div style="font-size:0.92rem;color:rgba(255,255,255,0.45);line-height:1.8;max-width:290px;margin-bottom:32px;">–ß—Ç–æ–±—ã –±–æ—Ç –º–æ–≥ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ–±–µ ‚Äî –Ω–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª –≤ —á–∞—Ç–µ —Å –±–æ—Ç–æ–º. –û–¥–∏–Ω —Ä–∞–∑, –Ω–∞–≤—Å–µ–≥–¥–∞.</div>
    <button id="gateOpenBotBtn" type="button" style="width:100%;max-width:300px;padding:15px 24px;border-radius:14px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;box-shadow:0 6px 24px rgba(212,175,55,0.3);letter-spacing:0;margin-bottom:16px;">
      –ü–µ—Ä–µ–π—Ç–∏ –≤ –±–æ—Ç–∞ –∏ –Ω–∞–∂–∞—Ç—å –°—Ç–∞—Ä—Ç
    </button>
    <button id="gateCheckBtn" type="button" style="background:none;border:none;color:rgba(212,175,55,0.5);font-size:0.82rem;cursor:pointer;font-family:inherit;padding:8px 0;min-height:unset;box-shadow:none;animation:none;text-decoration:underline;text-underline-offset:3px;">
      –£–∂–µ –Ω–∞–∂–∞–ª –°—Ç–∞—Ä—Ç ‚Üí –≤–æ–π—Ç–∏
    </button>
  </div>
  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->

  <div id="onboardingPage" style="display:none">

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã —Å—Ç–æ—Ä–∏—Å -->
    <div class="stories-bars">
      <div class="story-bar"><div class="story-bar-fill" id="storyBar1"></div></div>
      <div class="story-bar"><div class="story-bar-fill" id="storyBar2"></div></div>
      <div class="story-bar"><div class="story-bar-fill" id="storyBar3"></div></div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç—å -->
    <button class="stories-close" id="onboardingSkip" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>

    <!-- –ë—Ä–µ–Ω–¥-–±–ª–æ–∫: –ª–æ–≥–æ + —Å–ª–æ–≥–∞–Ω -->
    <div class="ob-brand">
      <img src="assets/logo-yupsoul.png" alt="YupSoul" class="ob-brand-logo">
      <div class="ob-brand-divider"></div>
      <div class="ob-brand-tag">–ü–µ—Ä–≤—ã–π –≤ –º–∏—Ä–µ —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –≤ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –º—É–∑—ã–∫—É</div>
    </div>

    <!-- –ó–æ–Ω—ã —Ç–∞–ø–∞: –≤–ª–µ–≤–æ = –Ω–∞–∑–∞–¥, –≤–ø—Ä–∞–≤–æ = –≤–ø–µ—Ä—ë–¥ -->
    <div class="stories-tap-prev" id="storiesTapPrev"></div>
    <div class="stories-tap-next" id="storiesTapNext"></div>

    <!-- –°–ª–∞–π–¥ 1 ‚Äî –û—Ç–∫—Ä—ã—Ç–∏–µ -->
    <div class="onboarding-slide active" data-step="1">
      <div class="ob-icon-wrap"><img src="assets/icons/music.png" alt=""></div>
      <h2 class="onboarding-title" id="obTitle1">–ï—Å—Ç—å –ø–µ—Å–Ω—è ‚Äî –æ —Ç–µ–±–µ</h2>
      <p class="onboarding-text" id="obText1">–ù–∞–ø–∏—Å–∞–Ω–Ω–∞—è –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è. –ù–µ —à–∞–±–ª–æ–Ω ‚Äî –∂–∏–≤–æ–π —Ç–µ–∫—Å—Ç –æ —Ç–≤–æ—ë–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ, —Å–∏–ª–µ –∏ –ø—É—Ç–∏.</p>
    </div>

    <!-- –°–ª–∞–π–¥ 2 ‚Äî –¶–µ–Ω–Ω–æ—Å—Ç—å -->
    <div class="onboarding-slide" data-step="2">
      <div class="ob-icon-wrap"><img src="assets/icons/profile.png" alt=""></div>
      <h2 class="onboarding-title" id="obTitle2">–¢–æ–ª—å–∫–æ –æ —Ç–µ–±–µ</h2>
      <p class="onboarding-text" id="obText2">–ö–∞–∂–¥–∞—è ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–∞. –ï—ë –±–æ–ª—å—à–µ –Ω–µ—Ç –Ω–∏ —É –∫–æ–≥–æ. –ù–∏ –æ–¥–Ω–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è.</p>
    </div>

    <!-- –°–ª–∞–π–¥ 3 ‚Äî –ù–∞—á–∞—Ç—å -->
    <div class="onboarding-slide" data-step="3">
      <div class="ob-icon-wrap"><img src="assets/icons/lightning.png" alt=""></div>
      <h2 class="onboarding-title" id="obTitle3">–ü–µ—Ä–≤–∞—è ‚Äî –≤ –ø–æ–¥–∞—Ä–æ–∫</h2>
      <p class="onboarding-text" id="obText3">–í–≤–µ–¥–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è. –ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º.</p>
      <button class="onboarding-btn" id="onboardingStartBtn" style="display:none"></button>
    </div>

    <!-- –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∞—Ä—ã–º JS -->
    <div class="onboarding-dots" style="display:none">
      <button class="onboarding-dot active" data-step="1"></button>
      <button class="onboarding-dot" data-step="2"></button>
      <button class="onboarding-dot" data-step="3"></button>
    </div>
    <div class="onboarding-progress" style="display:none">
      <div class="onboarding-progress-bar" id="onboardingProgressBar"></div>
    </div>
  </div>

  <!-- –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div class="page" id="homePage">

      <!-- –®–∞–ø–∫–∞: —è–∑—ã–∫ —Å–ª–µ–≤–∞, –ø—Ä–æ—Ñ–∏–ª—å —Å–ø—Ä–∞–≤–∞ -->
      <div id="homeTopBar" style="flex-shrink:0;display:flex;align-items:center;justify-content:space-between;padding:max(10px,env(safe-area-inset-top)) 12px 0;min-height:48px;">
        <div id="langSwitcher" class="lang-switcher-compact" aria-label="–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞" style="position:static;">
          <button type="button" id="langSwitcherBtn" class="lang-switcher-btn" title="–Ø–∑—ã–∫">
            <span id="langSwitcherIcon" aria-hidden="true">üåê</span>
            <span id="langSwitcherCurrent">RU</span>
          </button>
          <div id="langSwitcherDropdown" class="lang-dropdown" hidden>
            <button type="button" class="lang-opt" data-lang="ru">RU</button>
            <button type="button" class="lang-opt" data-lang="en">EN</button>
            <button type="button" class="lang-opt" data-lang="de">DE</button>
            <button type="button" class="lang-opt" data-lang="fr">FR</button>
          </div>
        </div>
        <button id="profileIconBtn" onclick="goToProfileFrom('homePage')" aria-label="–ü—Ä–æ—Ñ–∏–ª—å" title="–ü—Ä–æ—Ñ–∏–ª—å">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="8" r="4" fill="#d4af37" opacity="0.9"/>
            <path d="M4 20c0-4 3.6-7 8-7s8 3 8 7" stroke="#d4af37" stroke-width="2" stroke-linecap="round" opacity="0.9"/>
          </svg>
        </button>
      </div>

      <!-- –õ–æ–≥–æ –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ ‚Äî –ø–æ —Ü–µ–Ω—Ç—Ä—É -->
      <div id="homeHero">
        <img src="assets/logo-yupsoul.png" alt="YupSoul" class="app-logo" width="140" height="140">
        <div class="home-tagline">–ú—É–∑—ã–∫–∞ —Ç–≤–æ–µ–π –¥—É—à–∏</div>
        <p id="homeGreeting" class="home-greeting">–ü—Ä–∏–≤–µ—Ç üëã</p>
        <button id="startBtn">–°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ø–µ—Å–Ω—é</button>
      </div>

      <!-- –ù–∏–∂–Ω—è—è –∑–æ–Ω–∞ ‚Äî —Ç–∏—Ö–æ, –∫–æ–≥–¥–∞ –ø—É—Å—Ç–æ -->
      <div class="home-lower" style="flex-shrink:0;padding:var(--spacing-md) var(--spacing-md) max(var(--spacing-lg),env(safe-area-inset-bottom))">

      <!-- –ë–∞–Ω–Ω–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è ‚Äî –º—è–≥–∫–æ, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è -->
      <div id="recoveryBanner" style="display:none;margin:0 0 var(--spacing-md) 0;background:rgba(5,150,105,0.08);border:1px solid rgba(16,185,129,0.2);border-radius:var(--radius-md);padding:var(--spacing-md) var(--spacing-lg);position:relative;">
        <button id="recoveryDismissBtn" style="position:absolute;top:8px;right:10px;background:none;border:none;color:rgba(255,255,255,0.3);font-size:1rem;line-height:1;cursor:pointer;padding:2px 4px;min-height:unset;width:auto;box-shadow:none;animation:none;margin:0;font-weight:400;" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
        <div id="recoveryBannerText" style="font-size:0.88rem;color:rgba(209,250,229,0.85);line-height:1.5;margin-bottom:10px;padding-right:20px;">
          üéÅ <strong style="color:#6ee7b7;">–¢–≤–æ—è –∑–∞—è–≤–∫–∞ –∂–¥—ë—Ç!</strong> –ü–æ–ª—É—á–∏ –ø–µ—Ä–≤—É—é –ø–µ—Å–Ω—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ.
        </div>
        <button id="recoveryClaimBtn" style="width:100%;padding:12px 24px;border-radius:12px;background:linear-gradient(135deg,#059669,#10b981);border:none;color:#fff;font-size:0.95rem;font-weight:700;cursor:pointer;font-family:inherit;">
          üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
        </button>
      </div>

      <!-- –ê–¥–º–∏–Ω–∫–∞ ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤, –Ω–µ–Ω–∞–≤—è–∑—á–∏–≤–æ -->
      <div id="adminLinkWrap" style="display:none;margin-top:var(--spacing-lg);text-align:center">
        <button type="button" id="adminLinkBtn" onclick="goToPage('adminPage')" style="background:none;border:none;color:rgba(212,175,55,0.35);font-size:0.72rem;cursor:pointer;font-family:inherit;min-height:unset;box-shadow:none;animation:none;padding:6px 12px;margin:0;font-weight:400;letter-spacing:0.03em">üëë –ê–¥–º–∏–Ω–∫–∞</button>
      </div>

      <!-- –ü—Ä–æ—Ñ–∏–ª—å, –ü–æ–º–æ—â—å, –ú–æ–∏ –≥–µ—Ä–æ–∏ ‚Äî –¥–æ—Å—Ç—É–ø —Å –≥–ª–∞–≤–Ω–æ–π -->
      <nav class="home-nav" style="display:flex;justify-content:center;gap:14px;margin-top:var(--spacing-lg);padding:8px 0;">
        <button type="button" class="home-nav-link" onclick="goToProfileFrom('homePage')" style="background:none;border:none;color:rgba(212,175,55,0.5);font-size:0.8rem;cursor:pointer;font-family:inherit;padding:0;min-height:unset;box-shadow:none;">–ü—Ä–æ—Ñ–∏–ª—å</button>
        <button type="button" class="home-nav-link" onclick="goToHelpFrom('homePage')" style="background:none;border:none;color:rgba(212,175,55,0.5);font-size:0.8rem;cursor:pointer;font-family:inherit;padding:0;min-height:unset;box-shadow:none;">–ü–æ–º–æ—â—å</button>
        <button type="button" class="home-nav-link" onclick="goToHeroesFrom('homePage')" style="background:none;border:none;color:rgba(212,175,55,0.5);font-size:0.8rem;cursor:pointer;font-family:inherit;padding:0;min-height:unset;box-shadow:none;">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</button>
      </nav>

      </div><!-- /–Ω–∏–∂–Ω—è—è –æ–±—ë—Ä—Ç–∫–∞ -->

      <footer>
        <p>YupSoul ‚Ä¢ 2026 ‚Ä¢ v1.2.37</p>
      </footer>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–º–æ—â–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ -->
    <div class="page" id="helpPage">
      <div class="help-header page-header">
        <div class="help-back-row">
          <button type="button" class="help-back-btn" onclick="goBack()" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
        </div>
        <div class="help-title-wrap">
          <div class="help-title">–ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
          <div class="help-subtitle">–í—Å—ë –æ YupSoul ‚Äî –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ –¥–µ–ª—É</div>
        </div>
      </div>
      <div class="page-scroll" style="padding-top:12px">

        <!-- –ß—Ç–æ —Ç–∞–∫–æ–µ YupSoul -->
        <div class="help-section open">
          <button type="button" class="help-section-title" onclick="this.closest('.help-section').classList.toggle('open')">
            <span class="hst-icon">üåü</span><span style="flex:1">–ß—Ç–æ —Ç–∞–∫–æ–µ YupSoul</span><span class="hst-chevron">‚ñº</span>
          </button>
          <div class="help-section-body">
            <p>YupSoul —Å–æ–∑–¥–∞—ë—Ç <strong>–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–µ—Å–Ω—é –∏–º–µ–Ω–Ω–æ –¥–ª—è —Ç–µ–±—è</strong> ‚Äî –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç—ã, –≤—Ä–µ–º–µ–Ω–∏ –∏ –º–µ—Å—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å –∏ –ø–∏—à–µ—Ç –ø–µ—Å–Ω—é –æ —Ç–≤–æ–∏—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–∞—á–µ—Å—Ç–≤–∞—Ö, –ø—É—Ç–∏ –∏ —Å–∏–ª–µ.</p>
            <p>–≠—Ç–æ –Ω–µ —à–∞–±–ª–æ–Ω –∏ –Ω–µ —Å–ª—É—á–∞–π–Ω—ã–π —Ç–µ–∫—Å—Ç ‚Äî –∫–∞–∂–¥–∞—è –ø–µ—Å–Ω—è —É–Ω–∏–∫–∞–ª—å–Ω–∞ –∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–±–µ.</p>
          </div>
        </div>

        <!-- –ß—Ç–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å -->
        <div class="help-section">
          <button type="button" class="help-section-title" onclick="this.closest('.help-section').classList.toggle('open')">
            <span class="hst-icon">üéµ</span><span style="flex:1">–ß—Ç–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å</span><span class="hst-chevron">‚ñº</span>
          </button>
          <div class="help-section-body">
            <ul>
              <li><strong>–ü–µ—Å–Ω—è –æ —Å–µ–±–µ</strong> ‚Äî —Ç–≤–æ–π –ª–∏—á–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π –ø–æ—Ä—Ç—Ä–µ—Ç: –∫—Ç–æ —Ç—ã, —Ç–≤–æ—è —Å–∏–ª–∞ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø—É—Ç—å</li>
              <li><strong>–ü–µ—Å–Ω—è –¥–ª—è –ø–∞—Ä—ã</strong> ‚Äî –¥–ª—è –¥–≤–æ–∏—Ö (–≤–ª—é–±–ª—ë–Ω–Ω—ã—Ö, –¥—Ä—É–∑–µ–π, –ø–æ–¥—Ä—É–≥). –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±–µ –∫–∞—Ä—Ç—ã –∏ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å–æ—é–∑</li>
              <li><strong>–≠–Ω–µ—Ä–≥–∏—è –¥–Ω—è</strong> ‚Äî –ø–µ—Å–Ω—è –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É –∏ –º–µ—Å—Ç–æ. –ö–∞–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å</li>
            </ul>
            <p>–¢–∞–∫–∂–µ –µ—Å—Ç—å <strong>–±—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã</strong> ‚Äî –≥–æ—Ç–æ–≤—ã–µ –∏–¥–µ–∏: –ø–µ—Å–Ω—è —Å–∏–ª—ã, –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è, –º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è, –ø—Ä–æ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ–≥–æ –∏ –¥—Ä—É–≥–∏–µ.</p>
          </div>
        </div>

        <!-- –°–∫–æ–ª—å–∫–æ –∂–¥–∞—Ç—å -->
        <div class="help-section">
          <button type="button" class="help-section-title" onclick="this.closest('.help-section').classList.toggle('open')">
            <span class="hst-icon">‚è±</span><span style="flex:1">–°–∫–æ–ª—å–∫–æ –∂–¥–∞—Ç—å –ø–µ—Å–Ω—é</span><span class="hst-chevron">‚ñº</span>
          </button>
          <div class="help-section-body">
            <p>–û–±—ã—á–Ω–æ <strong>5‚Äì15 –º–∏–Ω—É—Ç</strong>. –ë–æ—Ç –ø—Ä–∏—à–ª—ë—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —á–∞—Ç, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ø–µ—Å–Ω—è –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞.</p>
            <p>–ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–¥—ë—Ç —Å–∞–º, —Ç—ã –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ—Ç–µ—Ä—è–µ—à—å.</p>
          </div>
        </div>

        <!-- –ù–µ –∑–Ω–∞—é –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è -->
        <div class="help-section">
          <button type="button" class="help-section-title" onclick="this.closest('.help-section').classList.toggle('open')">
            <span class="hst-icon">üïê</span><span style="flex:1">–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è</span><span class="hst-chevron">‚ñº</span>
          </button>
          <div class="help-section-body">
            <p>–ù–µ —Å—Ç—Ä–∞—à–Ω–æ. –û—Ç–º–µ—Ç—å <strong>¬´–í—Ä–µ–º—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ¬ª</strong> ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞—Å—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –ø–µ—Å–Ω—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
          </div>
        </div>

        <!-- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
        <div class="help-section">
          <button type="button" class="help-section-title" onclick="this.closest('.help-section').classList.toggle('open')">
            <span class="hst-icon">üéÅ</span><span style="flex:1">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</span><span class="hst-chevron">‚ñº</span>
          </button>
          <div class="help-section-body">
            <p><strong>–ü–µ—Ä–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ.</strong></p>
            <p>–ü–æ–ª—É—á–∏—Ç—å –µ—â—ë –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É: –ø–æ–¥–µ–ª–∏—Å—å —Å–≤–æ–µ–π —Å—Å—ã–ª–∫–æ–π. –ö–æ–≥–¥–∞ 5 –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö —Ç–æ–±–æ–π –¥—Ä—É–∑–µ–π —Å–æ–∑–¥–∞–¥—É—Ç –ø–µ—Ä–≤—É—é –ø–µ—Å–Ω—é ‚Äî —Ç–µ–±–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏—Å–ª–∏—Ç—Å—è 1 –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è.</p>
            <p>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ ‚Äî –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ü—Ä–æ—Ñ–∏–ª—å¬ª, –±–ª–æ–∫ ¬´–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞¬ª.</p>
          </div>
        </div>

        <!-- –û–ø–ª–∞—Ç–∞ -->
        <div class="help-section">
          <button type="button" class="help-section-title" onclick="this.closest('.help-section').classList.toggle('open')">
            <span class="hst-icon">üí≥</span><span style="flex:1">–û–ø–ª–∞—Ç–∞ –∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã</span><span class="hst-chevron">‚ñº</span>
          </button>
          <div class="help-section-body">
            <p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –ø–æ —Ç–∞—Ä–∏—Ñ—É. –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏.</p>
            <p>–ï—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å <strong>–ø—Ä–æ–º–æ–∫–æ–¥</strong> ‚Äî –≤–≤–µ–¥–∏ –µ–≥–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –æ–ø–ª–∞—Ç—ã. –ü—Ä–æ–º–æ–∫–æ–¥—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É, –≤–≤–æ–¥–∏ —Ç–æ—á–Ω–æ –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–æ.</p>
          </div>
        </div>

        <!-- –ü—Ä–æ–±–ª–µ–º—ã –∏ –æ—à–∏–±–∫–∏ -->
        <div class="help-section">
          <button type="button" class="help-section-title" onclick="this.closest('.help-section').classList.toggle('open')">
            <span class="hst-icon">‚ö†Ô∏è</span><span style="flex:1">–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫</span><span class="hst-chevron">‚ñº</span>
          </button>
          <div class="help-section-body">
            <p><strong>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–ª–æ—Å—å –∏–ª–∏ –ø–æ–∫–∞–∑–∞–ª–æ –æ—à–∏–±–∫—É</strong> ‚Äî –ø–æ–ø—Ä–æ–±—É–π –æ—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ. –ù–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
            <p><strong>–û–ø–ª–∞—Ç–∏–ª, –Ω–æ –ø–µ—Å–Ω–∏ –Ω–µ—Ç</strong> ‚Äî –ø–æ–¥–æ–∂–¥–∏ 15‚Äì20 –º–∏–Ω—É—Ç (–ø–µ—Å–Ω—è –º–æ–∂–µ—Ç –µ—â—ë –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è). –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–µ—Ç ‚Äî –Ω–∞–ø–∏—à–∏ –±–æ—Ç—É –≤ —á–∞—Ç: ¬´–ø–µ—Å–Ω—è –Ω–µ –ø—Ä–∏—à–ª–∞¬ª ‚Äî –æ–Ω –ø–æ–ø—Ä–æ–±—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ. –ü–æ–≤—Ç–æ—Ä–Ω—É—é –ø–æ–ø—ã—Ç–∫—É –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Ä–∞–∑ –≤ 10 –º–∏–Ω—É—Ç. –î–µ–π—Å—Ç–≤—É–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π –ø–æ—Å–ª–µ –∑–∞–∫–∞–∑–∞. –ò–ª–∏ –Ω–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.</p>
            <p><strong>–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è</strong> ‚Äî –ø—Ä–æ–≤–µ—Ä—å —Ä–µ–≥–∏—Å—Ç—Ä –±—É–∫–≤. –ï—Å–ª–∏ –≤—Å—ë –≤–µ—Ä–Ω–æ ‚Äî –Ω–∞–ø–∏—à–∏ –Ω–∞–º —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–¥–∞.</p>
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ -->
        <button type="button" class="help-support-btn" id="helpSupportBtn">üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</button>

      </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ü—Ä–æ—Ñ–∏–ª—å¬ª ‚Äî Suno-style -->
    <div class="page" id="profilePage">
      <!-- –®–∞–ø–∫–∞ —Å –∫–Ω–æ–ø–∫–æ–π –ù–∞–∑–∞–¥ -->
      <div class="profile-header">
        <button type="button" class="profile-back-btn" onclick="goBack()" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
        <div class="profile-header-title">–ü—Ä–æ—Ñ–∏–ª—å</div>
      </div>

      <div class="profile-scroll page-scroll">
        <!-- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: –∞–≤–∞—Ç–∞—Ä + –∏–º—è + –ø–ª–∞–Ω -->
        <div class="profile-identity">
          <div class="profile-avatar-wrap" id="profileAvatarWrap" title="–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ">
            <div id="profileAvatar" class="profile-avatar">
              <span id="profileAvatarInitial">üë§</span>
            </div>
            <div class="profile-avatar-edit">‚úé</div>
            <div class="profile-avatar-spinner" id="profileAvatarSpinner">‚Ä¶</div>
          </div>
          <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ç–æ -->
          <input type="file" id="avatarFileInput" accept="image/*" style="display:none">
          <div id="profileName" class="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
          <div id="profilePlanBadge" class="profile-plan-badge">‚ú¶ YupSoul Free</div>
        </div>

        <!-- –ë–∞–ª–∞–Ω—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–π -->
        <div class="profile-balance-card">
          <div class="profile-balance-left">
            <div id="profileBalanceLabel" class="profile-balance-label">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</div>
            <div id="profileCreditsCount" class="profile-balance-value">‚Äî</div>
            <div id="profileBalanceHint" class="profile-balance-hint">–ó–∞ –∫–∞–∂–¥—ã—Ö 5 –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö –¥—Ä—É–∑–µ–π ‚Äî +1 —Ç—Ä–µ–∫</div>
            <div id="profileRenewalDate" class="profile-balance-hint" style="display:none;color:rgba(212,175,55,0.65);margin-top:2px;"></div>
          </div>
          <div class="profile-balance-icon"><img src="assets/icons/music.png" style="width:32px;height:32px;object-fit:contain;display:block;opacity:0.85;" alt=""></div>
        </div>

        <!-- –¢–∞—Ä–∏—Ñ—ã ‚Äî Suno-style -->
        <div class="profile-section-title">
          <div style="width:18px;height:18px;border-radius:5px;overflow:hidden;background:#fdf8ec;box-shadow:0 1px 4px rgba(0,0,0,0.2);flex-shrink:0;display:inline-flex;align-items:center;justify-content:center;"><img src="assets/icons/security.png" style="width:100%;height:100%;object-fit:contain;display:block;padding:2px;box-sizing:border-box;" alt=""></div>
          –¢–∞—Ä–∏—Ñ—ã
        </div>
        <div class="profile-plans-grid">
          <!-- Free -->
          <div class="profile-plan-card current" id="planCardFree">
            <div class="ppc-badge">–¢–µ–∫—É—â–∏–π</div>
            <div class="ppc-name">Free</div>
            <div class="ppc-features">
              <div class="ppc-feature">‚ú¶ 1 —Ç—Ä–µ–∫ –≤ –ø–æ–¥–∞—Ä–æ–∫ <i class="ppc-info" data-tip="–ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚Äî –±–µ–∑ —É—Å–ª–æ–≤–∏–π –∏ —Å–∫—Ä—ã—Ç—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π.">i</i></div>
              <div class="ppc-feature">‚ú¶ –í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã <i class="ppc-info" data-tip="–î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ç—Ä–∏ —Ñ–æ—Ä–º–∞—Ç–∞: –î–ª—è —Å–µ–±—è, –î–ª—è –¥–≤–æ–∏—Ö –∏ –≠–Ω–µ—Ä–≥–∏—è –¥–Ω—è.">i</i></div>
            </div>
            <div class="ppc-price">–£–∂–µ —É —Ç–µ–±—è</div>
          </div>
          <!-- Soul Basic -->
          <div class="profile-plan-card" id="planCardBasic">
            <div class="ppc-badge" style="visibility:hidden">‚Äî</div>
            <div class="ppc-name">Basic</div>
            <div class="ppc-features">
              <div class="ppc-feature">‚ú¶ 5 —Ç—Ä–µ–∫–æ–≤/–º–µ—Å <i class="ppc-info" data-tip="5 –Ω–æ–≤—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–µ—Å–µ–Ω –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü. –†–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞ ‚Äî $5.99/—Ç—Ä–µ–∫. –ü–æ –ø–æ–¥–ø–∏—Å–∫–µ –≤—ã—Ö–æ–¥–∏—Ç $3/—Ç—Ä–µ–∫. –≠–∫–æ–Ω–æ–º–∏—è 50%.">i</i></div>
              <div class="ppc-feature">‚ú¶ Soul Chat <i class="ppc-info" data-tip="Soul Chat ‚Äî –∂–∏–≤–æ–π —Ä–∞–∑–≥–æ–≤–æ—Ä —Å —Ç–≤–æ–µ–π –¥—É—à–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–≤–æ–∏—Ö –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ó–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å—ã –æ —Å–µ–±–µ, —Å–≤–æ—ë–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ, –ø—É—Ç–∏ –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏. –ö–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç —É–Ω–∏–∫–∞–ª–µ–Ω ‚Äî –∫–∞–∫ —Ç—ã —Å–∞–º.">i</i></div>
              <div class="ppc-feature">‚ú¶ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ <i class="ppc-info" data-tip="–í—Å–µ —Ç–≤–æ–∏ –ø–µ—Å–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏. –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è, –ø–µ—Ä–µ—Å–ª—É—à–∞—Ç—å –∏ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è.">i</i></div>
            </div>
            <div class="ppc-price-wrap">
              <div class="ppc-price">$14.99/–º–µ—Å</div>
              <div class="ppc-save">‚àí50% vs —Ä–∞–∑–æ–≤—ã—Ö</div>
            </div>
            <img src="assets/icons/status-inactive.png" id="statusBasic" class="ppc-status-img" alt="–ù–µ –∞–∫—Ç–∏–≤–µ–Ω">
            <button class="ppc-btn" id="planBtnBasic">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
          </div>
          <!-- Soul Plus -->
          <div class="profile-plan-card popular" id="planCardPlus">
            <div class="ppc-badge hot">‚ú¶ –ü–æ–ø—É–ª—è—Ä–Ω—ã–π</div>
            <div class="ppc-name">Plus</div>
            <div class="ppc-features">
              <div class="ppc-feature">‚ú¶ 10 —Ç—Ä–µ–∫–æ–≤/–º–µ—Å <i class="ppc-info" data-tip="10 –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–µ—Å–µ–Ω –≤ –º–µ—Å—è—Ü. –†–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞ ‚Äî $5.99/—Ç—Ä–µ–∫. –ü–æ –ø–æ–¥–ø–∏—Å–∫–µ –≤—ã—Ö–æ–¥–∏—Ç $2.5/—Ç—Ä–µ–∫. –≠–∫–æ–Ω–æ–º–∏—è 58%.">i</i></div>
              <div class="ppc-feature">‚ú¶ Soul Chat –±–µ–∑ –ª–∏–º–∏—Ç–∞ <i class="ppc-info" data-tip="Soul Chat ‚Äî –∂–∏–≤–æ–π —Ä–∞–∑–≥–æ–≤–æ—Ä —Å —Ç–≤–æ–µ–π –¥—É—à–æ–π. –í Plus ‚Äî –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–µ—Å—Å–∏–π. –û–±—â–∞–π—Å—è –∫–æ–≥–¥–∞ —É–≥–æ–¥–Ω–æ.">i</i></div>
              <div class="ppc-feature">‚ú¶ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ <i class="ppc-info" data-tip="–¢–≤–æ–∏ –∑–∞—è–≤–∫–∏ –∏–¥—É—Ç –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å ‚Äî –ø–µ—Å–Ω—è –≥–æ—Ç–æ–≤–∞ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —É –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.">i</i></div>
              <div class="ppc-feature">‚ú¶ –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ <i class="ppc-info" data-tip="–î–æ—Å—Ç—É–ø –∫ —Ä–µ–¥–∫–∏–º –º—É–∑—ã–∫–∞–ª—å–Ω—ã–º —Å—Ç–∏–ª—è–º –∏ —Ñ–æ—Ä–º–∞—Ç–∞–º, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º –∏ Basic —Ç–∞—Ä–∏—Ñ–µ.">i</i></div>
            </div>
            <div class="ppc-price-wrap">
              <div class="ppc-price">$24.99/–º–µ—Å</div>
              <div class="ppc-save">‚àí58% vs —Ä–∞–∑–æ–≤—ã—Ö</div>
            </div>
            <img src="assets/icons/status-inactive.png" id="statusPlus" class="ppc-status-img" alt="–ù–µ –∞–∫—Ç–∏–≤–µ–Ω">
            <button class="ppc-btn popular-btn" id="planBtnPlus">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
          </div>
          <!-- –ú–∞—Å—Ç–µ—Ä ‚Äî –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è -->
          <div class="profile-plan-card master" id="planCardMaster">
            <div class="ppc-badge master-badge">–ú–∞—Å—Ç–µ—Ä</div>
            <div class="ppc-name">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</div>
            <div class="ppc-features">
              <div class="ppc-feature">‚ú¶ 30 —Ç—Ä–µ–∫–æ–≤/–º–µ—Å <i class="ppc-info" data-tip="30 –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–µ—Å–µ–Ω –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü ‚Äî –¥–ª—è —Å–µ–±—è –∏ –¥–ª—è –±–ª–∏–∑–∫–∏—Ö. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º.">i</i></div>
              <div class="ppc-feature">‚ú¶ –ö–∞—Ä—Ç–æ—Ç–µ–∫–∞ –ª—é–¥–µ–π <i class="ppc-info" data-tip="–î–æ–±–∞–≤–ª—è–π –±–ª–∏–∑–∫–∏—Ö –≤ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é –∏ —Å–æ–∑–¥–∞–≤–∞–π –¥–ª—è –Ω–∏—Ö –ø–µ—Å–Ω–∏ –≤ –æ–¥–∏–Ω —Ç–∞–ø. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è ‚Äî –≤–≤–æ–¥–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ.">i</i></div>
              <div class="ppc-feature">‚ú¶ –ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π <i class="ppc-info" data-tip="–ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–µ—Å–µ–Ω —Å —Ç–µ–∫—Å—Ç–∞–º–∏, –∞—É–¥–∏–æ –∏ –¥–∞—Ç–∞–º–∏ ‚Äî –¥–ª—è —Ç–µ–±—è –∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ç–≤–æ–∏—Ö –ª—é–¥–µ–π.">i</i></div>
              <div class="ppc-feature">‚ú¶ Soul Chat –±–µ–∑ –ª–∏–º–∏—Ç–∞ <i class="ppc-info" data-tip="–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Soul Chat ‚Äî —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–π —Å –¥—É—à–æ–π —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ.">i</i></div>
            </div>
            <div class="ppc-price-wrap">
              <div class="ppc-price" id="masterPriceEl">$39.99/–º–µ—Å</div>
              <div class="ppc-save">‚àí83% vs —Ä–∞–∑–æ–≤—ã—Ö</div>
            </div>
            <img src="assets/icons/status-inactive.png" id="statusMaster" class="ppc-status-img" alt="–ù–µ –∞–∫—Ç–∏–≤–µ–Ω">
            <button class="ppc-btn master-btn" id="planBtnMaster">–û—Ç–∫—Ä—ã—Ç—å –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é</button>
          </div>
        </div>

        <!-- –†–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–∫–∏ -->
        <div class="profile-section-title" style="margin-top:24px">–†–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–∫–∏</div>
        <div class="profile-track-list">
          <div class="profile-track-item" onclick="goToPage('formPage');setTimeout(function(){var b=document.querySelector('.mode-btn[data-mode=\'single\']');if(b){b.click();}},100)">
            <div>
              <div class="pti-name">–î–ª—è —Å–µ–±—è</div>
              <div class="pti-desc">–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å –≤ –∑–≤—É–∫–µ</div>
            </div>
            <div class="pti-right"><div class="pti-price">$5.99</div><div class="pti-arrow">‚Ä∫</div></div>
          </div>
          <div class="profile-track-item" onclick="goToPage('formPage');setTimeout(function(){var b=document.querySelector('.mode-btn[data-mode=\'couple\']');if(b){b.click();}},100)">
            <div>
              <div class="pti-name">–î–ª—è –¥–≤–æ–∏—Ö</div>
              <div class="pti-desc">–í–∞—à–∞ —Å–≤—è–∑—å –∏ —Ä–µ–∑–æ–Ω–∞–Ω—Å</div>
            </div>
            <div class="pti-right"><div class="pti-price">$8.99</div><div class="pti-arrow">‚Ä∫</div></div>
          </div>
          <div class="profile-track-item" onclick="goToPage('formPage');setTimeout(function(){var b=document.querySelector('.mode-btn[data-mode=\'transit\']');if(b){b.click();}},100)">
            <div>
              <div class="pti-name">–≠–Ω–µ—Ä–≥–∏—è –¥–Ω—è</div>
              <div class="pti-desc">–ü–µ—Å–Ω—è –ø–æ–¥ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å</div>
            </div>
            <div class="pti-right"><div class="pti-price">$6.99</div><div class="pti-arrow">‚Ä∫</div></div>
          </div>
        </div>

        <!-- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ -->
        <div class="profile-referral-section">
          <div class="profile-section-title">
            <div style="width:18px;height:18px;border-radius:5px;overflow:hidden;background:#fdf8ec;box-shadow:0 1px 4px rgba(0,0,0,0.2);flex-shrink:0;display:inline-flex;align-items:center;justify-content:center;"><img src="assets/icons/forward.png" style="width:100%;height:100%;object-fit:contain;display:block;padding:2px;box-sizing:border-box;" alt=""></div>
            –ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞
          </div>
          <div class="profile-ref-tagline">–ó–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—Å—Ç –ø–µ—Ä–≤—É—é –ø–µ—Å–Ω—é ‚Äî —Ç–µ–±–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç—Ä–µ–∫</div>
          <div class="profile-ref-link-row">
            <input id="profileRefLinkInput" readonly placeholder="–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶">
          </div>
          <button type="button" id="profileRefShareBtn" class="profile-ref-share-btn">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π</button>
          <div class="profile-ref-stats">
            <span><strong id="profileRefInvited">0</strong><span class="profile-ref-stats-label">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ</span></span>
            <span><strong id="profileRefRewarded">0</strong><span class="profile-ref-stats-label">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ</span></span>
          </div>
        </div>

        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
        <button type="button" id="profileCreateSongBtn" class="profile-create-btn">
          –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ø–µ—Å–Ω—é
        </button>
        <button type="button" class="secondary" onclick="goToHelpFrom('profilePage')" style="width:100%;margin-bottom:16px;background:transparent;border-color:rgba(255,255,255,0.1);color:rgba(255,255,255,0.4);font-size:0.82rem;">–ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞</button>
      </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ú–æ–∏ –≥–µ—Ä–æ–∏¬ª (—Ç–∞—Ä–∏—Ñ –ú–∞—Å—Ç–µ—Ä) -->
    <div class="page" id="heroesPage">
      <!-- –®–∞–ø–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
      <div class="page-header" style="padding:max(20px,calc(env(safe-area-inset-top)+12px)) 18px 12px; display:flex; align-items:center; gap:12px;">
        <button type="button" id="heroesBackBtn" style="background:none;border:none;color:rgba(255,255,255,0.5);font-size:1.4rem;cursor:pointer;padding:4px 8px;min-height:unset;width:auto;box-shadow:none;animation:none;margin:0;line-height:1">‚Üê</button>
        <div style="flex:1">
          <div style="font-size:1.15rem;font-weight:700;color:#fff;line-height:1.2">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</div>
          <div style="font-size:0.75rem;color:rgba(212,175,55,0.65);margin-top:2px" id="masterAccessBadge"></div>
        </div>
      </div>

      <!-- Paywall (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞) -->
      <div id="masterPaywall" class="page-scroll" style="display:none; padding-top:28px;">
        <div style="text-align:center; margin-bottom:20px">
          <div style="font-size:2rem;margin-bottom:12px;color:#d4af37;letter-spacing:0.1em">‚ú¶</div>
          <div style="font-size:1.2rem;font-weight:700;color:#d4af37;margin-bottom:8px">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤</div>
          <div style="font-size:0.85rem;color:rgba(255,255,255,0.5);line-height:1.6">–î–æ–±–∞–≤–ª—è–π –ª—é–¥–µ–π –æ–¥–∏–Ω —Ä–∞–∑ ‚Äî –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–π –¥–ª—è –Ω–∏—Ö<br>–ø–µ—Å–Ω–∏ –≤ –æ–¥–∏–Ω —Ç–∞–ø. –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Å —Ç–µ–∫—Å—Ç–∞–º–∏.</div>
        </div>
        <div style="background:rgba(212,175,55,0.06);border:1px solid rgba(212,175,55,0.18);border-radius:14px;padding:16px;margin-bottom:22px;font-size:0.82rem;color:rgba(255,255,255,0.55);line-height:1.65">
          <div style="color:#d4af37;font-weight:600;margin-bottom:8px">–ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ —Ç–∞—Ä–∏—Ñ:</div>
          <div>‚ú¶ –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≥–µ—Ä–æ–µ–≤</div>
          <div>‚ú¶ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —Å–æ–ª–æ –∏ —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –ø–µ—Å–µ–Ω</div>
          <div>‚ú¶ –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ —Å—Ç–∏–ª—é –º—É–∑—ã–∫–∏</div>
          <div>‚ú¶ –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Å —Ç–µ–∫—Å—Ç–∞–º–∏ –∏ –∞–Ω–∞–ª–∏–∑–æ–º</div>
          <div>‚ú¶ –ê—É–¥–∏–æ –ø—Ä—è–º–æ –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ –≥–µ—Ä–æ—è</div>
        </div>
        <button type="button" id="masterTrialBtn" style="width:100%;padding:13px 24px;border-radius:14px;background:linear-gradient(135deg,rgba(212,175,55,0.2),rgba(212,175,55,0.08));border:1px solid rgba(212,175,55,0.4);color:#d4af37;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;margin-bottom:12px;box-shadow:none;animation:none;letter-spacing:0;min-height:48px">1 –¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚Äî –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å</button>
        <button type="button" id="masterSubBtn" onclick="showPlanConfirm('plan_master','–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è')" style="width:100%;padding:14px 24px;border-radius:14px;background:linear-gradient(135deg,rgba(167,139,250,0.15),rgba(167,139,250,0.06));border:1.5px solid rgba(167,139,250,0.35);color:rgba(167,139,250,0.9);font-size:0.95rem;font-weight:700;cursor:pointer;font-family:inherit;box-shadow:none;animation:none;letter-spacing:0;min-height:48px">–û—Ñ–æ—Ä–º–∏—Ç—å –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é ‚Äî $39.99/–º–µ—Å</button>
        <div style="font-size:0.7rem;color:rgba(255,255,255,0.22);text-align:center;margin-top:12px">30 —Ç—Ä–µ–∫–æ–≤ –≤ –º–µ—Å—è—Ü ¬∑ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ HOT Pay</div>
      </div>

      <!-- –ö–∞–±–∏–Ω–µ—Ç –≥–µ—Ä–æ–µ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø) -->
      <div id="masterCabinet" class="page-scroll" style="display:none;">
        <!-- –°—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ + –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å -->
        <div style="display:flex;gap:10px;margin-bottom:16px">
          <input type="text" id="heroesSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏‚Ä¶" style="flex:1;margin:0;padding:11px 14px;font-size:0.88rem">
          <button type="button" id="heroesSearchBtn" style="width:auto;padding:11px 14px;font-size:0.88rem;min-height:44px;box-shadow:none;animation:none;letter-spacing:0;background:rgba(212,175,55,0.12);border-color:rgba(212,175,55,0.3);color:#d4af37;flex-shrink:0">–ù–∞–π—Ç–∏</button>
        </div>
        <div id="heroesList"></div>
        <button type="button" id="addHeroBtn" style="margin-top:12px;width:100%;background:rgba(212,175,55,0.08);border:1px dashed rgba(212,175,55,0.35);color:rgba(212,175,55,0.8);font-size:0.9rem;padding:13px 24px;border-radius:14px;box-shadow:none;animation:none;letter-spacing:0;min-height:48px">+ –î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è</button>
      </div>

      <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–µ—Ä–æ—è -->
      <div id="heroFormWrap" style="display:none; padding:16px 16px 90px; overflow-y:auto; flex:1">
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:18px">
          <button type="button" id="heroFormCancel" style="background:none;border:none;color:rgba(255,255,255,0.4);font-size:1.3rem;cursor:pointer;padding:4px;min-height:unset;width:auto;box-shadow:none;animation:none;margin:0">‚Üê</button>
          <div style="font-size:1rem;font-weight:700;color:#fff" id="heroFormTitle">–î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è</div>
        </div>
        <div class="field"><label for="heroName">–ò–º—è *</label><input type="text" id="heroName" placeholder="–ö–∞–∫ –∑–æ–≤—É—Ç —á–µ–ª–æ–≤–µ–∫–∞"></div>
        <div class="field"><label for="heroRelationship">–ö—Ç–æ –¥–ª—è —Ç–µ–±—è</label>
          <select id="heroRelationship">
            <option value="">‚Äî –≤—ã–±–µ—Ä–∏ ‚Äî</option>
            <option value="–º–∞—Ç—å">–ú–∞—Ç—å</option>
            <option value="–æ—Ç–µ—Ü">–û—Ç–µ—Ü</option>
            <option value="–¥–æ—á—å">–î–æ—á—å</option>
            <option value="—Å—ã–Ω">–°—ã–Ω</option>
            <option value="—Å–µ—Å—Ç—Ä–∞">–°–µ—Å—Ç—Ä–∞</option>
            <option value="–±—Ä–∞—Ç">–ë—Ä–∞—Ç</option>
            <option value="–±–∞–±—É—à–∫–∞">–ë–∞–±—É—à–∫–∞</option>
            <option value="–¥–µ–¥—É—à–∫–∞">–î–µ–¥—É—à–∫–∞</option>
            <option value="–º—É–∂">–ú—É–∂</option>
            <option value="–∂–µ–Ω–∞">–ñ–µ–Ω–∞</option>
            <option value="–ª—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫">–õ—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫</option>
            <option value="–¥—Ä—É–≥">–î—Ä—É–≥</option>
            <option value="–ø–æ–¥—Ä—É–≥–∞">–ü–æ–¥—Ä—É–≥–∞</option>
            <option value="–∫–æ–ª–ª–µ–≥–∞">–ö–æ–ª–ª–µ–≥–∞</option>
            <option value="–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫">–ù–∞—Å—Ç–∞–≤–Ω–∏–∫</option>
            <option value="–¥—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
          </select>
        </div>
        <div class="field">
          <label for="heroBirthdate" data-icon="üìÖ">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
          <div id="heroBirthdateWrap" class="birthdate-wrap">
            <div class="date-group" role="group" aria-label="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è">
              <select id="heroBirthdateDay" class="date-group-day" aria-label="–î–µ–Ω—å"><option value="">–î–µ–Ω—å</option></select>
              <select id="heroBirthdateMonth" class="date-group-month" aria-label="–ú–µ—Å—è—Ü"><option value="">–ú–µ—Å—è—Ü</option></select>
              <select id="heroBirthdateYear" class="date-group-year" aria-label="–ì–æ–¥"><option value="">–ì–æ–¥</option></select>
            </div>
            <input type="date" id="heroBirthdate" tabindex="-1">
          </div>
          <div style="font-size:0.85rem;color:var(--tg-theme-hint-color,#9ca3af);margin-top:6px;">–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å, –º–µ—Å—è—Ü –∏ –≥–æ–¥</div>
        </div>
        <div class="field">
          <label for="heroBirthplace" data-icon="üìç">–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
          <div id="heroBirthplaceWrap" class="birthplace-wrap">
            <input type="text" id="heroBirthplace" placeholder="–ú–æ—Å–∫–≤–∞, –õ–æ–Ω–¥–æ–Ω, –ù—å—é-–ô–æ—Ä–∫‚Ä¶" autocomplete="off">
            <span id="heroBirthplaceCheck" class="birthplace-check" aria-hidden="true">‚úì</span>
            <ul id="heroBirthplaceSuggestions" class="birthplace-suggestions" aria-hidden="true"></ul>
          </div>
          <div id="heroBirthplaceHint" class="birthplace-hint" style="display:block;font-size:0.9rem;color:rgba(212,175,55,0.85);margin-top:8px;line-height:1.5;">–ù–∞—á–Ω–∏ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥ –∏ –≤—ã–±–µ—Ä–∏ –∏–∑ –≤—ã–ø–∞–≤—à–µ–≥–æ —Å–ø–∏—Å–∫–∞.</div>
        </div>
        <div class="field">
          <label data-icon="üïê">–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è</label>
          <div class="time-group" role="group" aria-label="–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è">
            <input type="time" id="heroBirthtime" class="time-group-input">
            <div class="checkbox time-group-checkbox">
              <input type="checkbox" id="heroBirthtimeUnknown">
              <label for="heroBirthtimeUnknown">–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è</label>
            </div>
          </div>
        </div>
        <div class="field"><label for="heroGender">–ü–æ–ª</label>
          <select id="heroGender">
            <option value="">–í—ã–±–µ—Ä–∏</option>
            <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
            <option value="male">–ú—É–∂—Å–∫–æ–π</option>
            <option value="other">–î—Ä—É–≥–æ–π</option>
          </select>
        </div>
        <div class="field"><label for="heroStyle">–õ—é–±–∏–º—ã–µ —Å—Ç–∏–ª–∏ –º—É–∑—ã–∫–∏</label><input type="text" id="heroStyle" placeholder="–ø–æ–ø, –¥–∂–∞–∑, —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è‚Ä¶"></div>
        <div class="field"><label for="heroNotes">–ó–∞–º–µ—Ç–∫–∏</label><textarea id="heroNotes" placeholder="–ß—Ç–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –æ–± —ç—Ç–æ–º —á–µ–ª–æ–≤–µ–∫–µ" rows="2"></textarea></div>
        <div style="display:flex;gap:10px;margin-top:6px">
          <button type="button" id="heroFormSave" style="flex:2">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ñ–æ—Ä–º—ã -->
    <div class="page" id="formPage">
      <header class="page-header">
        <button type="button" onclick="goBack()" style="position:absolute;left:16px;top:50%;transform:translateY(-50%);background:none;border:none;color:rgba(255,255,255,0.55);font-size:1.5rem;cursor:pointer;padding:4px 8px;min-height:unset;width:auto;box-shadow:none;animation:none;margin:0;line-height:1" aria-label="–ù–∞–∑–∞–¥">‚Äπ</button>
        <h1>YupSoul</h1>
        <div style="font-size:0.78rem;font-weight:400;letter-spacing:0.12em;color:rgba(212,175,55,0.5);margin:2px 0 0;text-transform:uppercase">–ú—É–∑—ã–∫–∞ —Ç–≤–æ–µ–π –¥—É—à–∏</div>
      </header>

      <div class="page-scroll">
      <!-- –í—ã–±–æ—Ä –≥–µ—Ä–æ—è –¥–ª—è –º–∞—Å—Ç–µ—Ä-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å–∫—Ä—ã—Ç —É –æ–±—ã—á–Ω—ã—Ö) -->
      <div id="forWhoWrap" style="display:none; padding:0; margin-bottom:16px">
        <div class="field" style="margin-bottom:0">
          <label for="forWho" style="font-size:0.82rem">–î–ª—è –∫–æ–≥–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º?</label>
          <select id="forWho">
            <option value="">–î–ª—è —Å–µ–±—è</option>
          </select>
        </div>
      </div>
      
      <div class="section">
        <div class="step-panel" data-step="1">
          <div class="mode-selector">
            <h3 style="display:flex;align-items:center;gap:10px;justify-content:center;">
              <div style="width:28px;height:28px;border-radius:8px;overflow:hidden;flex-shrink:0;box-shadow:0 2px 6px rgba(0,0,0,0.25);"><img src="assets/icons/writing.png" alt="" style="width:100%;height:100%;object-fit:contain;display:block;"></div>
              –§–æ—Ä–º–∞—Ç –ø–µ—Å–Ω–∏
            </h3>
            <p class="mode-subtitle">–î–ª—è –∫–æ–≥–æ —Å–æ–∑–¥–∞—ë–º?</p>
            <div class="mode-buttons">
              <button type="button" class="mode-btn active" data-mode="single">
                <span class="mode-label" data-i18n="modeSingle">–û–±–æ –º–Ω–µ</span>
                <span class="mode-desc" data-i18n="modeSingleDesc">–ü–µ—Å–Ω—è –ø–æ —Ç–≤–æ–µ–π –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è</span>
              </button>
              <button type="button" class="mode-btn" data-mode="couple">
                <span class="mode-label" data-i18n="modeCouple">–ü—Ä–æ –¥–≤–æ–∏—Ö</span>
                <span class="mode-desc" data-i18n="modeCoupleDesc">–ü–µ—Å–Ω—è –¥–ª—è –¥–≤—É—Ö –ª—é–¥–µ–π</span>
              </button>
              <button type="button" class="mode-btn" data-mode="transit">
                <span class="mode-label" data-i18n="modeTransit">–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞</span>
                <span class="mode-desc" data-i18n="modeTransitDesc">–ü–µ—Å–Ω—è –æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º –¥–Ω–µ</span>
              </button>
            </div>
          </div>
        </div>

        <!-- –ê–∫–∫–æ—Ä–¥–µ–æ–Ω –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–≥–æ—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div id="profileAccordion" style="display:none;margin-bottom:12px;">
          <div class="pfa-header" onclick="toggleProfileAccordion()">
            <div class="pfa-info">
              <svg class="pfa-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="2"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
              <span id="pfaName" class="pfa-name"></span>
              <span class="pfa-sep" id="pfaSep" style="display:none">¬∑</span>
              <span id="pfaDate" class="pfa-date"></span>
            </div>
            <div class="pfa-chevron" id="pfaChevron">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
          </div>
        </div>

        <div id="formFieldsWrap">
        <div class="step-panel" data-step="2">
        <div class="field">
          <label for="name" data-icon="üë§">–ò–º—è</label>
            <input type="text" id="name" placeholder="–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?" required aria-label="–ò–º—è">
        </div>
        
        <div class="field">
          <label for="birthdate" data-icon="üìÖ">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
          <div id="birthdateWrap" class="birthdate-wrap">
            <div class="date-group" role="group" aria-label="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è">
              <select id="birthdateDay" class="date-group-day" aria-label="–î–µ–Ω—å"><option value="">–î–µ–Ω—å</option></select>
              <select id="birthdateMonth" class="date-group-month" aria-label="–ú–µ—Å—è—Ü"><option value="">–ú–µ—Å—è—Ü</option></select>
              <select id="birthdateYear" class="date-group-year" aria-label="–ì–æ–¥"><option value="">–ì–æ–¥</option></select>
            </div>
            <input type="date" id="birthdate" required aria-label="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è" tabindex="-1">
            <span id="birthdateCheck" class="birthdate-check" aria-hidden="true">‚úì</span>
          </div>
        </div>
        
        <div class="field">
          <label for="birthplace" data-icon="üìç">–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
          <div id="birthplaceWrap" class="birthplace-wrap">
              <input type="text" id="birthplace" placeholder="–ú–æ—Å–∫–≤–∞, –õ–æ–Ω–¥–æ–Ω, –ù—å—é-–ô–æ—Ä–∫..." required autocomplete="off" aria-label="–õ–æ–∫–∞—Ü–∏—è —Ä–æ–∂–¥–µ–Ω–∏—è">
              <span id="birthplaceCheck" class="birthplace-check" aria-hidden="true">‚úì</span>
            <ul id="birthplaceSuggestions" class="birthplace-suggestions" aria-hidden="true"></ul>
          </div>
          <div id="birthplaceHint" class="birthplace-hint" style="display:none;font-size:0.9rem;color:rgba(212,175,55,0.85);margin-top:8px;line-height:1.5;">–ù–∞—á–Ω–∏ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥ –∏ –≤—ã–±–µ—Ä–∏ –∏–∑ –≤—ã–ø–∞–≤—à–µ–≥–æ —Å–ø–∏—Å–∫–∞.</div>
        </div>
        
        <div class="field">
          <label data-icon="üïê">–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è</label>
          <div class="time-group" role="group" aria-label="–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è">
            <input type="time" id="birthtime" required aria-label="–í—Ä–µ–º—è" class="time-group-input">
            <div class="checkbox time-group-checkbox">
              <input type="checkbox" id="unknown" aria-label="–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è">
              <label for="unknown">–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è</label>
            </div>
          </div>
        </div>
        
        <div class="field">
          <label for="gender" id="genderLabel">–ü–æ–ª</label>
          <select id="gender" required aria-label="–ü–æ–ª">
              <option value="">–í—ã–±–µ—Ä–∏</option>
            <option value="male">–ú—É–∂—Å–∫–æ–π</option>
            <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
            <option value="other">–î—Ä—É–≥–æ–π</option>
          </select>
        </div>
        
        <div class="field">
            <select id="language" required aria-label="–Ø–∑—ã–∫ –ø–µ—Å–Ω–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è" title="–ù–∞ –∫–∞–∫–æ–º —è–∑—ã–∫–µ –±—É–¥–µ—Ç —Ç–µ–∫—Å—Ç –ø–µ—Å–Ω–∏ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞">
              <option value="">–Ø–∑—ã–∫ –ø–µ—Å–Ω–∏</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English</option>
            <option value="de">Deutsch</option>
            <option value="fr">Fran√ßais</option>
            <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
          </select>
        </div>
        
          <div id="secondPersonForm" style="display:none">
            <h3 style="margin-bottom:12px;">–î–ª—è –¥–≤–æ–∏—Ö</h3>
          <div class="field">
            <label for="name2" data-icon="üë§">–ò–º—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞</label>
            <input type="text" id="name2" placeholder="–ò–º—è" maxlength="50">
          </div>
          <div class="field">
            <label for="birthdate2" data-icon="üìÖ">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ</label>
            <div id="birthdate2Wrap" class="birthdate-wrap">
              <div class="date-group" role="group" aria-label="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ">
                <select id="birthdate2Day" class="date-group-day" aria-label="–î–µ–Ω—å"><option value="">–î–µ–Ω—å</option></select>
                <select id="birthdate2Month" class="date-group-month" aria-label="–ú–µ—Å—è—Ü"><option value="">–ú–µ—Å—è—Ü</option></select>
                <select id="birthdate2Year" class="date-group-year" aria-label="–ì–æ–¥"><option value="">–ì–æ–¥</option></select>
              </div>
              <input type="date" id="birthdate2" tabindex="-1">
            </div>
          </div>
          <div class="field">
            <label for="birthplace2" data-icon="üìç">–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ</label>
            <div id="birthplace2Wrap" class="birthplace-wrap">
              <input type="text" id="birthplace2" placeholder="–ú–æ—Å–∫–≤–∞, –õ–æ–Ω–¥–æ–Ω, –ù—å—é-–ô–æ—Ä–∫..." maxlength="100" autocomplete="off" aria-label="–õ–æ–∫–∞—Ü–∏—è —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ">
              <span id="birthplace2Check" class="birthplace-check" aria-hidden="true">‚úì</span>
              <ul id="birthplaceSuggestions2" class="birthplace-suggestions" aria-hidden="true"></ul>
            </div>
            <div id="birthplace2Hint" class="birthplace-hint" style="display:none;font-size:0.9rem;color:rgba(212,175,55,0.85);margin-top:8px;line-height:1.5;">–ù–∞—á–Ω–∏ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥ –∏ –≤—ã–±–µ—Ä–∏ –∏–∑ –≤—ã–ø–∞–≤—à–µ–≥–æ —Å–ø–∏—Å–∫–∞.</div>
          </div>
          <div class="field">
            <label data-icon="üïê">–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ</label>
            <div class="time-group" role="group">
              <input type="time" id="birthtime2" aria-label="–í—Ä–µ–º—è" class="time-group-input">
              <div class="checkbox time-group-checkbox">
                <input type="checkbox" id="unknown2" aria-label="–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è">
                <label for="unknown2">–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è</label>
              </div>
            </div>
          </div>
          <div class="field">
            <label for="gender2" data-icon="‚öß">–ü–æ–ª –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞</label>
            <select id="gender2">
                <option value="">–í—ã–±–µ—Ä–∏</option>
              <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
              <option value="male">–ú—É–∂—Å–∫–æ–π</option>
              <option value="other">–î—Ä—É–≥–æ–π</option>
            </select>
          </div>
          <input type="hidden" id="person2Relationship">
        </div>
        
          <div id="transitForm" style="display:none">
            <h3 style="margin-bottom:12px;">–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞</h3>
          <div class="field">
              <input type="date" id="transitDate" min="2024-01-01" max="2030-12-31" placeholder="–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è">
          </div>
          <div class="field">
              <input type="time" id="transitTime" placeholder="–í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è">
          </div>
          <div class="field form-group location-input-wrapper">
              <input type="text" id="transitLocation" class="location-input" placeholder="–ì–æ—Ä–æ–¥ –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –º–æ–º–µ–Ω—Ç–∞" maxlength="100" autocomplete="off">
            <div id="transitLocationSuggestions" class="location-suggestions"></div>
            <div class="checkbox-group" style="margin-top: 10px;">
              <input type="checkbox" id="transitLocationConfirmed">
                <label for="transitLocationConfirmed">–õ–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ</label>
            </div>
          </div>
          <div class="field">
              <textarea id="transitIntent" placeholder="–ù–∞–º–µ—Ä–µ–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" rows="2" maxlength="200" style="min-height:60px"></textarea>
            </div>
          </div>
        </div>
        </div><!-- /formFieldsWrap -->
        
        <div class="step-panel" data-step="3">
        <div class="field">
          <div class="request-label">–û—Ç–ø—Ä–∞–≤—å –∑–∞–ø—Ä–æ—Å</div>
          
          <div class="quick-picker">
            <button type="button" id="quickPickerBtn" class="quick-picker-btn">
              <span>–ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã</span><span class="qa">‚ñæ</span>
            </button>
            <div id="quickPickerSheet" class="quick-picker-sheet" style="display:none">
              <div class="quick-picker-scroll">
                <button type="button" class="quick-item example-btn" data-text="–í–µ—Å—ë–ª–∞—è –ø–µ—Å–Ω—è —Å —Å–∞–º–æ–∏—Ä–æ–Ω–∏–µ–π –ø—Ä–æ –º–æ–∏ —Å–ª–∞–±–æ—Å—Ç–∏ –∏ –ø—Ä–∏–≤—ã—á–∫–∏">üòÑ –í–µ—Å—ë–ª–∞—è –ø—Ä–æ —Å–ª–∞–±–æ—Å—Ç–∏</button>
                <button type="button" class="quick-item example-btn" data-text="–Æ–º–æ—Ä –∏ –ª—ë–≥–∫–æ—Å—Ç—å ‚Äî –¥–æ–±—Ä—ã–π –≤–∑–≥–ª—è–¥ –Ω–∞ —Å–µ–±—è">üòä –Æ–º–æ—Ä –∏ –ª—ë–≥–∫–æ—Å—Ç—å</button>
                <button type="button" class="quick-item example-btn" data-text="–†–µ–∂–∏–º —é–º–æ—Ä 100% ‚Äî –≤–µ—Å—ë–ª–∞—è –ø–µ—Å–Ω—è —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —é–º–æ—Ä–æ–º –∏ –ª—ë–≥–∫–æ—Å—Ç—å—é">üòÇ –†–µ–∂–∏–º: —é–º–æ—Ä 100%</button>
                <button type="button" class="quick-item example-btn" data-text="–¢—Ä–æ–≥–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äî –¥—É—à–µ–≤–Ω–∞—è –ø–µ—Å–Ω—è-–ø–æ–¥–∞—Ä–æ–∫">üéÇ –¢—Ä–æ–≥–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                <button type="button" class="quick-item example-btn" data-text="–ó–∞–±–∞–≤–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äî —Ç–µ–ø–ª–æ –∏ —Å —É–ª—ã–±–∫–æ–π">ü•≥ –ó–∞–±–∞–≤–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                <button type="button" class="quick-item example-btn" data-text="–ú–æ—â–Ω–∞—è –ø–µ—Å–Ω—è –æ –º–æ–µ–π —Å–∏–ª–µ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç–µ–π">üí™ –°–∏–ª–∞ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ</button>
                <button type="button" class="quick-item example-btn" data-text="–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –æ–ø–æ—Ä–∞ –Ω–∞ —Å–µ–±—è">‚ú® –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—É—Ç—å</button>
                <button type="button" class="quick-item example-btn" data-text="–Ø—Ä–∫–∞—è —Å–∞–º–æ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è ‚Äî –∫—Ç–æ —è –∏ —á—Ç–æ –Ω–µ—Å—É –≤ –º–∏—Ä">üåü –ö—Ç–æ —è –∏ –º–æ—è –º–∏—Å—Å–∏—è</button>
                <button type="button" class="quick-item example-btn" data-text="–ì–∞—Ä–º–æ–Ω–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ">üåø –ì–∞—Ä–º–æ–Ω–∏—è –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ</button>
                <button type="button" class="quick-item example-btn" data-text="–û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ –∏ –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏">üå± –û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ</button>
                <button type="button" class="quick-item example-btn" data-text="–ò—Å—Ü–µ–ª–∏—Ç—å –¥–µ—Ç—Å–∫–∏–µ —Ç—Ä–∞–≤–º—ã –∏ –æ–±—Ä–µ—Å—Ç–∏ —Å–≤–æ–±–æ–¥—É">üí´ –ò—Å—Ü–µ–ª–µ–Ω–∏–µ –∏ —Å–≤–æ–±–æ–¥–∞</button>
                <button type="button" class="quick-item example-btn" data-text="–ú–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è –ø–µ—Å–Ω—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ —Ç–∏—à–∏–Ω—ã">üßò –¢–∏—à–∏–Ω–∞ –∏ –º–µ–¥–∏—Ç–∞—Ü–∏—è</button>
              </div>
            </div>
          </div>
          
          <textarea id="request" placeholder="–ö–∞–∫—É—é –≥—Ä–∞–Ω—å –±—É–¥–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è?" aria-label="–ó–∞–ø—Ä–æ—Å" rows="4"></textarea>
          <div style="font-size:0.78rem;color:rgba(255,255,255,0.35);margin-top:8px;line-height:1.5;">
            –û–ø–∏—à–∏, —á—Ç–æ —Ö–æ—á–µ—à—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –∏–ª–∏ –≤—ã–±–µ—Ä–∏ –≥–æ—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –≤—ã—à–µ
          </div>
        </div>

        <p id="submitHint" style="display:none"></p>

        <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚Äî sticky –≤–Ω–∏–∑—É, –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ -->
        <div class="step-nav form-submit-sticky">
          <button id="stepNext">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
          <!-- –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ—Ç–∞ ‚Äî —Ç–∏—Ö–æ, –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π -->
          <div id="botActivateBlock" style="margin-top:8px;text-align:center;">
            <button type="button" id="openBotBeforeSubmitBtn" style="background:none;border:none;color:rgba(212,175,55,0.45);font-size:0.75rem;cursor:pointer;font-family:inherit;min-height:unset;box-shadow:none;animation:none;margin:0;padding:4px 0;text-decoration:underline;text-underline-offset:3px;">
              –ï—â—ë –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª –±–æ—Ç–∞? –û—Ç–∫—Ä—ã—Ç—å
            </button>
          </div>
        </div>
      </div>
      
      </div><!-- /page-scroll -->
    </div>
    
    <!-- paymentPage —É–±—Ä–∞–Ω –∏–∑ .page-—Å–∏—Å—Ç–µ–º—ã ‚Äî –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ #paymentOverlay –Ω–∏–∂–µ -->
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="page" id="loadingPage">
      <div class="loading">
        <div class="spinner"></div>
        <div class="loading-text" id="loadingTitle">–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞</div>
        <div id="loadingDesc" style="color:rgba(255,255,255,0.55);font-size:0.92rem;text-align:center;max-width:320px;line-height:1.7;margin-top:12px;">
          –ü–µ—Å–Ω—è —Å–æ–∑–¥–∞—ë—Ç—Å—è. –ü—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º.<br>–ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ.
        </div>
        <div id="loadingCountdown" style="margin-top:20px;color:rgba(212,175,55,0.65);font-size:0.9rem;"></div>
      </div>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—Ö–∞ -->
    <div class="page" id="successPage">
      <header class="page-header">
        <h1>YupSoul</h1>
        <div style="font-size:0.78rem;font-weight:400;letter-spacing:0.12em;color:rgba(212,175,55,0.5);margin:2px 0 0;text-transform:uppercase">–ú—É–∑—ã–∫–∞ —Ç–≤–æ–µ–π –¥—É—à–∏</div>
        <div class="subtitle">–ü–µ—Å–Ω—è —Å–æ–∑–¥–∞–Ω–∞!</div>
      </header>
      
      <div class="section page-scroll">
        <img src="assets/logo-yupsoul.png" alt="YupSoul" class="app-logo success" width="180" height="180">
        <h2 class="success-title">–ì–æ—Ç–æ–≤–æ!</h2>
        <p class="success-text">
          –¢–≤–æ—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø–µ—Å–Ω—è —Å–æ–∑–¥–∞–Ω–∞! –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫ –ø–æ —Ç–≤–æ–∏–º –¥–∞–Ω–Ω—ã–º ‚Äî —Å–ª—É—à–∞–π –∫–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å.
        </p>
        
        <div class="song-preview">
          <h3>üéµ –¢–≤–æ—è –ø–µ—Å–Ω—è</h3>
          <p id="songPreviewText">
            –¢–≤–æ—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞—É–¥–∏–æ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —É–∂–µ –∂–¥—ë—Ç —Ç–µ–±—è –≤ –±–æ—Ç–µ. –°–ª—É—à–∞–π –µ—ë –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å—Å—è –Ω–∞ –≤–æ–ª–Ω—É —É—Å–ø–µ—Ö–∞.
          </p>
        </div>
        
        <button id="openBotBtn" type="button" style="width:100%;padding:13px 24px;border-radius:14px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;margin:16px 0;letter-spacing:0;">
          üí¨ –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞
        </button>
        <p style="font-size:0.82rem;color:rgba(255,255,255,0.5);line-height:1.5;margin:-8px 0 8px;">–ï—Å–ª–∏ –ø–µ—Å–Ω—è –Ω–µ –ø—Ä–∏—à–ª–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 20 –º–∏–Ω—É—Ç ‚Äî –Ω–∞–ø–∏—à–∏ –±–æ—Ç—É ¬´–ø–µ—Å–Ω—è –Ω–µ –ø—Ä–∏—à–ª–∞¬ª. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑ –≤ 10 –º–∏–Ω—É—Ç, –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π.</p>
        
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SOUL CHAT –ë–õ–û–ö ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="soulChatBlock" style="margin-top:24px;">

          <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ: –∑–∞–≥—Ä—É–∑–∫–∞ -->
          <div id="scLoading" style="text-align:center;color:rgba(255,255,255,0.5);font-size:0.9rem;padding:12px 0;">
            ‚ú® –ó–∞–≥—Ä—É–∂–∞—é Soul Chat...
          </div>

          <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ: –ø–æ–¥–∞—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–µ–Ω -->
          <div id="scGiftState" style="display:none;background:linear-gradient(135deg,rgba(212,175,55,0.08),rgba(236,72,153,0.06));border:1px solid rgba(212,175,55,0.3);border-radius:16px;padding:20px;text-align:center;">
            <div style="font-size:2rem;margin-bottom:8px;">üéÅ</div>
            <div style="font-weight:700;font-size:1.05rem;color:#d4af37;margin-bottom:6px;">–ü–æ–¥–∞—Ä–æ–∫ –¥–ª—è —Ç–µ–±—è</div>
            <div style="color:rgba(255,255,255,0.75);font-size:0.9rem;line-height:1.6;margin-bottom:16px;">
              –°—É—Ç–∫–∏ –æ–±—â–µ–Ω–∏—è —Å –¥—É—à–æ–π ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ.<br>–ó–∞–¥–∞–≤–∞–π –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã 24 —á–∞—Å–∞.
            </div>
            <button id="scActivateGiftBtn" type="button" style="padding:13px 24px;border-radius:14px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;width:100%;">
              üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å—É—Ç–∫–∏
            </button>
          </div>

          <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ: –∞–∫—Ç–∏–≤–µ–Ω (—á–∞—Ç) -->
          <div id="scActiveState" style="display:none;">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;">
              <div style="font-weight:700;color:#d4af37;font-size:1rem;">üí¨ Soul Chat</div>
              <div id="scTimer" style="font-size:0.8rem;color:rgba(255,255,255,0.5);background:rgba(255,255,255,0.07);padding:4px 10px;border-radius:20px;"></div>
            </div>
            <!-- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π -->
            <div id="scHistory" style="max-height:260px;overflow-y:auto;margin-bottom:12px;display:flex;flex-direction:column;gap:10px;"></div>
            <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
            <div style="display:flex;flex-direction:column;gap:8px;">
              <textarea id="scQuestion" rows="2" placeholder="–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å —Å–≤–æ–µ–π –¥—É—à–µ..."
                style="width:100%;box-sizing:border-box;padding:12px 14px;border-radius:12px;border:1px solid rgba(212,175,55,0.3);background:rgba(255,255,255,0.06);color:#fff;font-size:0.95rem;font-family:inherit;resize:none;outline:none;line-height:1.5;"></textarea>
              <button id="scSendBtn" type="button" style="padding:13px 24px;border-radius:14px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:0.95rem;font-weight:700;cursor:pointer;font-family:inherit;">
                –°–ø—Ä–æ—Å–∏—Ç—å –¥—É—à—É ‚ú®
              </button>
            </div>
          </div>

          <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ: –Ω—É–∂–Ω–∞ –æ–ø–ª–∞—Ç–∞ -->
          <div id="scPayState" style="display:none;background:rgba(15,12,40,0.7);border:1px solid rgba(212,175,55,0.3);border-radius:16px;padding:20px;text-align:center;">
            <div style="font-size:1.8rem;margin-bottom:8px;">üîí</div>
            <div style="font-weight:700;color:#d4af37;margin-bottom:6px;">Soul Chat</div>
            <div style="color:rgba(255,255,255,0.7);font-size:0.9rem;line-height:1.6;margin-bottom:16px;">
              –ü–æ–¥–∞—Ä–æ—á–Ω—ã–µ —Å—É—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã.<br>–ü—Ä–æ–¥–æ–ª–∂–∏ –æ–±—â–µ–Ω–∏–µ —Å –¥—É—à–æ–π.
            </div>
            <div style="font-size:1.4rem;font-weight:800;color:#d4af37;margin-bottom:16px;">2.99 USDT / —Å—É—Ç–∫–∏</div>
            <button id="scBuyBtn" type="button" style="padding:13px 24px;border-radius:14px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;width:100%;margin-bottom:12px;">
              üí≥ –ö—É–ø–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ —Å—É—Ç–∫–∏
            </button>
          </div>

        </div>
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

        <button class="secondary" id="newKeyBtn" style="margin-top:24px;margin-bottom:4px">–°–æ–∑–¥–∞—Ç—å –µ—â—ë –æ–¥–Ω—É –ø–µ—Å–Ω—é</button>
        <button type="button" class="form-nav-link" onclick="goToProfileFrom('successPage')" style="background:none;border:none;color:rgba(255,255,255,0.3);font-size:0.78rem;cursor:pointer;font-family:inherit;padding:8px 0;width:100%;text-align:center;min-height:unset;box-shadow:none;">–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å</button>
      </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É¬ª (—Ä–µ–¥–∏—Ä–µ–∫—Ç —Å HOT) -->
    <div class="page" id="paymentThanksPage">
      <header class="page-header">
        <h1>YupSoul</h1>
        <div style="font-size:0.78rem;font-weight:400;letter-spacing:0.12em;color:rgba(212,175,55,0.5);margin:2px 0 0;text-transform:uppercase">–ú—É–∑—ã–∫–∞ —Ç–≤–æ–µ–π –¥—É—à–∏</div>
        <div class="subtitle">–∑–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞</div>
      </header>
      <div class="section page-scroll" style="text-align:center; padding-top:40px">
        <div style="width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,rgba(212,175,55,0.2),rgba(212,175,55,0.06));border:1.5px solid rgba(212,175,55,0.35);display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:1.8rem;color:#d4af37;font-weight:300">‚úì</div>
        <h2 class="success-title" style="font-size:1.5rem; margin:0 0 12px 0">–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞</h2>
        <p class="success-text" id="paymentThanksMessage" style="margin:0 0 24px 0; font-size:0.92rem; color:rgba(255,255,255,0.6); line-height:1.65">
          –ü–µ—Å–Ω—è —Å–æ–∑–¥–∞—ë—Ç—Å—è. –ü—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º. –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ.
        </p>
        <button id="paymentThanksBackBtn" class="primary" style="margin-bottom:12px">–°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ø–µ—Å–Ω—é</button>
        <p style="font-size:0.72rem;color:rgba(255,255,255,0.3);line-height:1.5;margin:0;">–ù–µ –ø—Ä–∏—à–ª–∞ –∑–∞ 20 –º–∏–Ω—É—Ç? –ù–∞–ø–∏—à–∏ –±–æ—Ç—É ¬´–ø–µ—Å–Ω—è –Ω–µ –ø—Ä–∏—à–ª–∞¬ª</p>
      </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var tg = null;
      var INIT_DATA_STORAGE_KEY = 'tg_init_data';
      var LANG_STORAGE_KEY = 'yupsoul_lang';
      var BOT_USERNAME = 'Yup_Soul_bot'; // –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –∏–º–µ–Ω–∏ –±–æ—Ç–∞
      var LANG = {
        ru: {
          tagline: '–ò—Å—Å–ª–µ–¥—É–π —Å–≤–æ–∏ –≥—Ä–∞–Ω–∏ —Ç–∞–∫, –∫–∞–∫ —Ç—ã —ç—Ç–æ–≥–æ –∑–∞—Ö–æ—á–µ—à—å',
          startBtn: '–°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ø–µ—Å–Ω—é', myProfile: 'üë§ –ü—Ä–æ—Ñ–∏–ª—å', myHeroes: '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è', admin: 'üëë –ê–¥–º–∏–Ω–∫–∞',
          profileTitle: '–ü—Ä–æ—Ñ–∏–ª—å', profileSubtitle: '–¢–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏',
          profileFreeCredits: '–ë–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π', profileInviteFriend: '–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞', profileShare: '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è',
          profileInvited: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ', profileActivated: '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ', profileCreateSong: '–°–æ–∑–¥–∞—Ç—å –ø–µ—Å–Ω—é',
          heroesTitle: '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è', heroesSubtitle: '–ö–∞—Ä—Ç–æ—Ç–µ–∫–∞ –ª—é–¥–µ–π',
          searchByName: '–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏', searchPlaceholder: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è...', searchBtn: '–ò—Å–∫–∞—Ç—å',
          addHero: '‚ûï –î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è', heroName: '–ò–º—è *', heroBirthdate: '–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è', heroBirthtime: '–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è',
          heroBirthplace: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è', heroBirthplacePh: '–ì–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞', heroNotes: '–î–æ—Å—å–µ / –∑–∞–º–µ—Ç–∫–∏', heroNotesPh: '–ó–∞–º–µ—Ç–∫–∏ –æ –∫–ª–∏–µ–Ω—Ç–µ',
          unknownTime: '–ù–µ –∑–Ω–∞—é —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è', cancel: '–û—Ç–º–µ–Ω–∞', save: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å', back: '‚Üê –ù–∞–∑–∞–¥',
          gender: '–ü–æ–ª', genderSelect: '–í—ã–±–µ—Ä–∏', male: '–ú—É–∂—Å–∫–æ–π', female: '–ñ–µ–Ω—Å–∫–∏–π', other: '–î—Ä—É–≥–æ–π',
          modeType: '–§–æ—Ä–º–∞—Ç –ø–µ—Å–Ω–∏', modeSubtitle: '–î–ª—è –∫–æ–≥–æ —Å–æ–∑–¥–∞—ë–º?',
          modeSingle: '–û–±–æ –º–Ω–µ', modeSingleDesc: '–ü–µ—Å–Ω—è –ø–æ —Ç–≤–æ–µ–π –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è',
          modeCouple: '–ü—Ä–æ –¥–≤–æ–∏—Ö', modeCoupleDesc: '–ü–µ—Å–Ω—è –¥–ª—è –¥–≤—É—Ö –ª—é–¥–µ–π',
          modeTransit: '–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞', modeTransitDesc: '–ü–µ—Å–Ω—è –æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º –¥–Ω–µ',
          namePh: '–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?', birthdateLabel: '–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è', birthplacePh: '–ì–æ—Ä–æ–¥ –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∞ ‚Äî –≤—ã–±–µ—Ä–∏ –∏–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫',
          birthplaceHint: '–ù–∞—á–Ω–∏ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥ –∏ –≤—ã–±–µ—Ä–∏ –∏–∑ –≤—ã–ø–∞–≤—à–µ–≥–æ —Å–ø–∏—Å–∫–∞.',
          unknownTimeShort: '–ù–µ –∑–Ω–∞—é', secondPersonTitle: '–î–ª—è –¥–≤–æ–∏—Ö', name2Ph: '–ò–º—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
          birthplace2Ph: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ', birthtime2Ph: '–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è',
          transitTitle: '–≠–Ω–µ—Ä–≥–∏—è –º–æ–º–µ–Ω—Ç–∞', transitDatePh: '–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è', transitTimePh: '–í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è',
          transitLocationPh: '–ì–æ—Ä–æ–¥ –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –º–æ–º–µ–Ω—Ç–∞', transitLocationOk: '–õ–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ',
          transitIntentPh: '–ù–∞–º–µ—Ä–µ–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)',
          sendRequest: '–û—Ç–ø—Ä–∞–≤—å –∑–∞–ø—Ä–æ—Å', quickRequests: '–ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã', hide: '–°–∫—Ä—ã—Ç—å',
          requestPh: '–ö–∞–∫—É—é –≥—Ä–∞–Ω—å –±—É–¥–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è?', toPayment: '–ö –æ–ø–ª–∞—Ç–µ',
          paymentSubtitle: '–¢–≤–æ—è –ø–µ—Å–Ω—è', paymentAndAccess: '–û–ø–ª–∞—Ç–∞ –∏ –¥–æ—Å—Ç—É–ø',
          paymentIntro: '–ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è ‚Äî –≤ –ø–æ–¥–∞—Ä–æ–∫. –î–∞–ª—å—à–µ –º–æ–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–ª–∏ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø.',
          loadingPricing: '–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤...', currentItem: '–¢–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç',
          promoCode: '–ü—Ä–æ–º–æ–∫–æ–¥', apply: '–ü—Ä–∏–º–µ–Ω–∏—Ç—å', backFromPayment: '‚Üê –ù–∞–∑–∞–¥',
          submitAndContinue: '–û—Ñ–æ—Ä–º–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å', submitRequest: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É',
          submitHint: '–ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç —Å –±–æ—Ç–æ–º. –ï—Å–ª–∏ –≤—ã –µ—â—ë –Ω–µ –Ω–∞–∂–∏–º–∞–ª–∏ ¬´–°—Ç–∞—Ä—Ç¬ª –≤ –±–æ—Ç–µ ‚Äî –Ω–∞–∂–º–∏—Ç–µ –µ–≥–æ —Å–µ–π—á–∞—Å.',
          paymentPageIntroAfterSubmit: '–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ HOT Pay.',
          paymentPageIntroOrPay: '–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥, –∏–ª–∏ –æ–ø–ª–∞—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ HOT Pay.',
          paymentPageTagline: '–ü—Ä–æ–º–æ–∫–æ–¥ –∏–ª–∏ –æ–ø–ª–∞—Ç–∞',
          payWithHot: '–û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ HOT Pay',
          firstFree: '–ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è –¥–æ—Å—Ç—É–ø–Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ.',
          paymentRequired: '–û–ø–ª–∞—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫.',
          subscriptionActive: '–£ –≤–∞—Å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å.',
          catalogLoadFailed: '–¢–∞—Ä–∏—Ñ—ã –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å. –ù–∞–∂–º–∏—Ç–µ ¬´–û—Ñ–æ—Ä–º–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å¬ª ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –±—ç–∫–µ–Ω–¥.',
          promoApplied: '–ü—Ä–æ–º–æ–∫–æ–¥ {code}: -{amount} {currency}',
          creatingKey: '–°–æ–∑–¥–∞—é —Ç–≤–æ—é –ø–µ—Å–Ω—é...',
          creatingKeyDesc: '–ú–∞–≥–∏—è —Ç–≤–æ—Ä–∏—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –¢–≤–æ—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø–µ—Å–Ω—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö.',
          keyActivated: '–ü–µ—Å–Ω—è —Å–æ–∑–¥–∞–Ω–∞!', done: '–ì–æ—Ç–æ–≤–æ!',
          successText: '–¢–≤–æ—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø–µ—Å–Ω—è —Å–æ–∑–¥–∞–Ω–∞! –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫ –ø–æ —Ç–≤–æ–∏–º –¥–∞–Ω–Ω—ã–º ‚Äî —Å–ª—É—à–∞–π –∫–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å.',
          yourSong: 'üéµ –¢–≤–æ—è –ø–µ—Å–Ω—è',
          songPreviewText: '–¢–≤–æ—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞—É–¥–∏–æ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —É–∂–µ –∂–¥—ë—Ç —Ç–µ–±—è –≤ –±–æ—Ç–µ. –°–ª—É—à–∞–π –µ—ë –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å—Å—è –Ω–∞ –≤–æ–ª–Ω—É —É—Å–ø–µ—Ö–∞.',
          whatNext: '–ß—Ç–æ –¥–∞–ª—å—à–µ:', openBot: '–û—Ç–∫—Ä–æ–π –±–æ—Ç–∞',
          soulChat: '–ü–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å –¥—É—à–æ–π', soulChatPay: '–ö –æ–ø–ª–∞—Ç–µ ‚Äî Soul Basic / Soul Plus',
          newKey: '–°–æ–∑–¥–∞—Ç—å –µ—â—ë –æ–¥–Ω—É –ø–µ—Å–Ω—é',
          paymentThanks: '–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É', thanksSubtitle: '–∑–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞',
          songInProgress: '–ü–µ—Å–Ω—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç —Å –±–æ—Ç–æ–º. –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç. –°–ø–∞—Å–∏–±–æ ‚ù§Ô∏è',
          songInProgressConfirmed: '–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞. –ü–µ—Å–Ω—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –Ω–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ ‚Äî –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞, –ø—Ä–∏–¥—ë—Ç —Å—é–¥–∞ –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º. –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –æ—Å—Ç–∞—ë—à—å—Å—è —Å –Ω–∞–º–∏ ‚ù§Ô∏è',
          thanksDone: '–ì–æ—Ç–æ–≤–æ',
          notFromTelegram: '–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º –≤ Telegram (–∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é) ‚Äî –∏–Ω–∞—á–µ –∑–∞—è–≤–∫–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è.',
          notFound: '–ù–µ –Ω–∞–π–¥–µ–Ω–æ', searchError: '–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞',
          soulChatLoad: '–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶',
          soulChatHasAccess: '–£ —Ç–µ–±—è –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ Soul Chat. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –±–æ—Ç. –í –±–æ—Ç–µ –Ω–∞–ø–∏—à–∏ /soulchat –∏ –∑–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å —Å–≤–æ–µ–π –¥—É—à–µ.',
          soulChatNoAccess: 'Soul Chat ‚Äî –¥–∏–∞–ª–æ–≥–∏ —Å –¥—É—à–æ–π. –î–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ Soul Basic (10 –¥–∏–∞–ª–æ–≥–æ–≤/–º–µ—Å) –∏–ª–∏ Soul Plus (30 –¥–∏–∞–ª–æ–≥–æ–≤/–º–µ—Å).',
          soulChatDefault: 'Soul Chat ‚Äî –¥–∏–∞–ª–æ–≥–∏ —Å –¥—É—à–æ–π –ø–æ –∑–∞—è–≤–∫–µ. –î–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ.',
          soulChatNoApi: 'Soul Chat ‚Äî –¥–∏–∞–ª–æ–≥–∏ —Å –¥—É—à–æ–π –ø–æ –∑–∞—è–≤–∫–µ. –î–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ Soul Basic –∏–ª–∏ Soul Plus. –û—Ñ–æ—Ä–º–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: ¬´–ö –æ–ø–ª–∞—Ç–µ¬ª.',
          greeting: '–ü—Ä–∏–≤–µ—Ç, {name}! üëã',
          greetingDefault: '–ú—É–∑—ã–∫–∞ —Ç–≤–æ–µ–π –¥—É—à–∏',
          onboardingSlide1Title: '–ï—Å—Ç—å –ø–µ—Å–Ω—è ‚Äî –æ —Ç–µ–±–µ',
          onboardingSlide1Text: '–ù–∞–ø–∏—Å–∞–Ω–Ω–∞—è –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è. –ù–µ —à–∞–±–ª–æ–Ω ‚Äî –∂–∏–≤–æ–π —Ç–µ–∫—Å—Ç –æ —Ç–≤–æ—ë–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ, —Å–∏–ª–µ –∏ –ø—É—Ç–∏.',
          onboardingSlide2Title: '–¢–æ–ª—å–∫–æ –æ —Ç–µ–±–µ',
          onboardingSlide2Text: '–ö–∞–∂–¥–∞—è ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–∞. –ï—ë –±–æ–ª—å—à–µ –Ω–µ—Ç –Ω–∏ —É –∫–æ–≥–æ. –ù–∏ –æ–¥–Ω–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è.',
          onboardingSlide3Title: '–ü–µ—Ä–≤–∞—è ‚Äî –≤ –ø–æ–¥–∞—Ä–æ–∫',
          onboardingSlide3Text: '–í–≤–µ–¥–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äî –∏ –ø–æ–ª—É—á–∏ —Å–≤–æ—é –ø–µ—Å–Ω—é –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º.',
          onboardingBtnStart: '–ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ—é –ø–µ—Å–Ω—é',
          obGiftLine1: 'üéÅ –ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ',
          obGiftLine2: '–ü—Ä–∏–≤–µ–¥–∏ 5 –¥—Ä—É–∑–µ–π ‚Äî –ø–æ–ª—É—á–∏ –ø–µ—Å–Ω—é –≤ –ø–æ–¥–∞—Ä–æ–∫',
          alertNameShort: '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞', alertBirthdate: '–í—ã–±–µ—Ä–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è',
          alertBirthplace: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞', alertBirthplaceHint: '–í—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫',
          alertBirthtime: '–£–∫–∞–∂–∏ –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–º–µ—Ç—å "–ù–µ –∑–Ω–∞—é"', alertGender: '–£–∫–∞–∂–∏ –ø–æ–ª', alertLanguage: '–í—ã–±–µ—Ä–∏ —è–∑—ã–∫',
          alertName2Short: '–ò–º—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ ‚Äî –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞', alertBirthdate2: '–£–∫–∞–∂–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
          alertBirthplace2: '–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞',
          alertBirthtime2: '–£–∫–∞–∂–∏ –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞', alertGender2: '–í—ã–±–µ—Ä–∏ –ø–æ–ª –≤—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
          alertTransitDate: '–£–∫–∞–∂–∏ –¥–∞—Ç—É —Å–æ–±—ã—Ç–∏—è', alertTransitLocation: '–£–∫–∞–∂–∏ –ª–æ–∫–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏—è', alertTransitConfirm: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏, —á—Ç–æ –ª–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ',
          alertRequestShort: '–î–æ–±–∞–≤—å –∑–∞–ø—Ä–æ—Å (5+ —Å–∏–º–≤–æ–ª–æ–≤)', alertRequestLong: '–†–∞—Å—Å–∫–∞–∂–∏ –í—Å–µ–ª–µ–Ω–Ω–æ–π –ø–æ–¥—Ä–æ–±–Ω–µ–µ (–º–∏–Ω–∏–º—É–º 15 —Å–∏–º–≤–æ–ª–æ–≤)',
          alertYourPath: '–í—ã–±–µ—Ä–∏ —Å–≤–æ–π –ø—É—Ç—å', alertNoApi: '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–¥—Ä–µ—Å API.', alertOpenFromBot: '–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º –≤ Telegram ‚Äî –∏–Ω–∞—á–µ –∑–∞—è–≤–∫—É –Ω–µ–ª—å–∑—è –ø—Ä–∏–Ω—è—Ç—å.',
          alertServerSleep: '–°–µ—Ä–≤–µ—Ä –ø—Ä–æ—Å–Ω—É–ª—Å—è –Ω–µ —Å—Ä–∞–∑—É. –ü–æ–¥–æ–∂–¥–∏ –æ–∫–æ–ª–æ –º–∏–Ω—É—Ç—ã –∏ –Ω–∞–∂–º–∏ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É¬ª —Å–Ω–æ–≤–∞.',
          sending: '–û—Ç–ø—Ä–∞–≤–ª—è—é‚Ä¶',
          universeHeard: '‚ú® {name}, –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å.\n\n–¢–≤–æ—è –ø–µ—Å–Ω—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏ –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞.',
          universeHeardCouple: '‚ú® {name} –∏ {name2}, –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ –≤–∞—à –∑–∞–ø—Ä–æ—Å.\n\n–í–∞—à–∞ –ø–µ—Å–Ω—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏ –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞.',
          universeHeardTransit: '‚ú® {name}, –í—Å–µ–ª–µ–Ω–Ω–∞—è —É—Å–ª—ã—à–∞–ª–∞ —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å.\n\n–ü–µ—Å–Ω—è ¬´–≠–Ω–µ—Ä–≥–∏—è –î–Ω—è¬ª —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏ –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞.',
          langSong: '–Ø–∑—ã–∫ –ø–µ—Å–Ω–∏', langRu: '–†—É—Å—Å–∫–∏–π', langEn: 'English', langDe: 'Deutsch', langFr: 'Fran√ßais', langUk: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞',
          quick1: '–ì–∞—Ä–º–æ–Ω–∏—è –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ', quick2: '–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ', quick3: '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª', quick4: '–û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ',
          quick5: '–ë–∞–ª–∞–Ω—Å –∂–∏–∑–Ω–∏', quick6: '–î–æ–≤–µ—Ä–∏–µ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ', quick7: '–ò—Å—Ü–µ–ª–µ–Ω–∏–µ –∏ —Å–≤–æ–±–æ–¥–∞', quick8: '–ü—É—Ç—å –∫ —Å—á–∞—Å—Ç—å—é',
          quick9: '–°–∏–ª–∞ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ', quick10: '–ì–ª—É–±–∏–Ω–∞ –∏ —Ç–∏—à–∏–Ω–∞', quick11: '–ù–µ–∂–Ω–æ—Å—Ç—å –∏ –∑–∞–±–æ—Ç–∞', quick12: '–Æ–º–æ—Ä –∏ –ª—ë–≥–∫–æ—Å—Ç—å',
          quick1t: '–ì–∞—Ä–º–æ–Ω–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ –ª—é–±–æ–≤—å –∫ —Å–µ–±–µ', quick2t: '–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –æ–ø–æ—Ä–∞ –Ω–∞ —Å–µ–±—è',
          quick3t: '–†–∞—Å–∫—Ä—ã—Ç—å —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –±–µ–∑ —Å—Ç—Ä–∞—Ö–∞', quick4t: '–û—Ç–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ –∏ –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
          quick5t: '–ë–∞–ª–∞–Ω—Å —Ä–∞–±–æ—Ç—ã –∏ –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏', quick6t: '–î–æ–≤–µ—Ä—è—Ç—å –∂–∏–∑–Ω–∏ –∏ –æ—Ç–ø—É—Å–∫–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å',
          quick7t: '–ò—Å—Ü–µ–ª–∏—Ç—å –¥–µ—Ç—Å–∫–∏–µ —Ç—Ä–∞–≤–º—ã –∏ –æ–±—Ä–µ—Å—Ç–∏ —Å–≤–æ–±–æ–¥—É', quick8t: '–ù–∞–π—Ç–∏ —Å–≤–æ–π –ø—É—Ç—å –∫ —Å—á–∞—Å—Ç—å—é –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—é',
          quick9t: '–ú–æ—â–Ω–∞—è –ø–µ—Å–Ω—è –æ –º–æ–µ–π —Å–∏–ª–µ –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–∏', quick10t: '–ú–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è –ø–µ—Å–Ω—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ –∏—Å—Ü–µ–ª–µ–Ω–∏—è',
          quick11t: '–¢—ë–ø–ª–∞—è –ø–µ—Å–Ω—è –æ –∑–∞–±–æ—Ç–µ –∏ –Ω–µ–∂–Ω–æ—Å—Ç–∏', quick12t: '–í–µ—Å—ë–ª–∞—è –ø–µ—Å–Ω—è —Å —Å–∞–º–æ–∏—Ä–æ–Ω–∏–µ–π –ø—Ä–æ –º–æ–∏ —Å–ª–∞–±–æ—Å—Ç–∏',
          promoError: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥',
          promoCleared: '–ü—Ä–æ–º–æ–∫–æ–¥ –æ—á–∏—â–µ–Ω.', promoApplied: '–ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω: –∏—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ {amount} {currency}',
          promoAppliedHint: '–ü—Ä–æ–º–æ–∫–æ–¥ {code}: -{amount} {currency}',
          paymentRequiredOpening: '–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞. –û—Ç–∫—Ä—ã–≤–∞—é HOT Checkout...',
          promoFreeGen: '–ü—Ä–æ–º–æ–∫–æ–¥ –¥–∞–ª –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é. –ó–∞–ø—É—Å–∫...',
          hotCheckoutOpened: '–û—Ç–∫—Ä—ã—Ç HOT Checkout. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –≤–µ—Ä–Ω–∏—Å—å –≤ Mini App ‚Äî —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.',
          paymentNotConfirmed: '–û–ø–ª–∞—Ç–∞ –ø–æ–∫–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å –ø–æ–∑–∂–µ –∏–ª–∏ –æ—Ç–∫—Ä–æ–π –æ–ø–ª–∞—Ç—É –ø–æ–≤—Ç–æ—Ä–Ω–æ.',
          paymentConfirmed: '–û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ó–∞–ø—É—Å–∫–∞—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...',
          paymentReceivedNoStart: '–û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞, –Ω–æ –∞–≤—Ç–æ‚Äë—Å—Ç–∞—Ä—Ç –Ω–µ —É–¥–∞–ª—Å—è. –ó–∞–ø—É—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤ –∞–¥–º–∏–Ω–∫–µ –ø–æ request_id: {id}',
          submitFailed: '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É. –ü–æ–¥–æ–∂–¥–∏ –º–∏–Ω—É—Ç—É –∏ –Ω–∞–∂–º–∏ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É¬ª —Å–Ω–æ–≤–∞ –∏–ª–∏ –æ—Ç–∫—Ä–æ–π Mini App –∑–∞–Ω–æ–≤–æ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º.',
          errorOp: '–û—à–∏–±–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–ø–ª–∞—Ç—ã/–∑–∞—è–≤–∫–∏',
          alertTransitLocation: '–£–∫–∞–∂–∏ –ª–æ–∫–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏—è', alertTransitConfirm: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏, —á—Ç–æ –ª–æ–∫–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ',
          alertNoApi: '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–¥—Ä–µ—Å API.', alertOpenFromBot: '–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º –≤ Telegram ‚Äî –∏–Ω–∞—á–µ –∑–∞—è–≤–∫—É –Ω–µ–ª—å–∑—è –ø—Ä–∏–Ω—è—Ç—å.',
          alertOpenFromBotShort: '–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ —Å –±–æ—Ç–æ–º –≤ Telegram.',
          alertPaymentFirst: '–°–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–º–∏—Ç–µ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É¬ª –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ.',
          alertLinkCopied: '‚úì –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞. –í—Å—Ç–∞–≤—å—Ç–µ –µ—ë –≤ Safari –∏–ª–∏ Chrome –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ.',
          alertHeroName: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è', alertError: '–û—à–∏–±–∫–∞', alertDeleteConfirm: '–£–¥–∞–ª–∏—Ç—å ¬´{name}¬ª? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.',
          alertSubmitError: '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ',
          copyLinkPrompt: '–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç—É —Å—Å—ã–ª–∫—É –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:',
          songFormingText: '–¢–≤–æ—è –ø–µ—Å–Ω—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏ –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞.',
          heroesLoading: '–ó–∞–≥—Ä—É–∑–∫–∞...', heroesEmpty: '–ü–æ–∫–∞ –Ω–µ—Ç –≥–µ—Ä–æ–µ–≤. –ù–∞–∂–º–∏ ¬´–î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è¬ª.',
          heroesLoadError: '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É API.',
          forMyself: '–î–ª—è —Å–µ–±—è', forHero: '–î–ª—è: {name}',
          previewHome: '–ì–ª–∞–≤–Ω–∞—è', previewForm: '–§–æ—Ä–º–∞', previewPayment: '–û–ø–ª–∞—Ç–∞', previewLoading: '–ó–∞–≥—Ä—É–∑–∫–∞', previewSuccess: '–£—Å–ø–µ—Ö'
        },
        en: {
          tagline: 'Explore your edges the way you want',
          startBtn: 'Create My Song', myProfile: 'üë§ Profile', myHeroes: 'Lab', admin: 'üëë Admin',
          profileTitle: 'Profile', profileSubtitle: 'Your data and free generations',
          profileFreeCredits: 'Free generations', profileInviteFriend: 'Invite a friend', profileShare: 'Share',
          profileInvited: 'Invited', profileActivated: 'Activated', profileCreateSong: 'Create song',
          heroesTitle: 'Laboratory', heroesSubtitle: 'People directory',
          searchByName: 'Search by name', searchPlaceholder: 'Enter name...', searchBtn: 'Search',
          addHero: '‚ûï Add Hero', heroName: 'Name *', heroBirthdate: 'Date of birth', heroBirthtime: 'Time of birth',
          heroBirthplace: 'Place of birth', heroBirthplacePh: 'City, country', heroNotes: 'Notes', heroNotesPh: 'Client notes',
          unknownTime: "I don't know exact time", cancel: 'Cancel', save: 'Save', back: '‚Üê Back',
          gender: 'Gender', genderSelect: 'Choose', male: 'Male', female: 'Female', other: 'Other',
          modeType: 'Song format', modeSubtitle: 'Who is it for?',
          modeSingle: 'About me', modeSingleDesc: 'A song by your date of birth',
          modeCouple: 'About us', modeCoupleDesc: 'A song for two people',
          modeTransit: 'This moment', modeTransitDesc: "A song about today",
          namePh: "What's your name?", birthdateLabel: 'Date of birth', birthplacePh: 'City or country ‚Äî choose from suggestions',
          birthplaceHint: 'Start typing your city and pick from the list.',
          unknownTimeShort: "Don't know", secondPersonTitle: 'For two', name2Ph: "Second person's name",
          birthplace2Ph: "Second person's place of birth", birthtime2Ph: 'Time of birth',
          transitTitle: 'Energy of the moment', transitDatePh: 'Event date', transitTimePh: 'Event time',
          transitLocationPh: 'City for the moment energy', transitLocationOk: 'Location is correct',
          transitIntentPh: 'Intention for this moment (optional)',
          sendRequest: 'Send request', quickRequests: 'Quick requests', hide: 'Hide',
          requestPh: 'What would you like to explore today?', toPayment: 'To payment',
          paymentSubtitle: 'Your sound key', paymentAndAccess: 'Payment & access',
          paymentIntro: 'First song is free. You can pay for individual items or subscribe for full access.',
          loadingPricing: 'Loading plans...', currentItem: 'Current item',
          promoCode: 'Promo code', apply: 'Apply', backFromPayment: '‚Üê Back',
          submitAndContinue: 'Checkout & continue', submitRequest: 'Submit request',
          submitHint: 'The song will arrive in this chat with the bot. If you haven\'t pressed ¬´Start¬ª in the bot yet ‚Äî do it now.',
          paymentPageIntroAfterSubmit: 'Request submitted. Enter a promo code or tap the button below to pay via HOT Pay.',
          paymentPageTagline: 'Promo code or payment',
          payWithHot: 'Pay via HOT Pay',
          firstFree: 'Your first sound key is free.',
          paymentRequired: 'Payment required for new requests.',
          subscriptionActive: 'You have an active subscription ‚Äî continue.',
          catalogLoadFailed: 'Pricing failed to load. Press ¬´Continue¬ª ‚Äî backend will determine cost.',
          promoApplied: 'Promo {code}: -{amount} {currency}',
          creatingKey: 'Creating your key...',
          creatingKeyDesc: 'Magic happens in real time. Your personal sound key is being formed from your unique data.',
          keyActivated: 'Key activated!', done: 'Done!',
          successText: 'Your personal sound key is created! Your unique artifact of strength for the game of life.',
          yourSong: 'üéµ Your song',
          songPreviewText: 'Your unique audio piece is waiting for you in the bot. Listen every morning to tune into success.',
          whatNext: 'What next:', openBot: 'Open the bot',
          soulChat: 'Talk to your soul', soulChatPay: 'To payment ‚Äî Soul Basic / Soul Plus',
          newKey: 'Create another key',
          paymentThanks: 'Thank you for payment', thanksSubtitle: 'request accepted',
          songInProgress: 'Song is being generated and will arrive in the bot chat when ready.',
          songInProgressConfirmed: 'Request accepted. Song is being generated ‚Äî no need to pay again. It will arrive in the bot chat when ready.',
          thanksDone: 'Done',
          notFromTelegram: 'Open the app from the bot chat in Telegram (menu button) ‚Äî otherwise the request cannot be sent.',
          notFound: 'Not found', searchError: 'Search error',
          soulChatLoad: 'Loading‚Ä¶',
          soulChatHasAccess: "You have Soul Chat access. Tap below ‚Äî the bot will open. In the bot, type /soulchat and ask your soul a question.",
          soulChatNoAccess: 'Soul Chat ‚Äî dialogues with your soul. Available with Soul Basic (10/month) or Soul Plus (30/month) subscription.',
          soulChatDefault: 'Soul Chat ‚Äî dialogues with your soul per request. Available by subscription.',
          soulChatNoApi: 'Soul Chat ‚Äî dialogues with your soul. Available with Soul Basic or Soul Plus subscription. Go to ¬´To payment¬ª in the app.',
          greeting: "Hi, {name}! Come back whenever you want to remember who you are.",
          greetingDefault: "Come back whenever you want to remember who you are.",
          onboardingSlide1Title: 'There is a song ‚Äî about you',
          onboardingSlide1Text: 'Written from your date of birth. Not a template ‚Äî a real text about your character, strength and path.',
          onboardingSlide2Title: 'Only about you',
          onboardingSlide2Text: 'A smart analysis of your personality becomes a living song ‚Äî unique, only yours.',
          onboardingSlide3Title: 'First one ‚Äî as a gift',
          onboardingSlide3Text: 'Enter your date of birth. Your song will arrive right here in chat.',
          onboardingBtnStart: 'Get my song',
          obGiftLine1: 'üéÅ First song ‚Äî free',
          obGiftLine2: 'Invite 5 friends ‚Äî get a song as a gift',
          alertNameShort: 'Name must be at least 2 characters', alertBirthdate: 'Choose date of birth',
          alertBirthplace: 'Place of birth must be at least 3 characters', alertBirthplaceHint: 'Pick a location from the suggestions',
          alertBirthtime: 'Enter time of birth or check "Don\'t know"', alertGender: 'Select gender', alertLanguage: 'Choose language',
          alertName2Short: "Second person's name ‚Äî at least 2 characters", alertBirthdate2: "Enter second person's date of birth",
          alertBirthplace2: "Second person's place of birth must be at least 3 characters",
          alertBirthtime2: "Enter second person's time of birth", alertGender2: "Select second person's gender",
          alertTransitDate: 'Enter event date', alertTransitLocation: 'Enter event location', alertTransitConfirm: 'Confirm the location is correct',
          alertRequestShort: 'Add a request (5+ characters)', alertRequestLong: 'Tell the Universe more (at least 15 characters)',
          alertYourPath: 'Choose your path', alertNoApi: 'API address not configured.', alertOpenFromBot: 'Open the app from the bot chat in Telegram ‚Äî otherwise the request cannot be accepted.',
          alertServerSleep: 'Server was slow to wake up. Wait about a minute and tap ¬´Submit request¬ª again.',
          sending: 'Sending‚Ä¶',
          universeHeard: '‚ú® {name}, the Universe heard your request.\n\nYour sound key is being created and will arrive in this chat when ready.',
          universeHeardCouple: '‚ú® {name} and {name2}, the Universe heard your request.\n\nYour sound key is being created and will arrive in this chat when ready.',
          universeHeardTransit: '‚ú® {name}, the Universe heard your request.\n\nYour Day Energy sound key is being created and will arrive in this chat when ready.',
          langSong: 'Song language', langRu: 'Russian', langEn: 'English', langDe: 'German', langFr: 'French', langUk: 'Ukrainian',
          quick1: 'Harmony and self-love', quick2: 'Confidence and purpose', quick3: 'Creative potential', quick4: 'Let go of the past',
          quick5: 'Life balance', quick6: 'Trust and acceptance', quick7: 'Healing and freedom', quick8: 'Path to happiness',
          quick9: 'Strength and overcoming', quick10: 'Depth and silence', quick11: 'Tenderness and care', quick12: 'Humor and lightness',
          quick1t: 'Harmony in relationships and self-love', quick2t: 'Confidence, purpose, and self-reliance',
          quick3t: 'Unlock creative potential without fear', quick4t: 'Let go of the past and open to new possibilities',
          quick5t: 'Balance of work and personal life', quick6t: 'Trust life and release control',
          quick7t: 'Heal childhood wounds and find freedom', quick8t: 'Find your path to happiness and peace',
          quick9t: 'Powerful song about my strength and overcoming', quick10t: 'Meditative song for practice and healing',
          quick11t: 'Warm song about care and tenderness', quick12t: 'Playful song with self-irony about my quirks',
          promoError: 'Could not apply promo code',
          promoCleared: 'Promo code cleared.', promoApplied: 'Promo applied: final amount {amount} {currency}',
          promoAppliedHint: 'Promo {code}: -{amount} {currency}',
          paymentRequiredOpening: 'Payment required. Opening HOT Checkout...',
          promoFreeGen: 'Promo gives free generation. Starting...',
          hotCheckoutOpened: 'HOT Checkout opened. After payment, return to the Mini App ‚Äî status will update automatically.',
          paymentNotConfirmed: 'Payment not yet confirmed. Check status later or open payment again.',
          paymentConfirmed: 'Payment confirmed. Starting generation...',
          paymentReceivedNoStart: 'Payment received, but auto-start failed. Start generation in admin by request_id: {id}',
          submitFailed: 'Could not submit request. Wait a minute and tap ¬´Submit request¬ª again or reopen the Mini App from the bot chat.',
          errorOp: 'Payment/request operation error',
          alertTransitLocation: 'Enter event location', alertTransitConfirm: 'Confirm the location is correct',
          alertNoApi: 'API address not configured.', alertOpenFromBot: 'Open the app from the bot chat in Telegram ‚Äî otherwise the request cannot be accepted.',
          alertOpenFromBotShort: 'Open the app from the bot chat in Telegram.',
          alertPaymentFirst: 'First tap ¬´Submit request¬ª on the previous step.',
          alertLinkCopied: '‚úì Link copied. Paste it in Safari or Chrome and open.',
          alertHeroName: 'Enter name', alertError: 'Error', alertDeleteConfirm: 'Delete ¬´{name}¬ª? This action cannot be undone.',
          alertSubmitError: 'Submit error',
          copyLinkPrompt: 'Copy this link and open it in browser:',
          songFormingText: 'Your sound key is being created and will arrive in this chat when ready.',
          heroesLoading: 'Loading...', heroesEmpty: 'No heroes yet. Tap ¬´Add Hero¬ª.',
          heroesLoadError: 'Failed to load list. Check API settings.',
          forMyself: 'For myself', forHero: 'For: {name}',
          previewHome: 'Home', previewForm: 'Form', previewPayment: 'Payment', previewLoading: 'Loading', previewSuccess: 'Success'
        },
        de: {
          tagline: 'Erkunde deine Facetten, wie du es m√∂chtest',
          startBtn: 'Mein Lied erschaffen', myProfile: 'üë§ Profil', myHeroes: 'Labor', admin: 'üëë Admin',
          profileTitle: 'Profil', profileSubtitle: 'Deine Daten und kostenlose Generierungen',
          profileFreeCredits: 'Kostenlose Generierungen', profileInviteFriend: 'Freund einladen', profileShare: 'Teilen',
          profileInvited: 'Eingeladen', profileActivated: 'Aktiviert', profileCreateSong: 'Lied erstellen',
          heroesTitle: 'Labor', heroesSubtitle: 'Personen-Kartei',
          searchByName: 'Suche nach Name', searchPlaceholder: 'Name eingeben...', searchBtn: 'Suchen',
          addHero: '‚ûï Held hinzuf√ºgen', heroName: 'Name *', heroBirthdate: 'Geburtsdatum', heroBirthtime: 'Geburtszeit',
          heroBirthplace: 'Geburtsort', heroBirthplacePh: 'Stadt, Land', heroNotes: 'Notizen', heroNotesPh: 'Klientennotizen',
          unknownTime: 'Exakte Zeit unbekannt', cancel: 'Abbrechen', save: 'Speichern', back: '‚Üê Zur√ºck',
          gender: 'Geschlecht', genderSelect: 'W√§hlen', male: 'M√§nnlich', female: 'Weiblich', other: 'Divers',
          modeType: 'Song-Format', modeSubtitle: 'F√ºr wen erstellen wir?',
          modeSingle: '√úber mich', modeSingleDesc: 'Ein Lied nach deinem Geburtsdatum.',
          modeCouple: '√úber uns zwei', modeCoupleDesc: 'Ein Lied f√ºr zwei Menschen.',
          modeTransit: 'Energie des Moments', modeTransitDesc: 'Ein Lied √ºber den heutigen Tag.',
          namePh: 'Wie hei√üt du?', birthdateLabel: 'Geburtsdatum', birthplacePh: 'Stadt oder Land ‚Äî w√§hle aus den Vorschl√§gen',
          birthplaceHint: 'Stadt eintippen und aus der Liste ausw√§hlen.',
          unknownTimeShort: 'Unbekannt', secondPersonTitle: 'Zu zweit', name2Ph: 'Name der zweiten Person',
          birthplace2Ph: 'Geburtsort der zweiten Person', birthtime2Ph: 'Geburtszeit',
          transitTitle: 'Energie des Augenblicks', transitDatePh: 'Ereignisdatum', transitTimePh: 'Ereigniszeit',
          transitLocationPh: 'Stadt f√ºr die Momentenergie', transitLocationOk: 'Ort ist korrekt',
          transitIntentPh: 'Absicht f√ºr diesen Moment (optional)',
          sendRequest: 'Anfrage senden', quickRequests: 'Schnellanfragen', hide: 'Ausblenden',
          requestPh: 'Was m√∂chtest du heute erkunden?', toPayment: 'Zur Kasse',
          paymentSubtitle: 'Dein Klangschl√ºssel', paymentAndAccess: 'Zahlung & Zugang',
          paymentIntro: 'Das erste Lied ist gratis. Du kannst Einzelelemente kaufen oder ein Abo f√ºr vollen Zugang abschlie√üen.',
          loadingPricing: 'Tarife laden...', currentItem: 'Aktuelles Element',
          promoCode: 'Gutscheincode', apply: 'Anwenden', backFromPayment: '‚Üê Zur√ºck',
          submitAndContinue: 'Zur Kasse & weiter', submitRequest: 'Anfrage senden',
          submitHint: 'Das Lied kommt in diesen Chat mit dem Bot. Falls Sie im Bot noch nicht auf ¬´Start¬ª geklickt haben ‚Äî tun Sie es jetzt.',
          paymentPageIntroAfterSubmit: 'Anfrage gesendet. Gutscheincode eingeben oder unten tippen f√ºr Zahlung via HOT Pay.',
          paymentPageTagline: 'Gutscheincode oder Zahlung',
          payWithHot: 'Zahlen via HOT Pay',
          firstFree: 'Dein erster Klangschl√ºssel ist kostenlos.',
          subscriptionActive: 'Du hast ein aktives Abo ‚Äî fahre fort.',
          catalogLoadFailed: 'Tarife konnten nicht geladen werden. Tippe ¬´Zur Kasse¬ª ‚Äî der Backend bestimmt den Preis.',
          paymentRequired: 'Zahlung f√ºr neue Anfragen erforderlich.',
          promoApplied: 'Gutschein {code}: -{amount} {currency}',
          creatingKey: 'Dein Schl√ºssel wird erstellt...',
          creatingKeyDesc: 'Magie passiert in Echtzeit. Dein pers√∂nlicher Klangschl√ºssel wird aus deinen einzigartigen Daten geformt.',
          keyActivated: 'Schl√ºssel aktiviert!', done: 'Fertig!',
          successText: 'Dein pers√∂nlicher Klangschl√ºssel ist erstellt! Dein einzigartiges Kraftartefakt f√ºr das Spiel des Lebens.',
          yourSong: 'üéµ Dein Lied',
          songPreviewText: 'Deine einzigartige Komposition wartet im Bot. H√∂re sie jeden Morgen, um dich auf Erfolg einzustimmen.',
          whatNext: 'Was weiter:', openBot: 'Bot √∂ffnen',
          soulChat: 'Mit deiner Seele sprechen', soulChatPay: 'Zur Kasse ‚Äî Soul Basic / Soul Plus',
          newKey: 'Weiteren Schl√ºssel erstellen',
          paymentThanks: 'Danke f√ºr die Zahlung', thanksSubtitle: 'Anfrage angenommen',
          songInProgress: 'Das Lied wird generiert und kommt im Bot-Chat, wenn es fertig ist.',
          songInProgressConfirmed: 'Anfrage angenommen. Lied wird generiert ‚Äî erneute Zahlung nicht n√∂tig. Es kommt im Bot-Chat, wenn es fertig ist.',
          thanksDone: 'Fertig',
          notFromTelegram: '√ñffne die App aus dem Bot-Chat in Telegram (Men√º) ‚Äî sonst kann die Anfrage nicht gesendet werden.',
          notFound: 'Nicht gefunden', searchError: 'Suchfehler',
          soulChatLoad: 'Laden‚Ä¶',
          soulChatHasAccess: 'Du hast Soul Chat. Tippe unten ‚Äî der Bot √∂ffnet sich. Im Bot: /soulchat und stelle deiner Seele eine Frage.',
          soulChatNoAccess: 'Soul Chat ‚Äî Dialoge mit deiner Seele. Mit Soul Basic (10/Monat) oder Soul Plus (30/Monat) Abo.',
          soulChatDefault: 'Soul Chat ‚Äî Dialoge mit deiner Seele pro Anfrage. Per Abo.',
          soulChatNoApi: 'Soul Chat ‚Äî Dialoge mit deiner Seele. Mit Soul Basic oder Soul Plus Abo. Gehe zu ¬´Zur Kasse¬ª in der App.',
          greeting: 'Hallo, {name}! Komm zur√ºck, wann immer du dich erinnern willst, wer du bist.',
          greetingDefault: 'Komm zur√ºck, wann immer du dich erinnern willst, wer du bist.',
          onboardingSlide1Title: 'Es gibt ein Lied ‚Äî √ºber dich',
          onboardingSlide1Text: 'Geschrieben nach deinem Geburtsdatum. Kein Template ‚Äî ein echter Text √ºber deinen Charakter und Weg.',
          onboardingSlide2Title: 'Nur √ºber dich',
          onboardingSlide2Text: 'Eine smarte Analyse deiner Pers√∂nlichkeit wird zu einem lebendigen Lied ‚Äî einzigartig, nur deins.',
          onboardingSlide3Title: 'Das erste ‚Äî als Geschenk',
          onboardingSlide3Text: 'Gib dein Geburtsdatum ein. Dein Lied kommt in den Bot-Chat.',
          onboardingBtnStart: 'Mein Lied h√∂ren',
          obGiftLine1: 'üéÅ Erstes Lied ‚Äî kostenlos',
          obGiftLine2: '5 Freunde einladen ‚Äî 1 Song als Geschenk erhalten',
          alertNameShort: 'Name muss mindestens 2 Zeichen haben', alertBirthdate: 'W√§hle Geburtsdatum',
          alertBirthplace: 'Geburtsort muss mindestens 3 Zeichen haben', alertBirthplaceHint: 'W√§hle einen Ort aus den Vorschl√§gen',
          alertBirthtime: 'Geburtszeit eingeben oder "Unbekannt" w√§hlen', alertGender: 'Geschlecht w√§hlen', alertLanguage: 'Sprache w√§hlen',
          alertName2Short: 'Name der zweiten Person ‚Äî mindestens 2 Zeichen', alertBirthdate2: 'Geburtsdatum der zweiten Person eingeben',
          alertBirthplace2: 'Geburtsort der zweiten Person muss mindestens 3 Zeichen haben',
          alertBirthtime2: 'Geburtszeit der zweiten Person eingeben', alertGender2: 'Geschlecht der zweiten Person w√§hlen',
          alertTransitDate: 'Ereignisdatum eingeben', alertTransitLocation: 'Ereignisort eingeben', alertTransitConfirm: 'Best√§tige, dass der Ort korrekt ist',
          alertRequestShort: 'Anfrage hinzuf√ºgen (5+ Zeichen)', alertRequestLong: 'Erz√§hle dem Universum mehr (mindestens 15 Zeichen)',
          alertYourPath: 'W√§hle deinen Weg', alertNoApi: 'API-Adresse nicht konfiguriert.', alertOpenFromBot: '√ñffne die App aus dem Bot-Chat in Telegram ‚Äî sonst wird die Anfrage nicht angenommen.',
          alertServerSleep: 'Server brauchte etwas zum Aufwachen. Warte etwa eine Minute und tippe erneut auf ¬´Anfrage senden¬ª.',
          sending: 'Sende‚Ä¶',
          universeHeard: '‚ú® {name}, das Universum hat deine Anfrage geh√∂rt.\n\nDein Klangschl√ºssel wird erstellt und kommt in diesen Chat, wenn er fertig ist.',
          universeHeardCouple: '‚ú® {name} und {name2}, das Universum hat eure Anfrage geh√∂rt.\n\nEuer Klangschl√ºssel wird erstellt und kommt in diesen Chat, wenn er fertig ist.',
          universeHeardTransit: '‚ú® {name}, das Universum hat deine Anfrage geh√∂rt.\n\nDein Tagesenergie-Klangschl√ºssel wird erstellt und kommt in diesen Chat, wenn er fertig ist.',
          langSong: 'Liedsprache', langRu: 'Russisch', langEn: 'Englisch', langDe: 'Deutsch', langFr: 'Franz√∂sisch', langUk: 'Ukrainisch',
          quick1: 'Harmonie und Selbstliebe', quick2: 'Selbstvertrauen und Bestimmung', quick3: 'Kreatives Potenzial', quick4: 'Vergangenheit loslassen',
          quick5: 'Lebensbalance', quick6: 'Vertrauen und Akzeptanz', quick7: 'Heilung und Freiheit', quick8: 'Weg zum Gl√ºck',
          quick9: 'Kraft und √úberwindung', quick10: 'Tiefe und Stille', quick11: 'Z√§rtlichkeit und F√ºrsorge', quick12: 'Humor und Leichtigkeit',
          quick1t: 'Harmonie in Beziehungen und Selbstliebe', quick2t: 'Selbstvertrauen, Bestimmung und Selbstst√§ndigkeit',
          quick3t: 'Kreatives Potenzial ohne Angst entfalten', quick4t: 'Vergangenheit loslassen und neue M√∂glichkeiten √∂ffnen',
          quick5t: 'Balance von Arbeit und Privatleben', quick6t: 'Dem Leben vertrauen und Kontrolle loslassen',
          quick7t: 'Kindheitstraumen heilen und Freiheit finden', quick8t: 'Deinen Weg zu Gl√ºck und Frieden finden',
          quick9t: 'Kraftvolles Lied √ºber meine St√§rke und √úberwindung', quick10t: 'Meditatives Lied f√ºr Praxis und Heilung',
          quick11t: 'Warmes Lied √ºber F√ºrsorge und Z√§rtlichkeit', quick12t: 'Verspieltes Lied mit Selbstironie √ºber meine Eigenheiten',
          promoError: 'Gutscheincode konnte nicht angewendet werden',
          promoCleared: 'Gutscheincode entfernt.', promoApplied: 'Gutschein angewendet: Endsumme {amount} {currency}',
          promoAppliedHint: 'Gutschein {code}: -{amount} {currency}',
          paymentRequiredOpening: 'Zahlung erforderlich. √ñffne HOT Checkout...',
          promoFreeGen: 'Gutschein erm√∂glicht kostenlose Generierung. Starte...',
          hotCheckoutOpened: 'HOT Checkout ge√∂ffnet. Nach der Zahlung kehre zur Mini App zur√ºck ‚Äî der Status wird automatisch aktualisiert.',
          paymentNotConfirmed: 'Zahlung noch nicht best√§tigt. Sp√§ter pr√ºfen oder Zahlung erneut √∂ffnen.',
          paymentConfirmed: 'Zahlung best√§tigt. Generierung startet...',
          paymentReceivedNoStart: 'Zahlung erhalten, aber Auto-Start fehlgeschlagen. Starte Generierung in der Admin per request_id: {id}',
          submitFailed: 'Anfrage konnte nicht gesendet werden. Warte eine Minute und tippe erneut auf ¬´Anfrage senden¬ª oder √∂ffne die Mini App neu aus dem Bot-Chat.',
          errorOp: 'Fehler bei Zahlung/Anfrage',
          alertTransitLocation: 'Ereignisort eingeben', alertTransitConfirm: 'Best√§tige, dass der Ort korrekt ist',
          alertNoApi: 'API-Adresse nicht konfiguriert.', alertOpenFromBot: '√ñffne die App aus dem Bot-Chat in Telegram ‚Äî sonst wird die Anfrage nicht angenommen.',
          alertOpenFromBotShort: '√ñffne die App aus dem Bot-Chat in Telegram.',
          alertPaymentFirst: 'Tippe zuerst auf ¬´Anfrage senden¬ª im vorherigen Schritt.',
          alertLinkCopied: '‚úì Link kopiert. F√ºge ihn in Safari oder Chrome ein und √∂ffne ihn.',
          alertHeroName: 'Name eingeben', alertError: 'Fehler', alertDeleteConfirm: '¬´{name}¬ª l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.',
          alertSubmitError: 'Sendefehler',
          copyLinkPrompt: 'Kopiere diesen Link und √∂ffne ihn im Browser:',
          songFormingText: 'Dein Klangschl√ºssel wird erstellt und kommt in diesen Chat, wenn er fertig ist.',
          heroesLoading: 'Laden...', heroesEmpty: 'Noch keine Helden. Tippe auf ¬´Held hinzuf√ºgen¬ª.',
          heroesLoadError: 'Liste konnte nicht geladen werden. API-Einstellungen pr√ºfen.',
          forMyself: 'F√ºr mich', forHero: 'F√ºr: {name}',
          previewHome: 'Startseite', previewForm: 'Formular', previewPayment: 'Zahlung', previewLoading: 'Laden', previewSuccess: 'Erfolg'
        },
        fr: {
          tagline: 'Explore tes facettes comme tu le souhaites',
          startBtn: 'Cr√©er ma chanson', myProfile: 'üë§ Profil', myHeroes: 'Labo', admin: 'üëë Admin',
          profileTitle: 'Profil', profileSubtitle: 'Tes donn√©es et g√©n√©rations gratuites',
          profileFreeCredits: 'G√©n√©rations gratuites', profileInviteFriend: 'Inviter un ami', profileShare: 'Partager',
          profileInvited: 'Invit√©s', profileActivated: 'Activ√©s', profileCreateSong: 'Cr√©er une chanson',
          heroesTitle: 'Laboratoire', heroesSubtitle: 'R√©pertoire des personnes',
          searchByName: 'Rechercher par nom', searchPlaceholder: 'Entrer le nom...', searchBtn: 'Rechercher',
          addHero: '‚ûï Ajouter un h√©ros', heroName: 'Nom *', heroBirthdate: 'Date de naissance', heroBirthtime: 'Heure de naissance',
          heroBirthplace: 'Lieu de naissance', heroBirthplacePh: 'Ville, pays', heroNotes: 'Notes', heroNotesPh: 'Notes client',
          unknownTime: "Heure exacte inconnue", cancel: 'Annuler', save: 'Enregistrer', back: '‚Üê Retour',
          gender: 'Genre', genderSelect: 'Choisir', male: 'Homme', female: 'Femme', other: 'Autre',
          modeType: "Format de chanson", modeSubtitle: 'Pour qui cr√©ons-nous ?',
          modeSingle: '√Ä mon sujet', modeSingleDesc: 'Une chanson selon ta date de naissance.',
          modeCouple: 'Nous deux', modeCoupleDesc: 'Une chanson pour deux personnes.',
          modeTransit: "√ânergie du moment", modeTransitDesc: "Une chanson sur la journ√©e d'aujourd'hui.",
          namePh: "Comment tu t'appelles ?", birthdateLabel: 'Date de naissance', birthplacePh: 'Ville ou pays ‚Äî choisis parmi les suggestions',
          birthplaceHint: 'Tape ta ville et choisis dans la liste.',
          unknownTimeShort: 'Inconnu', secondPersonTitle: '√Ä deux', name2Ph: "Nom de la deuxi√®me personne",
          birthplace2Ph: "Lieu de naissance de la deuxi√®me personne", birthtime2Ph: 'Heure de naissance',
          transitTitle: "√ânergie du moment", transitDatePh: 'Date de l\'√©v√©nement', transitTimePh: "Heure de l'√©v√©nement",
          transitLocationPh: 'Ville pour l\'√©nergie du moment', transitLocationOk: 'Le lieu est correct',
          transitIntentPh: 'Intention pour ce moment (optionnel)',
          sendRequest: 'Envoyer la demande', quickRequests: 'Demandes rapides', hide: 'Masquer',
          requestPh: 'Que souhaites-tu explorer aujourd\'hui ?', toPayment: 'Paiement',
          paymentSubtitle: 'Ta cl√© sonore', paymentAndAccess: 'Paiement et acc√®s',
          paymentIntro: 'La premi√®re chanson est offerte. Tu peux payer des √©l√©ments individuels ou t\'abonner pour un acc√®s complet.',
          loadingPricing: 'Chargement des tarifs...', currentItem: '√âl√©ment actuel',
          promoCode: 'Code promo', apply: 'Appliquer', backFromPayment: '‚Üê Retour',
          submitAndContinue: 'Payer et continuer', submitRequest: 'Envoyer la demande',
          submitHint: 'La chanson arrivera dans ce chat avec le bot. Si vous n\'avez pas encore appuy√© sur ¬´D√©marrer¬ª dans le bot ‚Äî faites-le maintenant.',
          paymentPageIntroAfterSubmit: 'Demande envoy√©e. Entre le code promo ou appuie ci-dessous pour payer via HOT Pay.',
          paymentPageTagline: 'Code promo ou paiement',
          payWithHot: 'Payer via HOT Pay',
          firstFree: 'Ta premi√®re cl√© sonore est gratuite.',
          subscriptionActive: 'Tu as un abonnement actif ‚Äî continue.',
          catalogLoadFailed: 'Tarifs non charg√©s. Appuie sur ¬´Payer¬ª ‚Äî le backend d√©terminera le prix.',
          paymentRequired: 'Paiement requis pour les nouvelles demandes.',
          promoApplied: 'Code promo {code}: -{amount} {currency}',
          creatingKey: 'Cr√©ation de ta cl√©...',
          creatingKeyDesc: 'La magie op√®re en temps r√©el. Ta cl√© sonore personnelle se forme √† partir de tes donn√©es uniques.',
          keyActivated: 'Cl√© activ√©e !', done: 'Termin√© !',
          successText: 'Ta cl√© sonore personnelle est cr√©√©e ! Ton artefact unique de force pour le jeu de la vie.',
          yourSong: 'üéµ Ta chanson',
          songPreviewText: 'Ta composition unique t\'attend dans le bot. √âcoute-la chaque matin pour te mettre sur la voie du succ√®s.',
          whatNext: 'Et apr√®s :', openBot: 'Ouvre le bot',
          soulChat: 'Parler √† ton √¢me', soulChatPay: 'Paiement ‚Äî Soul Basic / Soul Plus',
          newKey: 'Cr√©er une autre cl√©',
          paymentThanks: 'Merci pour le paiement', thanksSubtitle: 'demande accept√©e',
          songInProgress: 'La chanson est en cours de g√©n√©ration et arrivera dans le chat du bot quand elle sera pr√™te.',
          songInProgressConfirmed: 'Demande accept√©e. Chanson en g√©n√©ration ‚Äî pas besoin de payer √† nouveau. Elle arrivera dans le chat du bot quand elle sera pr√™te.',
          thanksDone: 'Termin√©',
          notFromTelegram: 'Ouvre l\'app depuis le chat du bot dans Telegram (bouton menu) ‚Äî sinon la demande ne peut pas √™tre envoy√©e.',
          notFound: 'Non trouv√©', searchError: 'Erreur de recherche',
          soulChatLoad: 'Chargement‚Ä¶',
          soulChatHasAccess: "Tu as acc√®s √† Soul Chat. Appuie ci-dessous ‚Äî le bot s'ouvrira. Dans le bot, tape /soulchat et pose une question √† ton √¢me.",
          soulChatNoAccess: 'Soul Chat ‚Äî dialogues avec ton √¢me. Avec abonnement Soul Basic (10/mois) ou Soul Plus (30/mois).',
          soulChatDefault: 'Soul Chat ‚Äî dialogues avec ton √¢me par demande. Sur abonnement.',
          soulChatNoApi: 'Soul Chat ‚Äî dialogues avec ton √¢me. Avec abonnement Soul Basic ou Soul Plus. Va dans ¬´Paiement¬ª dans l\'app.',
          greeting: 'Salut, {name} ! Reviens quand tu veux te souvenir de qui tu es.',
          greetingDefault: 'Reviens quand tu veux te souvenir de qui tu es.',
          onboardingSlide1Title: 'Il y a une chanson ‚Äî sur toi',
          onboardingSlide1Text: '√âcrite selon ta date de naissance. Pas un mod√®le ‚Äî un vrai texte sur ton caract√®re et ton chemin.',
          onboardingSlide2Title: 'Seulement sur toi',
          onboardingSlide2Text: 'Une analyse intelligente de ta personnalit√© devient une chanson vivante ‚Äî unique, rien qu\'√† toi.',
          onboardingSlide3Title: 'La premi√®re ‚Äî en cadeau',
          onboardingSlide3Text: 'Saisis ta date de naissance. Ta chanson arrivera dans le chat du bot.',
          onboardingBtnStart: 'Recevoir ma chanson',
          obGiftLine1: 'üéÅ Premi√®re chanson ‚Äî gratuite',
          obGiftLine2: 'Invite 5 amis ‚Äî re√ßois une chanson en cadeau',
          alertNameShort: 'Le nom doit contenir au moins 2 caract√®res', alertBirthdate: 'Choisis la date de naissance',
          alertBirthplace: 'Le lieu de naissance doit contenir au moins 3 caract√®res', alertBirthplaceHint: 'Choisis un lieu dans les suggestions',
          alertBirthtime: 'Entre l\'heure de naissance ou coche "Inconnu"', alertGender: 'Choisis le genre', alertLanguage: 'Choisis la langue',
          alertName2Short: 'Le nom de la 2e personne ‚Äî au moins 2 caract√®res', alertBirthdate2: 'Entre la date de naissance de la 2e personne',
          alertBirthplace2: 'Le lieu de naissance de la 2e personne doit contenir au moins 3 caract√®res',
          alertBirthtime2: 'Entre l\'heure de naissance de la 2e personne', alertGender2: 'Choisis le genre de la 2e personne',
          alertTransitDate: 'Entre la date de l\'√©v√©nement', alertTransitLocation: 'Entre le lieu de l\'√©v√©nement', alertTransitConfirm: 'Confirme que le lieu est correct',
          alertRequestShort: 'Ajoute une demande (5+ caract√®res)', alertRequestLong: 'Dis-en plus √† l\'Univers (au moins 15 caract√®res)',
          alertYourPath: 'Choisis ton chemin', alertNoApi: 'Adresse API non configur√©e.', alertOpenFromBot: 'Ouvre l\'app depuis le chat du bot dans Telegram ‚Äî sinon la demande ne peut pas √™tre accept√©e.',
          alertServerSleep: 'Le serveur s\'est r√©veill√© lentement. Attends environ une minute et appuie √† nouveau sur ¬´Envoyer la demande¬ª.',
          sending: 'Envoi‚Ä¶',
          universeHeard: '‚ú® {name}, l\'Univers a entendu ta demande.\n\nTa cl√© sonore est en cours de cr√©ation et arrivera dans ce chat quand elle sera pr√™te.',
          universeHeardCouple: '‚ú® {name} et {name2}, l\'Univers a entendu votre demande.\n\nVotre cl√© sonore est en cours de cr√©ation et arrivera dans ce chat quand elle sera pr√™te.',
          universeHeardTransit: '‚ú® {name}, l\'Univers a entendu ta demande.\n\nTa cl√© sonore √ânergie du jour est en cours de cr√©ation et arrivera dans ce chat quand elle sera pr√™te.',
          langSong: 'Langue de la chanson', langRu: 'Russe', langEn: 'Anglais', langDe: 'Allemand', langFr: 'Fran√ßais', langUk: 'Ukrainien',
          quick1: 'Harmonie et amour de soi', quick2: 'Confiance et but', quick3: 'Potentiel cr√©atif', quick4: 'L√¢cher le pass√©',
          quick5: '√âquilibre de vie', quick6: 'Confiance et acceptation', quick7: 'Gu√©rison et libert√©', quick8: 'Chemin vers le bonheur',
          quick9: 'Force et d√©passement', quick10: 'Profondeur et silence', quick11: 'Tendresse et soin', quick12: 'Humor et l√©g√®ret√©',
          quick1t: 'Harmonie dans les relations et amour de soi', quick2t: 'Confiance, but et autonomie',
          quick3t: 'Lib√©rer ton potentiel cr√©atif sans peur', quick4t: 'L√¢cher le pass√© et ouvrir de nouvelles possibilit√©s',
          quick5t: '√âquilibre travail et vie personnelle', quick6t: 'Faire confiance √† la vie et l√¢cher le contr√¥le',
          quick7t: 'Gu√©rir les blessures d\'enfance et trouver la libert√©', quick8t: 'Trouver ton chemin vers le bonheur et la paix',
          quick9t: 'Chanson puissante sur ma force et mon d√©passement', quick10t: 'Chanson m√©ditative pour la pratique et la gu√©rison',
          quick11t: 'Chanson chaleureuse sur le soin et la tendresse', quick12t: 'Chanson ludique avec auto-ironie sur mes travers',
          promoError: 'Code promo non appliqu√©',
          promoCleared: 'Code promo effac√©.', promoApplied: 'Code promo appliqu√©: montant final {amount} {currency}',
          promoAppliedHint: 'Code promo {code}: -{amount} {currency}',
          paymentRequiredOpening: 'Paiement requis. Ouverture de HOT Checkout...',
          promoFreeGen: 'Le code promo donne une g√©n√©ration gratuite. D√©marrage...',
          hotCheckoutOpened: 'HOT Checkout ouvert. Apr√®s paiement, reviens dans la Mini App ‚Äî le statut se mettra √† jour automatiquement.',
          paymentNotConfirmed: 'Paiement pas encore confirm√©. V√©rifie plus tard ou rouvre le paiement.',
          paymentConfirmed: 'Paiement confirm√©. D√©marrage de la g√©n√©ration...',
          paymentReceivedNoStart: 'Paiement re√ßu, mais d√©marrage auto √©chou√©. Lance la g√©n√©ration dans l\'admin par request_id: {id}',
          submitFailed: 'Demande non envoy√©e. Attends une minute et appuie √† nouveau sur ¬´Envoyer la demande¬ª ou rouvre la Mini App depuis le chat du bot.',
          errorOp: 'Erreur op√©ration paiement/demande',
          alertTransitLocation: 'Entre le lieu de l\'√©v√©nement', alertTransitConfirm: 'Confirme que le lieu est correct',
          alertNoApi: 'Adresse API non configur√©e.', alertOpenFromBot: 'Ouvre l\'app depuis le chat du bot dans Telegram ‚Äî sinon la demande ne peut pas √™tre accept√©e.',
          alertOpenFromBotShort: 'Ouvre l\'app depuis le chat du bot dans Telegram.',
          alertPaymentFirst: 'Appuie d\'abord sur ¬´Envoyer la demande¬ª √† l\'√©tape pr√©c√©dente.',
          alertLinkCopied: '‚úì Lien copi√©. Colle-le dans Safari ou Chrome et ouvre-le.',
          alertHeroName: 'Entre le nom', alertError: 'Erreur', alertDeleteConfirm: 'Supprimer ¬´{name}¬ª ? Cette action ne peut pas √™tre annul√©e.',
          alertSubmitError: 'Erreur d\'envoi',
          copyLinkPrompt: 'Copie ce lien et ouvre-le dans le navigateur:',
          songFormingText: 'Ta cl√© sonore est en cours de cr√©ation et arrivera dans ce chat quand elle sera pr√™te.',
          heroesLoading: 'Chargement...', heroesEmpty: 'Pas encore de h√©ros. Appuie sur ¬´Ajouter un h√©ros¬ª.',
          heroesLoadError: 'Impossible de charger la liste. V√©rifier les param√®tres API.',
          forMyself: 'Pour moi', forHero: 'Pour: {name}',
          previewHome: 'Accueil', previewForm: 'Formulaire', previewPayment: 'Paiement', previewLoading: 'Chargement', previewSuccess: 'Succ√®s'
        }
      };
      var currentLang = 'ru';
      function detectLang() {
        try {
          var stored = localStorage.getItem(LANG_STORAGE_KEY);
          if (stored === 'ru' || stored === 'en' || stored === 'de' || stored === 'fr') return stored;
          var lc = (tg && tg.initDataUnsafe && tg.initDataUnsafe.user && tg.initDataUnsafe.user.language_code) || (typeof navigator !== 'undefined' && navigator.language) || '';
          lc = (lc || '').toLowerCase();
          if (/^en/.test(lc)) return 'en';
          if (/^de/.test(lc)) return 'de';
          if (/^fr/.test(lc)) return 'fr';
          if (/^uk/.test(lc)) return 'ru';
          return 'ru';
        } catch (_) { return 'ru'; }
      }
      function t(k, vars) {
        // –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —è–∑—ã–∫–æ–≤
        if (!LANG[currentLang]) {
          console.warn('[i18n] –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —è–∑—ã–∫:', currentLang, '- –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Å—å –Ω–∞ —Ä—É—Å—Å–∫–∏–π');
          currentLang = 'ru';
          try { localStorage.setItem(LANG_STORAGE_KEY, 'ru'); } catch (_) {}
        }
        var s = (LANG[currentLang] && LANG[currentLang][k]) || (LANG.ru && LANG.ru[k]) || k;
        if (vars && typeof s === 'string') {
          Object.keys(vars).forEach(function(key) { s = s.replace(new RegExp('\\{' + key + '\\}', 'g'), vars[key]); });
        }
        return s;
      }
      function applyTranslations() {
        // #region agent log
        fetch('http://127.0.0.1:7243/ingest/dccd13d7-932e-4733-92f4-45355c9cfd86',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'public/index.html:1284',message:'applyTranslations START',data:{currentLang:currentLang,startBtnInLang:LANG[currentLang]&&LANG[currentLang].startBtn?LANG[currentLang].startBtn:'MISSING',previewSlide1Before:document.querySelectorAll('.preview-slide-title')[0]?document.querySelectorAll('.preview-slide-title')[0].textContent:'NULL'},timestamp:Date.now(),hypothesisId:'A,C,E'})}).catch(()=>{});
        // #endregion
        document.documentElement.lang = currentLang || 'ru';
        var map = [
          ['tagline','#homeTagline'], ['startBtn','#startBtn'], ['myProfile','#goProfileBtn'], ['myHeroes','#goHeroesBtn'], ['admin','#adminLinkBtn'],
          ['profileShare','#profileRefShareBtn'], ['profileCreateSong','#profileCreateSongBtn'],
          ['heroesTitle','#heroesPage header h1'], ['heroesSubtitle','#heroesPage .subtitle'],
          ['searchByName','#heroesPage label[for="heroesSearch"]'], ['searchPlaceholder','#heroesSearch'], ['searchBtn','#heroesSearchBtn'],
          ['addHero','#addHeroBtn'], ['heroName','#heroFormWrap label[for="heroName"]'], ['heroBirthdate','#heroFormWrap label[for="heroBirthdate"]'],
          ['heroBirthtime','#heroFormWrap label[for="heroBirthtime"]'], ['heroBirthplace','#heroFormWrap label[for="heroBirthplace"]'],
          ['heroNotes','#heroFormWrap label[for="heroNotes"]'], ['unknownTime','#heroFormWrap label[for="heroBirthtimeUnknown"]'],
          ['cancel','#heroFormCancel'], ['save','#heroFormSave'], ['back','#heroesBackBtn'],
          ['modeType','.mode-selector h3'], ['modeSubtitle','.mode-subtitle'],
          ['modeSingle','.mode-btn[data-mode="single"] .mode-label'], ['modeSingleDesc','.mode-btn[data-mode="single"] .mode-desc'],
          ['modeCouple','.mode-btn[data-mode="couple"] .mode-label'], ['modeCoupleDesc','.mode-btn[data-mode="couple"] .mode-desc'],
          ['modeTransit','.mode-btn[data-mode="transit"] .mode-label'], ['modeTransitDesc','.mode-btn[data-mode="transit"] .mode-desc'],
          ['secondPersonTitle','#secondPersonForm h3'], ['transitTitle','#transitForm h3'],
          ['quickRequests','#quickRequestsToggle'], ['sendRequest','.request-label'], ['submitRequest','#stepNext'], ['submitHint','#submitHint'],
          ['paymentSubtitle','#paymentPage .subtitle'], ['paymentPageTagline','#paymentPage .tagline'],
          ['promoCode','#promoCodeInput'], ['apply','#promoApplyBtn'], ['backFromPayment','#backFromPaymentBtn'],
          ['paymentPageIntroAfterSubmit','#paymentIntro'], ['loadingDesc','#loadingDesc'], ['priceSummaryLabel','#priceSummaryLabel'],
          ['payWithHot','#payBtn'], ['creatingKey','.loading-text'], ['keyActivated','#successPage .subtitle'],
          ['done','.success-title'], ['soulChat','#soulChatBtn'], ['soulChatPay','#soulChatPayBtn'], ['newKey','#newKeyBtn'],
          ['paymentThanks','#paymentThanksPage .success-title'], ['thanksSubtitle','#paymentThanksPage .subtitle'],
          ['thanksDone','#paymentThanksBackBtn'], ['gender','#genderLabel'], ['genderSelect','#gender option[value=""]'],
          ['previewHome','button[data-page="home"]'], ['previewForm','button[data-page="form"]'], 
          ['previewPayment','button[data-page="payment"]'], ['previewLoading','button[data-page="loading"]'], ['previewSuccess','button[data-page="success"]']
        ];
        map.forEach(function(pair) {
          var el = document.querySelector(pair[1]);
          if (el) {
            if (pair[1].indexOf('placeholder') === -1 && (pair[1].indexOf('#') === 0 || pair[1].indexOf('label') >= 0 || pair[1].indexOf('h3') >= 0 || pair[1].indexOf('.') >= 0)) {
              if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.placeholder = t(pair[0]);
              else el.textContent = t(pair[0]);
            } else if (pair[1].indexOf('placeholder') >= 0 || (el.tagName === 'INPUT' && pair[0] === 'searchPlaceholder')) el.placeholder = t(pair[0]);
            else el.textContent = t(pair[0]);
          }
        });
        var phMap = [
          ['namePh','#name'], ['birthplacePh','#birthplace'], ['name2Ph','#name2'], ['birthplace2Ph','#birthplace2'],
          ['transitDatePh','#transitDate'], ['transitTimePh','#transitTime'], ['transitLocationPh','#transitLocation'],
          ['transitIntentPh','#transitIntent'], ['requestPh','#request'], ['heroBirthplacePh','#heroBirthplace'],
          ['heroNotesPh','#heroNotes'], ['heroName','#heroName'], ['promoCode','#promoCodeInput']
        ];
        phMap.forEach(function(p) { var e = document.querySelector(p[1]); if (e) e.placeholder = t(p[0]); });
        var selectOpts = [['genderSelect','gender'],['male','male'],['female','female'],['other','other'],['langSong','language'],['langRu','ru'],['langEn','en'],['langDe','de'],['langFr','fr'],['langUk','uk']];
        var genderSelect = document.getElementById('gender'); if (genderSelect) {
          var opts = genderSelect.querySelectorAll('option'); if (opts[0]) opts[0].textContent = t('genderSelect');
          if (opts[1]) opts[1].textContent = t('male'); if (opts[2]) opts[2].textContent = t('female');
          var o3 = genderSelect.querySelector('option[value="other"]'); if (o3) o3.textContent = t('other');
        }
        var gender2 = document.getElementById('gender2'); if (gender2) {
          var o2 = gender2.querySelectorAll('option'); if (o2[0]) o2[0].textContent = t('genderSelect');
          if (o2[1]) o2[1].textContent = t('female'); if (o2[2]) o2[2].textContent = t('male');
          var o23 = gender2.querySelector('option[value="other"]'); if (o23) o23.textContent = t('other');
        }
        var heroGender = document.getElementById('heroGender'); if (heroGender) {
          var hOpts = heroGender.querySelectorAll('option'); if (hOpts[0]) hOpts[0].textContent = t('genderSelect');
          if (hOpts[1]) hOpts[1].textContent = t('male'); if (hOpts[2]) hOpts[2].textContent = t('female');
          var hO3 = heroGender.querySelector('option[value="other"]'); if (hO3) hO3.textContent = t('other');
        }
        var langSelect = document.getElementById('language'); if (langSelect) {
          var lOpts = langSelect.querySelectorAll('option');
          if (lOpts[0]) lOpts[0].textContent = t('langSong');
          var lRu = langSelect.querySelector('option[value="ru"]'); if (lRu) lRu.textContent = t('langRu');
          var lEn = langSelect.querySelector('option[value="en"]'); if (lEn) lEn.textContent = t('langEn');
          var lDe = langSelect.querySelector('option[value="de"]'); if (lDe) lDe.textContent = t('langDe');
          var lFr = langSelect.querySelector('option[value="fr"]'); if (lFr) lFr.textContent = t('langFr');
          var lUk = langSelect.querySelector('option[value="uk"]'); if (lUk) lUk.textContent = t('langUk');
        }
        var heroOpt = document.querySelector('#heroGender option[value=""]'); if (heroOpt) heroOpt.textContent = t('genderSelect');
        var heroMale = document.querySelector('#heroGender option[value="male"]'); if (heroMale) heroMale.textContent = t('male');
        var heroFemale = document.querySelector('#heroGender option[value="female"]'); if (heroFemale) heroFemale.textContent = t('female');
        document.getElementById('birthplaceHint') && (document.getElementById('birthplaceHint').textContent = t('birthplaceHint'));
        document.getElementById('birthplace2Hint') && (document.getElementById('birthplace2Hint').textContent = t('birthplaceHint'));
        document.querySelector('label[for="transitLocationConfirmed"]') && (document.querySelector('label[for="transitLocationConfirmed"]').textContent = t('transitLocationOk'));
        document.querySelector('label[for="unknown"]') && (document.querySelector('label[for="unknown"]').textContent = t('unknownTime'));
        document.querySelector('label[for="unknown2"]') && (document.querySelector('label[for="unknown2"]').textContent = t('unknownTimeShort'));
        var quickBtns = document.querySelectorAll('.example-btn'); var quickK = ['quick1','quick2','quick3','quick4','quick5','quick6','quick7','quick8','quick9','quick10','quick11','quick12']; var quickT = ['quick1t','quick2t','quick3t','quick4t','quick5t','quick6t','quick7t','quick8t','quick9t','quick10t','quick11t','quick12t'];
        quickBtns.forEach(function(btn, i) { if (btn) { btn.textContent = t(quickK[i]); btn.setAttribute('data-text', t(quickT[i])); } });
        var gh = document.getElementById('homeGreeting');
        if (gh) gh.textContent = (userProfile && userProfile.name) ? t('greeting', { name: userProfile.name }) : t('greetingDefault');
        var langCurrentEl = document.getElementById('langSwitcherCurrent');
        if (langCurrentEl) { var codes = { ru: 'RU', en: 'EN', de: 'DE', fr: 'FR' }; langCurrentEl.textContent = codes[currentLang] || 'RU'; }
        // –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (–ø—Ä–µ–≤—å—é-—Å—Ç–æ—Ä–∏—Å) ‚Äî –Ω–∞ —è–∑—ã–∫–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        // –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è 3 —Å–ª–∞–π–¥–æ–≤ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
        var obTitle1 = document.getElementById('obTitle1'); var obText1 = document.getElementById('obText1');
        var obTitle2 = document.getElementById('obTitle2'); var obText2 = document.getElementById('obText2');
        var obTitle3 = document.getElementById('obTitle3'); var obText3 = document.getElementById('obText3');
        if (obTitle1) obTitle1.textContent = t('onboardingSlide1Title');
        if (obText1)  obText1.textContent  = t('onboardingSlide1Text');
        if (obTitle2) obTitle2.textContent = t('onboardingSlide2Title');
        if (obText2)  obText2.textContent  = t('onboardingSlide2Text');
        if (obTitle3) obTitle3.textContent = t('onboardingSlide3Title');
        if (obText3)  obText3.textContent  = t('onboardingSlide3Text');
        var startBtn = document.getElementById('onboardingStartBtn'); if (startBtn) startBtn.textContent = t('onboardingBtnStart');
        // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
        ensurePayButtonText();
      }
      function setLang(lang) {
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —è–∑—ã–∫–æ–≤
        var supportedLangs = ['ru', 'en', 'de', 'fr'];
        if (supportedLangs.indexOf(lang) === -1) {
          console.warn('[i18n] –ü–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —è–∑—ã–∫:', lang, '- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä—É—Å—Å–∫–∏–π');
          lang = 'ru';
        }
        currentLang = lang;
        try { localStorage.setItem(LANG_STORAGE_KEY, lang); } catch (_) {}
        // –Ø–∑—ã–∫ –ø–µ—Å–Ω–∏ –Ω–µ –º–µ–Ω—è–µ–º –ø—Ä–∏ —Å–º–µ–Ω–µ —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ‚Äî —ç—Ç–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        applyTranslations();
        // –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –≤ Chromium/WebView –∑–∞–≤–∏—Å–∏—Ç –æ—Ç lang —Å–∞–º–æ–≥–æ input ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º
        document.querySelectorAll('input[type="date"]').forEach(function(el) { el.lang = lang; });
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ–ø–ª–∞—Ç—ã –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —è–∑—ã–∫–∞
        ensurePayButtonText();
      }
      function ensurePayButtonText() {
        var payBtn = document.getElementById('payOvPayBtn');
        if (!payBtn || payBtn.disabled) return;
        var isFree = activePromo && Number(activePromo.amount_after) === 0;
        if (isFree) return;
        var sku = pendingPaymentSku || getCurrentSku();
        var item = pricingCatalog && pricingCatalog.find(function(x) { return x && x.sku === sku; });
        var priceStr = item ? (String(item.price) + ' ' + (item.currency || 'USDT')) : '';
        payBtn.textContent = priceStr ? ('üí≥ –û–ø–ª–∞—Ç–∏—Ç—å ' + priceStr) : 'üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ HOT Pay';
        payBtn.style.background = 'linear-gradient(135deg,#d4af37,#ec4899)';
      }
      function isTelegramWebApp() {
        return !!(window.Telegram && window.Telegram.WebApp);
      }
      function getInitData() {
        var current = '';
        try {
          var wa = window.Telegram && window.Telegram.WebApp;
          current = (wa && wa.initData) ? String(wa.initData) : (tg && tg.initData) ? String(tg.initData) : '';
          console.log('[initData] Telegram WebApp –¥–æ—Å—Ç—É–ø–µ–Ω:', !!(wa));
          console.log('[initData] initData –∏–∑ WebApp:', current ? '–µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ (' + current.length + ' —Å–∏–º–≤–æ–ª–æ–≤)' : '–ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ');
        } catch (e) { 
          console.error('[initData] –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è initData:', e);
          current = ''; 
        }
        if (current) {
          try { localStorage.setItem(INIT_DATA_STORAGE_KEY, current); } catch (_) {}
          console.log('[initData] –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Telegram');
          return current;
        }
        try { 
          var stored = localStorage.getItem(INIT_DATA_STORAGE_KEY) || '';
          console.log('[initData] –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', stored ? '–µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ (' + stored.length + ' —Å–∏–º–≤–æ–ª–æ–≤)' : '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö');
          if (!stored) {
            console.warn('[initData] –ö–†–ò–¢–ò–ß–ù–û: –ù–µ—Ç initData! –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ –∏–∑ Telegram –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –¥–µ–º–æ-—Ä–µ–∂–∏–º
            setTimeout(function() {
              var message = '‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π Telegram!\n\n' +
                           'üîß –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:\n' +
                           '1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –±–æ—Ç–∞ @YupSoul_bot (–∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é ‚ò∞)\n' +
                           '2. –û–±–Ω–æ–≤–∏—Ç–µ Telegram –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏\n' +
                           '3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Telegram\n' +
                           '4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ web.telegram.org\n\n' +
                           'üí° –ò–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ (–±–µ–∑ –æ–ø–ª–∞—Ç—ã)';
              
              if (confirm(message + '\n\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ?')) {
                console.log('[Demo] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –¥–µ–º–æ-—Ä–µ–∂–∏–º');
                window.demoMode = true;
                // –°–æ–∑–¥–∞–µ–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ
                window.fallbackUserData = {
                  id: 'demo_user',
                  first_name: 'Demo User',
                  username: 'demo'
                };
              }
            }, 3000);
          }
          return stored;
        } catch (_) { 
          console.error('[initData] –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∏–∑ localStorage');
          return ''; 
        }
      }
      function initApp() {
        try {
          console.log('[App] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è');
          console.log('[App] window.Telegram –¥–æ—Å—Ç—É–ø–µ–Ω:', !!(window.Telegram));
          console.log('[App] window.Telegram.WebApp –¥–æ—Å—Ç—É–ø–µ–Ω:', !!(window.Telegram && window.Telegram.WebApp));
          
      if (window.Telegram && window.Telegram.WebApp) {
            tg = window.Telegram.WebApp;
            console.log('[Telegram] WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            console.log('[Telegram] –í–µ—Ä—Å–∏—è:', tg.version);
            console.log('[Telegram] –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:', tg.platform);
            console.log('[Telegram] initData –¥–ª–∏–Ω–∞:', tg.initData ? tg.initData.length : 0);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é Telegram WebApp
            var version = parseFloat(tg.version) || 0;
            if (version < 6.1) {
              console.warn('[Telegram] –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è WebApp (' + tg.version + ') –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å initData');
              console.warn('[Telegram] –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å Telegram –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏');
            }
            
        tg.ready();
            tg.expand();
            // –ó–∞–∫—Ä–∞—à–∏–≤–∞–µ–º —à–∞–ø–∫—É Telegram –≤ —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ ‚Äî —É–±–∏—Ä–∞–µ—Ç –∑–æ–ª–æ—Ç–∏—Å—Ç—É—é –ø–æ–ª–æ—Å–∫—É
            try {
              if (tg.setHeaderColor) tg.setHeaderColor('#08071a');
              if (tg.setBackgroundColor) tg.setBackgroundColor('#08071a');
            } catch(e) {}
            console.log('[Telegram] ready() –∏ expand() –≤—ã–ø–æ–ª–Ω–µ–Ω—ã');
            
            if (tg.enableClosingConfirmation) {
              tg.enableClosingConfirmation();
              console.log('[Telegram] enableClosingConfirmation –≤–∫–ª—é—á–µ–Ω');
            } else {
              console.warn('[Telegram] enableClosingConfirmation –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏');
            }
            getInitData();
            
            // –î–ª—è —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π Telegram –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ö–æ—Ç—è –±—ã –±–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            if ((!tg.initData || tg.initData.length < 10) && tg.initDataUnsafe && tg.initDataUnsafe.user) {
              console.log('[Telegram] –ò—Å–ø–æ–ª—å–∑—É–µ–º initDataUnsafe –∫–∞–∫ fallback –¥–ª—è —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏');
              console.log('[Telegram] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', tg.initDataUnsafe.user.first_name, tg.initDataUnsafe.user.id);
              
              // –°–æ–∑–¥–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–µ –¥–ª—è API)
              window.fallbackUserData = {
                id: tg.initDataUnsafe.user.id,
                first_name: tg.initDataUnsafe.user.first_name,
                username: tg.initDataUnsafe.user.username
              };
            }
            
            return true;
          } else {
            console.error('[Telegram] WebApp –ù–ï –î–û–°–¢–£–ü–ï–ù!');
            console.error('[Telegram] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ –∏–∑ Telegram –∏–ª–∏ –≤ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–º –±—Ä–∞—É–∑–µ—Ä–µ');
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
            setTimeout(function() {
              if (!tg) {
                alert('‚ö†Ô∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–æ –∏–∑ Telegram!\n\n' +
                      '1. –û—Ç–∫—Ä–æ–π—Ç–µ @YupSoul_bot –≤ Telegram\n' +
                      '2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –º–µ–Ω—é (‚ò∞) –∏–ª–∏ "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"\n' +
                      '3. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ–±–Ω–æ–≤–∏—Ç–µ Telegram –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏');
              }
            }, 2000);
          }
        } catch (e) { 
          console.error('[Telegram] –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', e); 
        }
        return false;
      }
      if (!initApp()) {
        var attempts = 0;
        var t = setInterval(function() {
          attempts++;
          if (initApp() || attempts >= 50) {
            clearInterval(t);
            if (!tg) showNotFromTelegramBanner();
          }
        }, 100);
      }
      function showNotFromTelegramBanner() {
        var banner = document.createElement('div');
        banner.id = 'not-telegram-banner';
        banner.style.cssText = 'position:fixed;top:0;left:0;right:0;z-index:9999;background:#fef3c7;color:#92400e;padding:12px 16px;text-align:center;font-size:0.95rem;border-bottom:1px solid #f59e0b;';
        banner.textContent = t('notFromTelegram');
        document.body.insertBefore(banner, document.body.firstChild);
      }
      async function showLocationSuggestions(inputElement, suggestionsContainerId, confirmCheckboxId) {
        var value = inputElement.value.trim();
        var suggestionsContainer = document.getElementById(suggestionsContainerId);
        if (value.length < 2) {
          if (suggestionsContainer) suggestionsContainer.style.display = 'none';
          return;
        }
        try {
          var response = await fetch('https://nominatim.openstreetmap.org/search?format=json&q=' + encodeURIComponent(value) + '&addressdetails=1&limit=5', { headers: { 'Accept': 'application/json', 'User-Agent': 'YupSoulMiniApp/1.0' } });
          var locations = await response.json();
          if (locations.length === 0) {
            if (suggestionsContainer) {
              suggestionsContainer.innerHTML = '<div style="padding: 10px; color: var(--tg-theme-hint-color, rgba(255,255,255,0.6)); text-align: center;">' + t('notFound') + '</div>';
              suggestionsContainer.style.display = 'block';
            }
            return;
          }
          if (suggestionsContainer) {
            suggestionsContainer.innerHTML = locations.map(function(loc) {
              var display = (loc.display_name || '')
                .replace(', –†–æ—Å—Å–∏—è', '').replace(', –ë–µ–ª–∞—Ä—É—Å—å', '').replace(', –†–æ—Å—Å–∏–π—Å–∫–∞—è –§–µ–¥–µ—Ä–∞—Ü–∏—è', '').replace(', Republic of Belarus', '');
              return '<div class="location-suggestion" data-value="' + (display.replace(/"/g, '&quot;')) + '">' + (display.replace(/</g, '&lt;')) + '</div>';
            }).join('');
            suggestionsContainer.style.display = 'block';
            suggestionsContainer.querySelectorAll('.location-suggestion').forEach(function(item) {
              item.addEventListener('click', function() {
                inputElement.value = item.getAttribute('data-value');
                suggestionsContainer.style.display = 'none';
                if (confirmCheckboxId) {
                  var checkbox = document.getElementById(confirmCheckboxId);
                  if (checkbox) checkbox.checked = true;
                }
              });
            });
          }
        } catch (err) {
          console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è:', err);
          if (suggestionsContainer) {
            suggestionsContainer.innerHTML = '<div style="padding: 10px; color: #ef4444; text-align: center;">' + t('searchError') + '</div>';
            suggestionsContainer.style.display = 'block';
          }
        }
      }
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.location-input-wrapper')) {
          document.querySelectorAll('.location-suggestions').forEach(function(el) { el.style.display = 'none'; });
        }
      });
      var userTariff = 'basic';
      var userProfile = null;
      var heroesCache = [];
      var editingHeroId = null;
      var pricingCatalog = [];
      var freeTrialAvailable = true;
      var hasSubscriptionActive = false;
      var catalogLoadError = false;
      var activePromo = null;
      var pendingPaymentRequestId = null;
      var pendingPaymentSku = null;
      var selectedMode = 'single';

      function getCurrentSku() {
        var modeSku = (typeof selectedMode !== 'undefined' && selectedMode) ? selectedMode : 'single';
        if (modeSku === 'couple') return 'couple_song';
        if (modeSku === 'transit') return 'transit_energy_song';
        return 'single_song';
      }
      // ‚îÄ‚îÄ Payment Overlay helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      function showPaymentOverlay() {
        var ov = document.getElementById('paymentOverlay');
        if (!ov) return;
        console.log('[Payment Overlay] –û—Ç–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –æ–ø–ª–∞—Ç—ã');
        console.log('[Payment Overlay] pendingPaymentRequestId:', pendingPaymentRequestId);
        console.log('[Payment Overlay] freeTrialAvailable:', freeTrialAvailable);
        
        ov.style.display = 'flex';
        if (tg && tg.expand) try { tg.expand(); } catch(e) {}
        
        // –°–±—Ä–æ—Å UI
        setPaymentStatus('', '');
        hidePromoConfirmButton();
        showPaymentSection();
        
        var pi = document.getElementById('payOvPromoInput');
        if (pi) pi.value = '';
        var promoSection = document.getElementById('payOvPromoSection');
        if (promoSection) promoSection.style.display = 'none';
        var promoToggle = document.getElementById('payOvPromoToggle');
        if (promoToggle) promoToggle.textContent = '‚ñ∏ –ï—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥?';
        
        var lr = document.getElementById('payOvLinkRow');
        if (lr) lr.style.display = 'none';
        
        var cb = document.getElementById('payOvCheckBtn');
        if (cb) cb.style.display = 'none';
        
        ov.scrollTop = 0;
        
        // Free trial –±–ª–æ–∫
        var freeClaimBtn = document.getElementById('payOvFreeClaimBtn');
        var hint = document.getElementById('payOvTrialHint');
        if (freeTrialAvailable) {
          if (freeClaimBtn) freeClaimBtn.style.display = '';
          if (hint) hint.style.display = '';
        } else {
          if (freeClaimBtn) freeClaimBtn.style.display = 'none';
          if (hint) hint.style.display = 'none';
        }
        
        updatePaymentUiFromCatalog();
      }
      function hidePaymentOverlay() {
        console.log('[Payment Overlay] –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –æ–ø–ª–∞—Ç—ã');
        var ov = document.getElementById('paymentOverlay');
        if (ov) ov.style.display = 'none';
        
        // –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
        setPaymentStatus('', '');
        activePromo = null;
        resetPaymentUI();
        
        var pi = document.getElementById('payOvPromoInput');
        if (pi) pi.value = '';
        
        var lr = document.getElementById('payOvLinkRow');
        if (lr) lr.style.display = 'none';
        
        var cb = document.getElementById('payOvCheckBtn');
        if (cb) cb.style.display = 'none';
      }
      // ‚îÄ‚îÄ –ù–∞–¥—ë–∂–Ω—ã–π —ç–∫—Ä–∞–Ω "–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞" ‚Äî position:fixed, z-index:10000 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      function showConfirm(title, desc) {
        hidePaymentOverlay();
        showConfirmOverlay(title, desc, function() { goToPage('successPage'); });
      }
      // –≠–∫—Ä–∞–Ω—ã ¬´–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞¬ª ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π, –≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–Ω –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ
      var _confirmAutoTimer = null;
      function showConfirmOverlay(title, desc, onDone) {
        hidePaymentOverlay();
        var ov = document.getElementById('confirmOverlay');
        if (!ov) { if (onDone) onDone(); return; }
        var tEl = document.getElementById('confirmTitle');
        var dEl = document.getElementById('confirmDesc');
        if (tEl) tEl.textContent = title || '‚ú® –ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!';
        if (dEl) dEl.innerHTML = desc || '–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é –ø–µ—Å–Ω—é.<br><br>üéµ –ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç. –ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç.';
        ov.style.display = 'block';
        // –¢–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–π –∫–ª–∏–∫ ‚Äî –±–µ–∑ –∞–≤—Ç–æ-—Å–∫—Ä—ã—Ç–∏—è
        var btn = document.getElementById('confirmContinueBtn');
        if (btn) {
          btn.onclick = function() { hideConfirmOverlay(); if (onDone) onDone(); };
        }
      }
      function hideConfirmOverlay() {
        if (_confirmAutoTimer) { clearTimeout(_confirmAutoTimer); _confirmAutoTimer = null; }
        var ov = document.getElementById('confirmOverlay');
        if (ov) ov.style.display = 'none';
        var btn = document.getElementById('confirmContinueBtn');
        if (btn) btn.onclick = null;
      }
      function setPaymentStatus(text, tone) {
        var el = document.getElementById('payOvStatus');
        if (!el) return;
        if (!text) { el.style.display = 'none'; return; }
        el.style.display = 'block';
        el.textContent = text;
        el.style.color = 'rgba(255,255,255,.95)';
        if (tone === 'ok')    { el.style.border = '1px solid rgba(212,175,55,.5)';  el.style.background = 'rgba(212,175,55,.18)'; return; }
        if (tone === 'warn')  { el.style.border = '1px solid rgba(212,175,55,.45)'; el.style.background = 'rgba(212,175,55,.12)'; return; }
        if (tone === 'error') { el.style.border = '1px solid rgba(236,72,153,.5)';  el.style.background = 'rgba(236,72,153,.12)'; return; }
        el.style.border = '1px solid rgba(212,175,55,.35)';
        el.style.background = 'rgba(212,175,55,.1)';
      }
      var DEFAULT_PRICES = { single_song: { title: 'Single song', price: '5.99', currency: 'USDT' }, couple_song: { title: 'Couple song', price: '8.99', currency: 'USDT' }, transit_energy_song: { title: 'Transit energy song', price: '6.99', currency: 'USDT' } };
      function updatePaymentUiFromCatalog() {
        try {
          var sku = getCurrentSku();
          var item = pricingCatalog.find(function(x) { return x && x.sku === sku; }) || DEFAULT_PRICES[sku] || null;
          
          var priceLabel = document.getElementById('priceLabel');
          var priceValue = document.getElementById('priceValue');
          var priceHint = document.getElementById('priceHint');
          var notice = document.getElementById('pricingNotice');
          
          if (priceLabel) priceLabel.textContent = item ? (item.title || sku) : sku;
          if (priceValue) {
            if (activePromo) {
              priceValue.textContent = String(activePromo.amount_after) + ' ' + (activePromo.currency || (item && item.currency) || 'USDT');
            } else {
              priceValue.textContent = item ? (String(item.price) + ' ' + (item.currency || 'USDT')) : '‚Äî';
            }
          }
          if (priceHint) {
            if (activePromo) {
              priceHint.textContent = t('promoAppliedHint', { code: activePromo.code, amount: activePromo.discount_amount, currency: activePromo.currency || (item && item.currency) || 'USDT' });
            } else {
              priceHint.textContent = '';
            }
          }
          if (notice) {
            if (catalogLoadError) {
              notice.textContent = t('catalogLoadFailed');
              notice.style.borderColor = 'rgba(212,175,55,.4)';
              notice.style.background = 'rgba(212,175,55,.12)';
              notice.style.color = 'rgba(255,255,255,.95)';
            } else if (hasSubscriptionActive) {
              notice.textContent = t('subscriptionActive');
              notice.style.borderColor = 'rgba(16,185,129,.4)';
              notice.style.background = 'rgba(16,185,129,.12)';
              notice.style.color = 'rgba(255,255,255,.95)';
            } else if (freeTrialAvailable) {
              notice.textContent = t('firstFree');
              notice.style.borderColor = 'rgba(212,175,55,.4)';
              notice.style.background = 'rgba(212,175,55,.12)';
              notice.style.color = 'rgba(255,255,255,.95)';
            } else {
              notice.textContent = t('paymentRequired');
              notice.style.borderColor = 'rgba(212,175,55,.35)';
              notice.style.background = 'rgba(212,175,55,.1)';
              notice.style.color = 'rgba(255,255,255,.95)';
            }
          }
          // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—É –≤ overlay (–Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç payOvPriceDisplay)
          var priceDisplay = document.getElementById('payOvPriceDisplay');
          var priceHintOv = document.getElementById('payOvPriceHint');
          if (priceDisplay) {
            if (activePromo) {
              priceDisplay.textContent = String(activePromo.amount_after) + ' ' + (activePromo.currency || (item && item.currency) || 'USDT');
            } else {
              priceDisplay.textContent = item ? (String(item.price) + ' ' + (item.currency || 'USDT')) : '5.99 USDT';
            }
          }
          if (priceHintOv) {
            if (activePromo && Number(activePromo.amount_after) > 0) {
              priceHintOv.textContent = 'üíö –°–∫–∏–¥–∫–∞: ' + activePromo.discount_amount + ' ' + (activePromo.currency || 'USDT');
            } else {
              priceHintOv.textContent = '';
            }
          }
          var subEl = document.getElementById('payOvSubtitle');
          if (subEl) subEl.textContent = item ? (item.title || '–¢–≤–æ—è –ø–µ—Å–Ω—è') : '–¢–≤–æ—è –ø–µ—Å–Ω—è';
          var cardTitleEl = document.getElementById('payOvCardTitle');
          if (cardTitleEl) cardTitleEl.textContent = item ? (item.title || '–û–ø–ª–∞—Ç–∞') : '–û–ø–ª–∞—Ç–∞ –∑–∞—è–≤–∫–∏';
        } catch (e) {
          console.warn('[updatePaymentUiFromCatalog]', e);
          var n = document.getElementById('pricingNotice');
          if (n) { n.textContent = t('catalogLoadFailed'); n.style.display = 'block'; }
        }
      }
      async function loadPricingCatalog() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = (tg && tg.initData) ? tg.initData : (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initData) || '';
        catalogLoadError = false;
        if (!apiBase) {
          catalogLoadError = true;
          updatePaymentUiFromCatalog();
          return;
        }
        try {
          var url = apiBase + '/api/pricing/catalog';
          var sep = url.indexOf('?') >= 0 ? '&' : '?';
          if (initData) url += sep + 'initData=' + encodeURIComponent(initData);
          var resp = await fetch(url, { headers: { 'X-Telegram-Init': initData } });
          var json = await resp.json().catch(function() { return {}; });
          if (resp.ok && json.success) {
            pricingCatalog = Array.isArray(json.catalog) ? json.catalog : [];
            freeTrialAvailable = !!(json.free_trial && json.free_trial.available);
            hasSubscriptionActive = !!(json.subscription_active);
            catalogLoadError = false;
            updatePaymentUiFromCatalog();
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–∏—Å—à—É—é –∑–∞—è–≤–∫—É (–Ω–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ —Å HOT Pay ‚Äî —Ç–∞–º –∑–∞—è–≤–∫–∞ —É–∂–µ –æ–ø–ª–∞—á–µ–Ω–∞)
            var _curSearch = typeof window.location !== 'undefined' ? (window.location.search || '') : '';
            if (_curSearch.indexOf('payment=success') === -1) {
              checkPendingRequestOnStart();
            }
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            loadReferralStats();
          } else {
            catalogLoadError = true;
            updatePaymentUiFromCatalog();
          }
        } catch (e) {
          console.warn('[loadPricingCatalog]', e);
          catalogLoadError = true;
          updatePaymentUiFromCatalog();
        }
      }
      // –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–ª–æ–∫ ¬´–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞¬ª
      async function loadReferralStats() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        if (!apiBase || !initData) return;
        try {
          var resp = await fetch(apiBase + '/api/referral/stats', { headers: { 'X-Telegram-Init': initData } });
          if (!resp.ok) return;
          var data = await resp.json().catch(function() { return null; });
          if (!data || !data.code || !data.link) return;
          var inp = document.getElementById('referralLinkInput');
          if (inp) inp.value = data.link || '';
          var inv = document.getElementById('refInvitedCount');
          if (inv) inv.textContent = data.invited_count || 0;
          var rew = document.getElementById('refRewardedCount');
          if (rew) rew.textContent = data.rewarded_count || 0;
          var crd = document.getElementById('refCreditsCount');
          if (crd) crd.textContent = data.credits || 0;
          var card = document.getElementById('referralCard');
          if (card) card.style.display = 'block';
        } catch (e) { console.warn('[Referral] –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:', e); }
      }

      // –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É ¬´–ü—Ä–æ—Ñ–∏–ª—å¬ª
      async function loadProfilePage() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        var avatarEl = document.getElementById('profileAvatar');
        var avatarInitialEl = document.getElementById('profileAvatarInitial');
        var nameEl = document.getElementById('profileName');
        var planBadgeEl = document.getElementById('profilePlanBadge');
        var creditsEl = document.getElementById('profileCreditsCount');
        var refLinkEl = document.getElementById('profileRefLinkInput');
        var refInvEl = document.getElementById('profileRefInvited');
        var refRewEl = document.getElementById('profileRefRewarded');
        if (nameEl) nameEl.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶';
        if (creditsEl) creditsEl.textContent = '‚Äî';
        if (refLinkEl) refLinkEl.value = '';
        if (refInvEl) refInvEl.textContent = '0';
        if (refRewEl) refRewEl.textContent = '0';
        var tgUser = tg && tg.initDataUnsafe && tg.initDataUnsafe.user;
        var displayName = (tgUser && tgUser.first_name) ? tgUser.first_name : '–ì–æ—Å—Ç—å';

        function setAvatarPhoto(src) {
          if (!avatarEl) return;
          var existing = avatarEl.querySelector('img');
          if (!existing) {
            var img = document.createElement('img');
            img.alt = 'avatar';
            avatarEl.insertBefore(img, avatarEl.firstChild);
            existing = img;
          }
          existing.src = src;
          existing.style.display = 'block';
          if (avatarInitialEl) avatarInitialEl.style.display = 'none';
        }

        // –°–Ω–∞—á–∞–ª–∞ ‚Äî –∏–Ω–∏—Ü–∏–∞–ª
        if (avatarInitialEl) avatarInitialEl.textContent = displayName.charAt(0).toUpperCase();
        // Telegram photo_url (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
        if (tgUser && tgUser.photo_url) setAvatarPhoto(tgUser.photo_url);
        if (!initData || !apiBase) {
          if (nameEl) nameEl.textContent = displayName;
          return;
        }
        try {
          var profileResp = await fetch(apiBase + '/api/user/profile', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ initData: initData })
          });
          var profileJson = await profileResp.json().catch(function() { return {}; });
          if (profileJson.profile && profileJson.profile.name) displayName = profileJson.profile.name;

          // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º referral + pricing
          var [refResp, pricingResp] = await Promise.allSettled([
            fetch(apiBase + '/api/referral/stats', { headers: { 'X-Telegram-Init': initData } }),
            fetch(apiBase + '/api/pricing/catalog', { headers: { 'X-Telegram-Init': initData } })
          ]);
          var refData = (refResp.status === 'fulfilled') ? await refResp.value.json().catch(function(){ return null; }) : null;
          var pricingData = (pricingResp.status === 'fulfilled') ? await pricingResp.value.json().catch(function(){ return null; }) : null;

          if (nameEl) nameEl.textContent = displayName;
          if (avatarInitialEl) avatarInitialEl.textContent = displayName.charAt(0).toUpperCase();

          // –§–æ—Ç–æ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã—à–µ Telegram photo_url)
          if (profileJson.profile && profileJson.profile.avatar_url) {
            setAvatarPhoto(profileJson.profile.avatar_url);
          }


          // –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏
          if (refLinkEl) refLinkEl.value = (refData && refData.link) ? refData.link : '';
          if (refInvEl) refInvEl.textContent = (refData && typeof refData.invited_count === 'number') ? refData.invited_count : 0;
          if (refRewEl) refRewEl.textContent = (refData && typeof refData.rewarded_count === 'number') ? refData.rewarded_count : 0;

          // --- –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ (–Ω–æ–≤—ã–π API) ---
          var subData = null;
          try {
            var subResp = await fetch(apiBase + '/api/subscription/status', { headers: { 'X-Telegram-Init': initData } });
            subData = await subResp.json().catch(function(){ return null; });
          } catch (subErr) {
            console.warn('[Profile] –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏:', subErr);
          }

          var balanceLabelEl = document.getElementById('profileBalanceLabel');
          var balanceHintEl = document.getElementById('profileBalanceHint');
          var renewalDateEl = document.getElementById('profileRenewalDate');

          // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤ –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
          var allPlanCards = ['planCardFree','planCardBasic','planCardPlus','planCardMaster'];
          var allPlanBtns = {
            planCardBasic: { btnId: 'planBtnBasic', origText: '–û—Ñ–æ—Ä–º–∏—Ç—å' },
            planCardPlus:  { btnId: 'planBtnPlus',  origText: '–û—Ñ–æ—Ä–º–∏—Ç—å' },
            planCardMaster:{ btnId: 'planBtnMaster', origText: '–û—Ç–∫—Ä—ã—Ç—å –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é' },
          };
          allPlanCards.forEach(function(id) {
            var card = document.getElementById(id);
            if (card) card.classList.remove('current');
          });
          Object.values(allPlanBtns).forEach(function(b) {
            var btn = document.getElementById(b.btnId);
            if (btn) { btn.textContent = b.origText; btn.disabled = false; btn.style.opacity = ''; }
          });

          var subActive = subData && subData.subscription_active;
          var planSku = subData && subData.plan_sku;
          var planName = (subData && subData.plan_name) || 'Free';

          // –ö–∞—Ä—Ç–∞ SKU ‚Üí ID –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ —Ü–≤–µ—Ç
          var planCardMap = {
            soul_basic_sub: { cardId: 'planCardBasic', btnId: 'planBtnBasic', color: '#d4af37', bg: 'rgba(212,175,55,0.12)', border: 'rgba(212,175,55,0.45)' },
            soul_plus_sub:  { cardId: 'planCardPlus',  btnId: 'planBtnPlus',  color: '#ec4899', bg: 'rgba(236,72,153,0.12)', border: 'rgba(236,72,153,0.45)' },
            master_monthly: { cardId: 'planCardMaster', btnId: 'planBtnMaster', color: '#a78bfa', bg: 'rgba(167,139,250,0.12)', border: 'rgba(167,139,250,0.45)' },
          };

          if (subActive && planSku && planCardMap[planSku]) {
            var pm = planCardMap[planSku];
            var tracksUsed = subData.tracks_used_this_month || 0;
            var tracksLimit = subData.tracks_limit || 0;
            var tracksRemaining = subData.tracks_remaining || 0;
            var renewAt = subData.renew_at;
            var renewDateStr = renewAt
              ? new Date(renewAt).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })
              : null;

            // –ë–µ–π–¥–∂ –ø–ª–∞–Ω–∞
            if (planBadgeEl) {
              planBadgeEl.textContent = '‚ú¶ ' + planName;
              planBadgeEl.style.background = pm.bg;
              planBadgeEl.style.borderColor = pm.border;
              planBadgeEl.style.color = pm.color;
            }

            // –ë–∞–ª–∞–Ω—Å-–∫–∞—Ä—Ç–æ—á–∫–∞: —Å—á—ë—Ç—á–∏–∫ —Ç—Ä–µ–∫–æ–≤
            if (balanceLabelEl) balanceLabelEl.textContent = '–¢—Ä–µ–∫–æ–≤ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ';
            if (creditsEl) creditsEl.textContent = tracksUsed + ' / ' + tracksLimit;
            if (balanceHintEl) balanceHintEl.textContent = tracksRemaining + ' —Ç—Ä–µ–∫–æ–≤ –µ—â—ë –¥–æ—Å—Ç—É–ø–Ω–æ';
            if (renewalDateEl && renewDateStr) {
              renewalDateEl.textContent = '–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è ' + renewDateStr;
              renewalDateEl.style.display = '';
            }

            // –í—ã–¥–µ–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É
            var cardFree = document.getElementById('planCardFree');
            if (cardFree) cardFree.classList.remove('current');
            var activeCard = document.getElementById(pm.cardId);
            if (activeCard) { activeCard.classList.add('current'); activeCard.style.borderColor = pm.border; }
            var activeBtn = document.getElementById(pm.btnId);
            if (activeBtn) { activeBtn.textContent = '‚úì –ê–∫—Ç–∏–≤–µ–Ω'; activeBtn.disabled = true; activeBtn.style.opacity = '0.5'; }

            // –ó–Ω–∞—á–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö (PNG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
            ['statusBasic','statusPlus','statusMaster'].forEach(function(sid) {
              var sb = document.getElementById(sid); if (!sb) return;
              var isThisActive = sid === 'status' + pm.cardId.replace('planCard','');
              sb.src = isThisActive ? 'assets/icons/status-active.png' : 'assets/icons/status-inactive.png';
              sb.alt = isThisActive ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ –∞–∫—Ç–∏–≤–µ–Ω';
            });

          } else {
            // Free –ø–ª–∞–Ω
            if (planBadgeEl) { planBadgeEl.textContent = '‚ú¶ YupSoul Free'; planBadgeEl.style.background = ''; planBadgeEl.style.borderColor = ''; planBadgeEl.style.color = ''; }
            var credits = (refData && typeof refData.credits === 'number') ? refData.credits : 0;
            if (creditsEl) creditsEl.textContent = credits;
            if (balanceLabelEl) balanceLabelEl.textContent = '–ë–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π';
            if (balanceHintEl) balanceHintEl.textContent = '–ü—Ä–∏–≤–µ–¥–∏ 5 –¥—Ä—É–∑–µ–π ‚Äî –ø–æ–ª—É—á–∏ —Ç—Ä–µ–∫ –≤ –ø–æ–¥–∞—Ä–æ–∫';
            if (renewalDateEl) renewalDateEl.style.display = 'none';
            // –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ ‚Äî —Ç–µ–∫—É—â–∞—è
            var cardFree2 = document.getElementById('planCardFree');
            if (cardFree2) cardFree2.classList.add('current');
            // –í—Å–µ –ø–ª–∞—Ç–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ ‚Äî –Ω–µ –∞–∫—Ç–∏–≤–Ω—ã
            ['statusBasic','statusPlus','statusMaster'].forEach(function(sid) {
              var sb = document.getElementById(sid); if (!sb) return;
              sb.src = 'assets/icons/status-inactive.png'; sb.alt = '–ù–µ –∞–∫—Ç–∏–≤–µ–Ω';
            });
          }
        } catch (e) {
          console.warn('[Profile] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', e);
          if (nameEl) nameEl.textContent = displayName;
          if (creditsEl) creditsEl.textContent = '‚Äî';
        }
      }

      // –ê–∫–∫–æ—Ä–¥–µ–æ–Ω: –æ—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å –ø–æ–ª—è —Ñ–æ—Ä–º—ã
      function toggleProfileAccordion() {
        var wrap = document.getElementById('formFieldsWrap');
        var chevron = document.getElementById('pfaChevron');
        if (!wrap) return;
        var isCollapsed = wrap.classList.contains('pfw-collapsed');
        if (isCollapsed) {
          wrap.classList.remove('pfw-collapsed');
          if (chevron) chevron.classList.remove('open');
        } else {
          wrap.classList.add('pfw-collapsed');
          if (chevron) chevron.classList.add('open');
        }
      }
      window.toggleProfileAccordion = toggleProfileAccordion;

      // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è + –∞–∫–∫–æ—Ä–¥–µ–æ–Ω –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤
      async function loadSavedProfileForForm() {
        var accordion = document.getElementById('profileAccordion');
        var formWrap = document.getElementById('formFieldsWrap');
        // –°–±—Ä–æ—Å: —Å–∫—Ä—ã–≤–∞–µ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è
        if (accordion) accordion.style.display = 'none';
        if (formWrap) { formWrap.classList.remove('pfw-collapsed'); }

        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        if (!apiBase || !initData) return;
        try {
          var resp = await fetch(apiBase + '/api/user/profile', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ initData: initData })
          });
          var json = await resp.json().catch(function() { return {}; });
          var p = json && json.profile;
          if (!p) return;

          // –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è —Ñ–æ—Ä–º—ã
          var nameEl = document.getElementById('name');
          var birthdateEl = document.getElementById('birthdate');
          var birthplaceEl = document.getElementById('birthplace');
          var birthtimeEl = document.getElementById('birthtime');
          var unknownEl = document.getElementById('unknown');
          if (nameEl && p.name) nameEl.value = p.name;
          if (birthdateEl && p.birthdate) {
            birthdateEl.value = p.birthdate;
            var parts = p.birthdate.split('-');
            if (parts.length === 3) {
              var dayEl = document.getElementById('birthdateDay');
              var monEl = document.getElementById('birthdateMonth');
              var yrEl  = document.getElementById('birthdateYear');
              if (dayEl) dayEl.value = parseInt(parts[2], 10);
              if (monEl) monEl.value = parseInt(parts[1], 10);
              if (yrEl)  yrEl.value  = parts[0];
              var checkEl = document.getElementById('birthdateCheck');
              if (checkEl) { checkEl.style.display = 'flex'; checkEl.style.opacity = '1'; }
            }
          }
          if (birthplaceEl && p.birthplace) birthplaceEl.value = p.birthplace;
          if (birthtimeEl && p.birthtime) birthtimeEl.value = p.birthtime;
          if (unknownEl && p.birthtime_unknown) unknownEl.checked = true;

          // –Ø–∑—ã–∫ –ø–µ—Å–Ω–∏
          var langEl = document.getElementById('language');
          if (langEl) {
            var tgLc = ((tg && tg.initDataUnsafe && tg.initDataUnsafe.user && tg.initDataUnsafe.user.language_code) || '').toLowerCase();
            var telegramSongLang = /^uk/.test(tgLc) ? 'uk' : /^en/.test(tgLc) ? 'en' : /^de/.test(tgLc) ? 'de' : /^fr/.test(tgLc) ? 'fr' : 'ru';
            var profileLang = p.language || '';
            if (profileLang && !(profileLang === 'ru' && telegramSongLang !== 'ru')) {
              langEl.value = profileLang;
            } else {
              langEl.value = telegramSongLang;
            }
          }

          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω –µ—Å–ª–∏ –µ—Å—Ç—å –∏–º—è (–º–∏–Ω–∏–º—É–º)
          if (p.name) {
            var pfaNameEl = document.getElementById('pfaName');
            var pfaDateEl = document.getElementById('pfaDate');
            var pfaSepEl  = document.getElementById('pfaSep');
            var chevronEl = document.getElementById('pfaChevron');
            if (pfaNameEl) pfaNameEl.textContent = p.name;
            if (p.birthdate) {
              var d = new Date(p.birthdate + 'T00:00:00');
              var dateStr = d.toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit', year: 'numeric' });
              if (pfaDateEl) pfaDateEl.textContent = dateStr;
              if (pfaSepEl) pfaSepEl.style.display = 'inline';
            }
            if (accordion) accordion.style.display = 'block';
            // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ø–æ–ª—è ‚Äî —Ñ–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
            if (formWrap) formWrap.classList.add('pfw-collapsed');
            if (chevronEl) chevronEl.classList.add('open');
          }
        } catch(e) {
          console.warn('[Form] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:', e);
        }
        // –î–µ—Ñ–æ–ª—Ç–Ω—ã–π —è–∑—ã–∫ –ø–æ Telegram
        var langElFallback = document.getElementById('language');
        if (langElFallback && !langElFallback.value) {
          var tgLcFb = ((tg && tg.initDataUnsafe && tg.initDataUnsafe.user && tg.initDataUnsafe.user.language_code) || '').toLowerCase();
          langElFallback.value = /^uk/.test(tgLcFb) ? 'uk' : /^en/.test(tgLcFb) ? 'en' : /^de/.test(tgLcFb) ? 'de' : /^fr/.test(tgLcFb) ? 'fr' : 'ru';
        }
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –µ—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å—à–∞—è –∑–∞—è–≤–∫–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ –∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö)
      async function checkPendingRequestOnStart() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        if (!apiBase || !initData) return;
        try {
          var resp = await fetch(apiBase + '/api/my/pending-request', { headers: { 'X-Telegram-Init': initData } });
          var json = await resp.json().catch(function() { return {}; });
          if (!resp.ok || !json.ok || !json.pending || !json.request_id) return;
          // –ï—Å—Ç—å –∑–∞–≤–∏—Å—à–∞—è –∑–∞—è–≤–∫–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
          pendingPaymentRequestId = json.request_id;
          pendingPaymentSku = json.sku || null;
          var banner = document.getElementById('recoveryBanner');
          var bannerText = document.getElementById('recoveryBannerText');
          var rb = document.getElementById('recoveryClaimBtn');
          if (banner) {
            if (freeTrialAvailable) {
              // –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Äî –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á
              if (bannerText) bannerText.innerHTML = 'üéÅ <strong style="color:#6ee7b7;">–¢–≤–æ—è –∑–∞—è–≤–∫–∞ –∂–¥—ë—Ç!</strong><br>–ü–æ–ª—É—á–∏ –ø–µ—Ä–≤—É—é –ø–µ—Å–Ω—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ.';
              if (rb) rb.textContent = 'üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ';
            } else {
              // –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Äî —É –Ω–µ–≥–æ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞
              if (bannerText) bannerText.innerHTML = '‚è≥ <strong style="color:#6ee7b7;">–ù–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π –∑–∞–∫–∞–∑</strong><br>–£ —Ç–µ–±—è –µ—Å—Ç—å –∑–∞—è–≤–∫–∞, –æ–∂–∏–¥–∞—é—â–∞—è –æ–ø–ª–∞—Ç—ã.';
              if (rb) rb.textContent = 'üí≥ –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ';
            }
            banner.style.display = 'block';
            // –ö–æ–≥–¥–∞ –±–∞–Ω–Ω–µ—Ä –∑–∞–∫–∞–∑–∞ –ø–æ–∫–∞–∑–∞–Ω ‚Äî —Å–∫—Ä—ã–≤–∞–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –±–ª–æ–∫ (–Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ–º —ç–∫—Ä–∞–Ω)
            var refCard = document.getElementById('referralCard');
            if (refCard) refCard.style.display = 'none';
            var dismissBtn = document.getElementById('recoveryDismissBtn');
            if (dismissBtn) dismissBtn.addEventListener('click', function() {
              banner.style.display = 'none';
              if (refCard) refCard.style.display = 'block';
              // –û—Ç–º–µ–Ω—è–µ–º –∑–∞—è–≤–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ ‚Äî –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ –±–∞–Ω–Ω–µ—Ä –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è
              var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
              var initData = getInitData();
              if (apiBase && initData && pendingPaymentRequestId) {
                fetch(apiBase + '/api/my/pending-request/dismiss', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
                  body: JSON.stringify({ request_id: pendingPaymentRequestId })
                }).catch(function() {});
              }
            });
            if (rb) rb.addEventListener('click', function() {
              banner.style.display = 'none';
              showPaymentOverlay();
            });
          }
        } catch (e) { /* –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ */ }
      }

      // ‚îÄ‚îÄ –¢–æ–≥–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      (function() {
        var toggle = document.getElementById('refStatsToggle');
        var block = document.getElementById('refStatsBlock');
        if (!toggle || !block) return;
        toggle.addEventListener('click', function() {
          var open = block.style.display !== 'none';
          block.style.display = open ? 'none' : 'flex';
          toggle.textContent = open ? '‚ñ∏ –º–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞' : '‚ñæ –º–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞';
          toggle.style.color = open ? 'rgba(212,175,55,0.4)' : 'rgba(212,175,55,0.7)';
          if (!open && typeof loadReferralStats === 'function') loadReferralStats();
        });
      })();

      // ‚îÄ‚îÄ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      (function() {
        var shareBtn = document.getElementById('referralShareBtn');
        if (!shareBtn) return;
        shareBtn.addEventListener('click', function() {
          var link = (document.getElementById('referralLinkInput') || {}).value || '';
          if (!link) return;
          var tgWeb = window.Telegram && window.Telegram.WebApp;
          if (tgWeb && tgWeb.openTelegramLink) {
            tgWeb.openTelegramLink('https://t.me/share/url?url=' + encodeURIComponent(link) +
              '&text=' + encodeURIComponent('–ü–æ–ª—É—á–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–µ—Å–Ω—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ –≤ YupSoul!'));
          } else if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(link).then(function() {
              shareBtn.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
              setTimeout(function() { shareBtn.textContent = '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è'; }, 2000);
            });
          } else {
            shareBtn.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
            setTimeout(function() { shareBtn.textContent = '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è'; }, 2000);
          }
        });
      })();

      // ‚îÄ‚îÄ Helper-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è UI –ø—Ä–æ–º–æ–∫–æ–¥–∞ –∏ –æ–ø–ª–∞—Ç—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      function showPromoConfirmButton() {
        var hint = document.getElementById('payOvPromoSuccessHint');
        var btn = document.getElementById('payOvPromoConfirmBtn');
        if (hint) hint.style.display = '';
        if (btn) btn.style.display = '';
      }

      function hidePromoConfirmButton() {
        var hint = document.getElementById('payOvPromoSuccessHint');
        var btn = document.getElementById('payOvPromoConfirmBtn');
        if (hint) hint.style.display = 'none';
        if (btn) btn.style.display = 'none';
      }

      function hidePaymentSection() {
        var section = document.getElementById('payOvPaymentSection');
        if (section) section.style.display = 'none';
      }

      function showPaymentSection() {
        var section = document.getElementById('payOvPaymentSection');
        if (section) section.style.display = '';
      }

      function updatePaymentSectionWithDiscount() {
        var priceDisplay = document.getElementById('payOvPriceDisplay');
        var priceHint = document.getElementById('payOvPriceHint');
        
        if (activePromo && priceDisplay) {
          priceDisplay.textContent = activePromo.amount_after + ' ' + activePromo.currency;
        }
        
        if (activePromo && priceHint) {
          priceHint.textContent = 'üíö –°–∫–∏–¥–∫–∞: ' + activePromo.discount_amount + ' ' + activePromo.currency;
        }
        
        showPaymentSection();
      }

      function resetPaymentUI() {
        hidePromoConfirmButton();
        showPaymentSection();
        
        var priceDisplay = document.getElementById('payOvPriceDisplay');
        var priceHint = document.getElementById('payOvPriceHint');
        
        // –°–±—Ä–æ—Å —Ü–µ–Ω—ã –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π (–∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞)
        if (priceDisplay && pricingCatalog && pricingCatalog.length) {
          var item = pricingCatalog.find(function(x) { return x && x.sku === pendingPaymentSku; });
          if (item) {
            priceDisplay.textContent = item.price + ' ' + (item.currency || 'USDT');
          }
        }
        
        if (priceHint) priceHint.textContent = '';
      }

      async function applyPromoCode() {
        var input = document.getElementById('payOvPromoInput') || document.getElementById('promoCodeInput');
        if (!input) return;
        var code = String(input.value || '').trim().toUpperCase();
        if (!code) {
          activePromo = null;
          resetPaymentUI();
          setPaymentStatus(t('promoCleared'), 'warn');
          return;
        }
        var sku = pendingPaymentSku;
        if (!sku) {
          setPaymentStatus('–°–Ω–∞—á–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤—å –∑–∞—è–≤–∫—É', 'error');
          return;
        }
        
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        if (!apiBase || !initData) {
          setPaymentStatus('–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
          return;
        }
        
        setPaymentStatus('–ü—Ä–æ–≤–µ—Ä—è—é –ø—Ä–æ–º–æ–∫–æ–¥...', 'warn');
        
        try {
          var resp = await fetch(apiBase + '/api/promos/validate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ code: code, sku: sku, initData: initData })
          });
          var json = await resp.json().catch(function() { return {}; });
          
          if (!resp.ok || !json.valid) {
            activePromo = null;
            resetPaymentUI();
            var errMsg = json.error || (json.reason === 'not_found' ? '–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω' : json.reason === 'expired' ? '–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞ –∏—Å—Ç—ë–∫' : json.reason === 'user_limit_reached' ? '–í—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥' : '–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω');
            throw new Error(errMsg);
          }
          
          activePromo = {
            code: code,
            sku: sku,
            amount_before: json.amount_before,
            amount_after: json.amount_after,
            discount_amount: json.discount_amount,
            currency: json.currency || 'USDT'
          };
          
          var isFree = Number(activePromo.amount_after) === 0;
          
          if (isFree) {
            // –ü—Ä–æ–º–æ–∫–æ–¥ –¥–∞—ë—Ç 100% —Å–∫–∏–¥–∫—É
            setPaymentStatus('‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω! –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–∞.', 'ok');
            showPromoConfirmButton();
            hidePaymentSection();
          } else {
            // –ü—Ä–æ–º–æ–∫–æ–¥ –¥–∞—ë—Ç —á–∞—Å—Ç–∏—á–Ω—É—é —Å–∫–∏–¥–∫—É
            setPaymentStatus('‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω! –°–∫–∏–¥–∫–∞: ' + activePromo.discount_amount + ' ' + activePromo.currency, 'ok');
            updatePaymentSectionWithDiscount();
            hidePromoConfirmButton();
          }
          
        } catch (e) {
          setPaymentStatus('‚ùå ' + (e.message || '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–º–æ–∫–æ–¥–∞'), 'error');
        }
      }
      function heroesApi(path, opts) {
        var base = (window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!base) return Promise.reject(new Error('API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω'));
        var initData = (tg && tg.initData) ? tg.initData : '';
        var url = base + '/api' + path;
        var sep = path.indexOf('?') >= 0 ? '&' : '?';
        if (initData && (!opts || opts.method === 'GET')) url += sep + 'initData=' + encodeURIComponent(initData);
        if (opts && opts.query) url += (url.indexOf('?') >= 0 ? '&' : '?') + opts.query;
        var options = { headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData } };
        if (opts && opts.method) options.method = opts.method;
        if (opts && opts.body) options.body = JSON.stringify(opts.body);
        return fetch(url, options).then(function(r) {
          if (r.status === 204) return null;
          return r.json().then(function(j) { if (!r.ok) throw new Error(j.error || r.statusText); return j; });
        });
      }
      function loadMe() {
        if (!(window.HEROES_API_BASE || '').replace(/\/$/, '')) return;
        heroesApi('/me', { method: 'POST', body: { initData: (tg && tg.initData) || '' } }).then(function(d) {
          userTariff = (d && d.tariff) || 'basic';
          var masterNav = document.getElementById('masterNav');
          if (masterNav && userTariff === 'master') masterNav.style.display = 'block';
        }).catch(function() {});
      }
      async function fetchUserProfile() {
        var base = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!base || !tg || !tg.initData) return null;
        try {
          var res = await fetch(base + '/api/user/profile', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': tg.initData },
            body: JSON.stringify({ initData: tg.initData })
          });
          var json = await res.json().catch(function() { return {}; });
          return json.profile || null;
        } catch (e) { return null; }
      }
      if (tg) loadMe();
      currentLang = detectLang();
      // #region agent log
      fetch('http://127.0.0.1:7243/ingest/dccd13d7-932e-4733-92f4-45355c9cfd86',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'public/index.html:1935',message:'Before applyTranslations',data:{previewCarouselExists:!!document.getElementById('previewCarousel'),startBtnExists:!!document.getElementById('startBtn'),startBtnText:document.getElementById('startBtn')?document.getElementById('startBtn').textContent:'NULL'},timestamp:Date.now(),hypothesisId:'A,B,C,D'})}).catch(()=>{});
      // #endregion
      applyTranslations();
      // #region agent log
      fetch('http://127.0.0.1:7243/ingest/dccd13d7-932e-4733-92f4-45355c9cfd86',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'public/index.html:1939',message:'After applyTranslations END',data:{startBtnText:document.getElementById('startBtn')?document.getElementById('startBtn').textContent:'NULL',previewSlide1Title:document.querySelectorAll('.preview-slide-title')[0]?document.querySelectorAll('.preview-slide-title')[0].textContent:'NULL',previewSlide1Color:document.querySelectorAll('.preview-slide-title')[0]?window.getComputedStyle(document.querySelectorAll('.preview-slide-title')[0]).color:'NULL',previewSlide1FontSize:document.querySelectorAll('.preview-slide-title')[0]?window.getComputedStyle(document.querySelectorAll('.preview-slide-title')[0]).fontSize:'NULL'},timestamp:Date.now(),hypothesisId:'A,B,C'})}).catch(()=>{});
      // #endregion
      
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // –û–ù–ë–û–†–î–ò–ù–ì ‚Äî —Ñ–æ—Ä–º–∞—Ç —Å—Ç–æ—Ä–∏—Å (–ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã + —Ç–∞–ø –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏)
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      (function() {
        var ONBOARDING_KEY = 'yupsoul_onboarding_seen';
        var TOTAL_SLIDES = 3;
        var SLIDE_DURATION = 4500;

        var onboardingPage = document.getElementById('onboardingPage');
        var homePage = document.getElementById('homePage');
        var slides = document.querySelectorAll('.onboarding-slide');
        var skipBtn = document.getElementById('onboardingSkip');
        var startBtn = document.getElementById('onboardingStartBtn');
        var tapPrev = document.getElementById('storiesTapPrev');
        var tapNext = document.getElementById('storiesTapNext');

        var currentStep = 1;
        var autoTimer = null;

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
        if (onboardingPage) onboardingPage.style.setProperty('--story-dur', (SLIDE_DURATION / 1000) + 's');

        // –ü–æ–ª—É—á–∞–µ–º fill-—ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤
        function getBar(i) { return document.getElementById('storyBar' + i); }

        function updateBars(activeStep) {
          for (var i = 1; i <= TOTAL_SLIDES; i++) {
            var fill = getBar(i);
            if (!fill) continue;
            // –°–±—Ä–æ—Å –∞–Ω–∏–º–∞—Ü–∏–∏
            fill.style.transition = 'none';
            if (i < activeStep) {
              fill.style.width = '100%'; // —É–∂–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω
            } else if (i === activeStep) {
              fill.style.width = '0%';
              // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow —á—Ç–æ–±—ã transition —Å—Ä–∞–±–æ—Ç–∞–ª
              void fill.offsetWidth;
              fill.style.transition = 'width ' + (SLIDE_DURATION / 1000) + 's linear';
              fill.style.width = '100%';
            } else {
              fill.style.width = '0%'; // –µ—â—ë –Ω–µ —Å–º–æ—Ç—Ä–µ–ª–∏
            }
          }
        }

        function showOnboarding() {
          if (onboardingPage) onboardingPage.style.display = 'flex';
          if (homePage) homePage.classList.remove('active');
          goToStep(1);
        }

        function hideOnboarding() {
          if (autoTimer) clearTimeout(autoTimer);
          if (onboardingPage) onboardingPage.style.display = 'none';
          var alreadyActive = document.querySelector('.page.active');
          if (!alreadyActive && homePage) homePage.classList.add('active');
          try { localStorage.setItem(ONBOARDING_KEY, 'true'); } catch(_) {}
        }

        function goToStep(step) {
          if (step < 1) { hideOnboarding(); return; }
          if (step > TOTAL_SLIDES) { hideOnboarding(); return; }

          if (autoTimer) clearTimeout(autoTimer);
          currentStep = step;

          slides.forEach(function(s) {
            s.classList.toggle('active', parseInt(s.dataset.step) === step);
          });

          updateBars(step);

          // –ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–∞–π–¥ (–ø–æ—Å–ª–µ–¥–Ω–∏–π ‚Äî –∑–∞–∫—Ä—ã—Ç—å)
          autoTimer = setTimeout(function() {
            goToStep(currentStep + 1);
          }, SLIDE_DURATION);
        }

        // –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç—å (X)
        if (skipBtn) skipBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          hideOnboarding();
        });

        // –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞—á–∞—Ç—å¬ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–ª–∞–π–¥–µ
        if (startBtn) startBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          hideOnboarding();
        });

        // –¢–∞–ø-–∑–æ–Ω—ã: –≤–ª–µ–≤–æ = –ø—Ä–µ–¥—ã–¥—É—â–∏–π, –≤–ø—Ä–∞–≤–æ = —Å–ª–µ–¥—É—é—â–∏–π
        if (tapPrev) tapPrev.addEventListener('click', function() { goToStep(currentStep - 1); });
        if (tapNext) tapNext.addEventListener('click', function() { goToStep(currentStep + 1); });

        // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–∞–π–ø–∞ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –∑–æ–Ω–∞–º —Ç–∞–ø–∞)
        var touchStartX = 0;
        if (onboardingPage) {
          onboardingPage.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
          }, { passive: true });
          onboardingPage.addEventListener('touchend', function(e) {
            var dx = e.changedTouches[0].screenX - touchStartX;
            if (Math.abs(dx) > 60) {
              if (dx < 0) goToStep(currentStep + 1);
              else goToStep(currentStep - 1);
            }
          }, { passive: true });
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –∏–ª–∏ –≥–µ–π—Ç
        var _urlParams = typeof window.location !== 'undefined' ? (window.location.search || '') : '';
        var _isPaymentReturn = _urlParams.indexOf('payment=success') !== -1;

        window.startApp = function() {
          if (_isPaymentReturn) {
            if (homePage) homePage.classList.add('active');
            try { localStorage.setItem(ONBOARDING_KEY, 'true'); } catch(_) {}
          } else {
            showOnboarding();
          }
        };
        var startApp = window.startApp;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–∂–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å /start –≤ –±–æ—Ç–µ
        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É: –±–µ–∑ initData (–±—Ä–∞—É–∑–µ—Ä/–ø—Ä–µ–≤—å—é) –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—Ç —Å –æ–ø–ª–∞—Ç—ã
        var _initDataForGate = getInitData ? getInitData() : '';
        var _apiBaseForGate = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (_initDataForGate && _apiBaseForGate && !_isPaymentReturn) {
          (function checkBotStarted() {
            var gateEl = document.getElementById('botGatePage');
            fetch(_apiBaseForGate + '/api/user/bot-status', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': _initDataForGate },
              body: JSON.stringify({ initData: _initDataForGate })
            })
            .then(function(r) { return r.json(); })
            .then(function(data) {
              if (data && data.started === false) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–µ–π—Ç
                if (gateEl) { gateEl.style.display = 'flex'; }
              } else {
                if (gateEl) gateEl.style.display = 'none';
                startApp();
              }
            })
            .catch(function() {
              // –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ ‚Äî –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º, –ø—É—Å–∫–∞–µ–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
              if (gateEl) gateEl.style.display = 'none';
              startApp();
            });
          })();
        } else {
          startApp();
        }
      })();

      // ‚îÄ‚îÄ –õ–æ–≥–∏–∫–∞ –≥–µ–π—Ç-—ç–∫—Ä–∞–Ω–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      (function initGateScreen() {
        var gateOpenBtn = document.getElementById('gateOpenBotBtn');
        var gateCheckBtn = document.getElementById('gateCheckBtn');
        var BOT_UN = window.BOT_USERNAME || 'Yup_Soul_bot';
        if (gateOpenBtn) {
          gateOpenBtn.addEventListener('click', function() {
            var botUrl = 'https://t.me/' + BOT_UN + '?start=mini_init';
            if (tg && tg.openTelegramLink) {
              tg.openTelegramLink(botUrl);
            } else {
              window.open(botUrl, '_blank');
            }
          });
        }
        if (gateCheckBtn) {
          gateCheckBtn.addEventListener('click', function() {
            gateCheckBtn.textContent = '–ü—Ä–æ–≤–µ—Ä—è–µ–º‚Ä¶';
            gateCheckBtn.disabled = true;
            var initData = getInitData ? getInitData() : '';
            var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
            if (!initData || !apiBase) { gateCheckBtn.textContent = '–£–∂–µ –Ω–∞–∂–∞–ª –°—Ç–∞—Ä—Ç ‚Üí –≤–æ–π—Ç–∏'; gateCheckBtn.disabled = false; return; }
            fetch(apiBase + '/api/user/bot-status', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
              body: JSON.stringify({ initData: initData })
            })
            .then(function(r) { return r.json(); })
            .then(function(data) {
              if (data && data.started) {
                var gateEl = document.getElementById('botGatePage');
                if (gateEl) gateEl.style.display = 'none';
                if (window.startApp) window.startApp();
              } else {
                gateCheckBtn.textContent = '–ï—â—ë –Ω–µ –Ω–∞–∂–∞—Ç –°—Ç–∞—Ä—Ç :(';
                setTimeout(function() { gateCheckBtn.textContent = '–£–∂–µ –Ω–∞–∂–∞–ª –°—Ç–∞—Ä—Ç ‚Üí –≤–æ–π—Ç–∏'; gateCheckBtn.disabled = false; }, 2000);
              }
            })
            .catch(function() {
              gateCheckBtn.textContent = '–£–∂–µ –Ω–∞–∂–∞–ª –°—Ç–∞—Ä—Ç ‚Üí –≤–æ–π—Ç–∏';
              gateCheckBtn.disabled = false;
            });
          });
        }
      })();

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–µ–º–æ-—Ä–µ–∂–∏–º –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
      function checkDemoMode() {
        if (window.demoMode || (!getInitData() && tg && tg.version)) {
          var demoIndicator = document.createElement('div');
          demoIndicator.id = 'demoIndicator';
          demoIndicator.style.cssText = 'position:fixed;top:10px;left:10px;background:rgba(255,165,0,0.9);color:white;padding:8px 12px;border-radius:6px;font-size:12px;z-index:9999;font-weight:600;';
          demoIndicator.textContent = 'üí° –î–ï–ú–û-–†–ï–ñ–ò–ú';
          document.body.appendChild(demoIndicator);
          console.log('[Demo] –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω');
        }
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–µ–º–æ-—Ä–µ–∂–∏–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
      setTimeout(checkDemoMode, 2000);
      (function initLangSwitcher() {
        var btn = document.getElementById('langSwitcherBtn');
        var dropdown = document.getElementById('langSwitcherDropdown');
        var opts = document.querySelectorAll('.lang-opt');
        function closeDropdown() { if (dropdown) dropdown.setAttribute('hidden', ''); }
        if (btn && dropdown) {
          btn.addEventListener('click', function(e) {
            e.stopPropagation();
            if (dropdown.getAttribute('hidden') !== null) dropdown.removeAttribute('hidden');
            else closeDropdown();
          });
          document.addEventListener('click', function() { closeDropdown(); });
          dropdown.addEventListener('click', function(e) { e.stopPropagation(); });
        }
        opts.forEach(function(o) {
          o.addEventListener('click', function() {
            var lang = o.getAttribute('data-lang');
            if (lang) { setLang(lang); closeDropdown(); }
          });
        });
      })();

      setTimeout(function() {
        try {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥ —Ü–µ–Ω, free trial, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–∏—Å—à–∏–µ –∑–∞—è–≤–∫–∏
        loadPricingCatalog();
        (function initProfile() {
          if (!tg || !tg.initData) return;
          fetchUserProfile().then(function(p) {
            userProfile = p;
            var greetEl = document.getElementById('homeGreeting');
            if (greetEl) {
              greetEl.textContent = (p && p.name) ? t('greeting', { name: p.name }) : t('greetingDefault');
              greetEl.style.display = 'block';
            }
          });
        })();
        if (!tg) {
          var p = document.getElementById('previewNav');
          if (p) p.classList.add('show');
          document.body.classList.add('preview-mode');
        }
        var todayStr = new Date().toISOString().split('T')[0];
        var minDate = new Date();
        minDate.setFullYear(minDate.getFullYear() - 100);
        var minDateStr = minDate.toISOString().split('T')[0];
        var birthdateEl = document.getElementById('birthdate');
        if (birthdateEl) {
          birthdateEl.max = todayStr;
          birthdateEl.min = minDateStr;
        }
        var birthdate2El = document.getElementById('birthdate2');
        if (birthdate2El) {
          birthdate2El.max = todayStr;
          birthdate2El.min = minDateStr;
        }
        var unknown = document.getElementById('unknown');
        var birthtime = document.getElementById('birthtime');
        if (unknown && birthtime) unknown.addEventListener('change', function() {
          birthtime.required = !unknown.checked;
        });
        var birthdateWrap = document.getElementById('birthdateWrap');
        var birthdateCheck = document.getElementById('birthdateCheck');
        var birthdateInput = document.getElementById('birthdate');
        var birthplaceInput = document.getElementById('birthplace');
        var monthsRu = ['—è–Ω–≤–∞—Ä—è','—Ñ–µ–≤—Ä–∞–ª—è','–º–∞—Ä—Ç–∞','–∞–ø—Ä–µ–ª—è','–º–∞—è','–∏—é–Ω—è','–∏—é–ª—è','–∞–≤–≥—É—Å—Ç–∞','—Å–µ–Ω—Ç—è–±—Ä—è','–æ–∫—Ç—è–±—Ä—è','–Ω–æ—è–±—Ä—è','–¥–µ–∫–∞–±—Ä—è'];
        var monthsRuNom = ['–Ø–Ω–≤–∞—Ä—å','–§–µ–≤—Ä–∞–ª—å','–ú–∞—Ä—Ç','–ê–ø—Ä–µ–ª—å','–ú–∞–π','–ò—é–Ω—å','–ò—é–ª—å','–ê–≤–≥—É—Å—Ç','–°–µ–Ω—Ç—è–±—Ä—å','–û–∫—Ç—è–±—Ä—å','–ù–æ—è–±—Ä—å','–î–µ–∫–∞–±—Ä—å'];
        function formatDateRu(dateStr) {
          if (!dateStr) return '';
          var d = new Date(dateStr + 'T12:00:00');
          if (isNaN(d.getTime())) return dateStr;
          return d.getDate() + ' ' + monthsRu[d.getMonth()] + ' ' + d.getFullYear() + ' –≥.';
        }
        (function initDateGroups() {
          var yearEnd = new Date().getFullYear();
          var yearStart = yearEnd - 100;
          function fillOneDateGroup(dayId, monthId, yearId, yearMax) {
            yearMax = yearMax || yearEnd;
            var dSel = document.getElementById(dayId);
            var mSel = document.getElementById(monthId);
            var ySel = document.getElementById(yearId);
            if (dSel) { dSel.innerHTML = '<option value="">–î–µ–Ω—å</option>'; for (var i = 1; i <= 31; i++) dSel.innerHTML += '<option value="' + i + '">' + i + '</option>'; }
            if (mSel) { mSel.innerHTML = '<option value="">–ú–µ—Å—è—Ü</option>'; for (var j = 1; j <= 12; j++) mSel.innerHTML += '<option value="' + j + '">' + monthsRuNom[j - 1] + '</option>'; }
            if (ySel) { ySel.innerHTML = '<option value="">–ì–æ–¥</option>'; for (var k = yearMax; k >= yearStart; k--) ySel.innerHTML += '<option value="' + k + '">' + k + '</option>'; }
          }
          function selectsToInput(dayId, monthId, yearId, inputId, wrapId, checkId) {
            var d = document.getElementById(dayId);
            var m = document.getElementById(monthId);
            var y = document.getElementById(yearId);
            var inp = document.getElementById(inputId);
            var wrap = wrapId ? document.getElementById(wrapId) : null;
            var chk = checkId ? document.getElementById(checkId) : null;
            if (!inp || !d || !m || !y) return;
            var day = parseInt(d.value, 10); var month = parseInt(m.value, 10); var year = parseInt(y.value, 10);
            if (!day || !month || !year) { inp.value = ''; if (wrap) wrap.classList.remove('has-date'); if (chk) chk.setAttribute('aria-hidden', 'true'); return; }
            var lastDay = new Date(year, month, 0).getDate();
            if (day > lastDay) day = lastDay;
            var yyyy = year; var mm = month < 10 ? '0' + month : '' + month; var dd = day < 10 ? '0' + day : '' + day;
            inp.value = yyyy + '-' + mm + '-' + dd;
            if (wrap) wrap.classList.add('has-date');
            if (chk) chk.setAttribute('aria-hidden', 'false');
          }
          function inputToSelects(inputId, dayId, monthId, yearId, wrapId, checkId) {
            var inp = document.getElementById(inputId);
            var d = document.getElementById(dayId);
            var m = document.getElementById(monthId);
            var y = document.getElementById(yearId);
            var wrap = wrapId ? document.getElementById(wrapId) : null;
            var chk = checkId ? document.getElementById(checkId) : null;
            if (!inp || !d || !m || !y) return;
            var v = (inp.value || '').trim();
            if (!v) { d.value = ''; m.value = ''; y.value = ''; if (wrap) wrap.classList.remove('has-date'); if (chk) chk.setAttribute('aria-hidden', 'true'); return; }
            var parts = v.split(/[-T]/);
            var yyyy = parseInt(parts[0], 10); var mm = parseInt(parts[1], 10); var dd = parseInt(parts[2], 10);
            if (isNaN(yyyy) || isNaN(mm) || isNaN(dd)) return;
            d.value = dd; m.value = mm; y.value = yyyy;
            if (wrap) wrap.classList.add('has-date');
            if (chk) chk.setAttribute('aria-hidden', 'false');
          }
          // yearEnd = —Ç–µ–∫—É—â–∏–π –≥–æ–¥: –º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è –≤–ø–ª–æ—Ç—å –¥–æ —Å–µ–≥–æ–¥–Ω—è (–≤ —Ç.—á. –¥–µ—Ç–µ–π)
          fillOneDateGroup('birthdateDay', 'birthdateMonth', 'birthdateYear', yearEnd);
          fillOneDateGroup('birthdate2Day', 'birthdate2Month', 'birthdate2Year', yearEnd);
          fillOneDateGroup('heroBirthdateDay', 'heroBirthdateMonth', 'heroBirthdateYear', yearEnd);
          [['birthdateDay','birthdateMonth','birthdateYear','birthdate','birthdateWrap','birthdateCheck'],
           ['birthdate2Day','birthdate2Month','birthdate2Year','birthdate2','birthdate2Wrap',null],
           ['heroBirthdateDay','heroBirthdateMonth','heroBirthdateYear','heroBirthdate','heroBirthdateWrap',null]].forEach(function(ids) {
            var dayId = ids[0], monthId = ids[1], yearId = ids[2], inputId = ids[3], wrapId = ids[4], checkId = ids[5];
            var onCh = function() { selectsToInput(dayId, monthId, yearId, inputId, wrapId, checkId); };
            var d = document.getElementById(dayId), m = document.getElementById(monthId), y = document.getElementById(yearId);
            if (d) d.addEventListener('change', onCh);
            if (m) m.addEventListener('change', onCh);
            if (y) y.addEventListener('change', onCh);
            inputToSelects(inputId, dayId, monthId, yearId, wrapId, checkId);
          });
          window.updateDateSelectsFromInput = function(inputId) {
            var map = { birthdate: ['birthdate','birthdateDay','birthdateMonth','birthdateYear','birthdateWrap','birthdateCheck'], birthdate2: ['birthdate2','birthdate2Day','birthdate2Month','birthdate2Year','birthdate2Wrap',null], heroBirthdate: ['heroBirthdate','heroBirthdateDay','heroBirthdateMonth','heroBirthdateYear','heroBirthdateWrap',null] };
            var cfg = map[inputId];
            if (cfg) inputToSelects(cfg[0], cfg[1], cfg[2], cfg[3], cfg[4], cfg[5]);
          };
        })();
        if (birthplaceInput) {
          var suggestionsEl = document.getElementById('birthplaceSuggestions');
          var wrap = document.getElementById('birthplaceWrap');
          var checkEl = document.getElementById('birthplaceCheck');
          var hintEl = document.getElementById('birthplaceHint');
          var debounceTimer = null;
          var lastSearch = '';
          function hideSuggestions() {
            if (suggestionsEl) { suggestionsEl.innerHTML = ''; suggestionsEl.setAttribute('aria-hidden', 'true'); suggestionsEl.style.display = 'none'; }
          }
          function showPlaceConfirm(displayName) {}
          function selectPlace(displayName, lat, lon) {
            var full = (displayName || '').trim();
            birthplaceInput.value = full;
            birthplaceInput.setAttribute('title', full);
            birthplaceInput.setAttribute('data-place-selected', '1');
            if (lat != null && lon != null) {
              birthplaceInput.setAttribute('data-lat', String(lat));
              birthplaceInput.setAttribute('data-lon', String(lon));
            }
            if (wrap) wrap.classList.add('has-place');
            if (checkEl) checkEl.setAttribute('aria-hidden', 'false');
            if (hintEl) hintEl.style.display = 'none';
            showPlaceConfirm(displayName);
            hideSuggestions();
          }
          function clearPlaceSelection() {
            birthplaceInput.removeAttribute('data-place-selected');
            birthplaceInput.removeAttribute('data-lat');
            birthplaceInput.removeAttribute('data-lon');
            if (wrap) wrap.classList.remove('has-place');
            if (checkEl) checkEl.setAttribute('aria-hidden', 'true');
            if (hintEl) hintEl.style.display = 'none';
          }
          function fetchPlaces(q) {
            if (!q || q.length < 2) { hideSuggestions(); return; }
            var url = 'https://nominatim.openstreetmap.org/search?q=' + encodeURIComponent(q) + '&format=json&limit=8&addressdetails=1';
            fetch(url, { headers: { 'Accept': 'application/json', 'Accept-Language': 'ru', 'User-Agent': 'YupSoulMiniApp/1.0 (contact@yupsoul.com)' } })
              .then(function(r) { return r.json(); })
              .then(function(list) {
                if (lastSearch !== q) return;
                if (!suggestionsEl) return;
                suggestionsEl.innerHTML = '';
                (list || []).forEach(function(item) {
                  var li = document.createElement('li');
                  var main = item.display_name || (item.address && (item.address.city || item.address.town || item.address.village || item.address.state || item.address.country));
                  var sub = item.address && item.address.country ? (item.address.country + (item.address.country_code ? ' (' + item.address.country_code.toUpperCase() + ')' : '')) : '';
                  li.textContent = main;
                  if (sub) { var sp = document.createElement('div'); sp.className = 'place-type'; sp.textContent = sub; li.appendChild(sp); }
                  var lat = item.lat; var lon = item.lon;
                  li.addEventListener('click', function() { selectPlace(item.display_name || main, lat, lon); });
                  suggestionsEl.appendChild(li);
                });
                suggestionsEl.style.display = (list && list.length) ? 'block' : 'none';
                suggestionsEl.setAttribute('aria-hidden', list && list.length ? 'false' : 'true');
              })
              .catch(function() { hideSuggestions(); });
          }
          birthplaceInput.addEventListener('input', function() {
            var v = birthplaceInput.value.trim();
            clearPlaceSelection();
            if (v) {
              lastSearch = v;
              clearTimeout(debounceTimer);
              debounceTimer = setTimeout(function() { fetchPlaces(v); }, 320);
            } else {
              hideSuggestions();
            }
          });
          birthplaceInput.addEventListener('focus', function() {
            var v = birthplaceInput.value.trim();
            var isSelected = !!birthplaceInput.getAttribute('data-place-selected');
            if (hintEl) hintEl.style.display = (!v && !isSelected) ? 'block' : 'none';
            if (v && v.length >= 2) { lastSearch = v; fetchPlaces(v); }
          });
          birthplaceInput.addEventListener('blur', function() {
            setTimeout(hideSuggestions, 200);
            if (hintEl) hintEl.style.display = 'none';
          });
          if (birthplaceInput.value.trim() && birthplaceInput.getAttribute('data-place-selected') && wrap) {
            wrap.classList.add('has-place');
            if (checkEl) checkEl.setAttribute('aria-hidden', 'false');
          }
        }
        var birthplace2Input = document.getElementById('birthplace2');
        if (birthplace2Input) {
          var sugg2El = document.getElementById('birthplaceSuggestions2');
          var wrap2El = document.getElementById('birthplace2Wrap');
          var check2El = document.getElementById('birthplace2Check');
          var hint2El = document.getElementById('birthplace2Hint');
          var debounce2 = null;
          var lastSearch2 = '';
          function hideSuggestions2() {
            if (sugg2El) { sugg2El.innerHTML = ''; sugg2El.setAttribute('aria-hidden', 'true'); sugg2El.style.display = 'none'; }
          }
          function selectPlace2(displayName, lat, lon) {
            var full = (displayName || '').trim();
            birthplace2Input.value = full;
            birthplace2Input.setAttribute('data-place-selected', '1');
            if (lat != null && lon != null) {
              birthplace2Input.setAttribute('data-lat', String(lat));
              birthplace2Input.setAttribute('data-lon', String(lon));
            }
            if (wrap2El) wrap2El.classList.add('has-place');
            if (check2El) check2El.setAttribute('aria-hidden', 'false');
            if (hint2El) hint2El.style.display = 'none';
            hideSuggestions2();
          }
          function clearPlace2Selection() {
            birthplace2Input.removeAttribute('data-place-selected');
            birthplace2Input.removeAttribute('data-lat');
            birthplace2Input.removeAttribute('data-lon');
            if (wrap2El) wrap2El.classList.remove('has-place');
            if (check2El) check2El.setAttribute('aria-hidden', 'true');
          }
          function fetchPlaces2(q) {
            if (!q || q.length < 2) { hideSuggestions2(); return; }
            var url = 'https://nominatim.openstreetmap.org/search?q=' + encodeURIComponent(q) + '&format=json&limit=8&addressdetails=1';
            fetch(url, { headers: { 'Accept': 'application/json', 'Accept-Language': 'ru', 'User-Agent': 'YupSoulMiniApp/1.0 (contact@yupsoul.com)' } })
              .then(function(r) { return r.json(); })
              .then(function(list) {
                if (lastSearch2 !== q) return;
                if (!sugg2El) return;
                sugg2El.innerHTML = '';
                (list || []).forEach(function(item) {
                  var li = document.createElement('li');
                  var main = item.display_name || (item.address && (item.address.city || item.address.town || item.address.village || item.address.state || item.address.country));
                  var sub = item.address && item.address.country ? (item.address.country + (item.address.country_code ? ' (' + item.address.country_code.toUpperCase() + ')' : '')) : '';
                  li.textContent = main;
                  if (sub) { var sp = document.createElement('div'); sp.className = 'place-type'; sp.textContent = sub; li.appendChild(sp); }
                  var lat = item.lat; var lon = item.lon;
                  li.addEventListener('click', function() { selectPlace2(item.display_name || main, lat, lon); });
                  sugg2El.appendChild(li);
                });
                sugg2El.style.display = (list && list.length) ? 'block' : 'none';
                sugg2El.setAttribute('aria-hidden', (list && list.length) ? 'false' : 'true');
              })
              .catch(function() { hideSuggestions2(); });
          }
          birthplace2Input.addEventListener('input', function() {
            var v = birthplace2Input.value.trim();
            clearPlace2Selection();
            if (v) { lastSearch2 = v; clearTimeout(debounce2); debounce2 = setTimeout(function() { fetchPlaces2(v); }, 320); }
            else { hideSuggestions2(); }
          });
          birthplace2Input.addEventListener('focus', function() {
            var v = birthplace2Input.value.trim();
            var isSelected2 = !!birthplace2Input.getAttribute('data-place-selected');
            if (hint2El) hint2El.style.display = (!v && !isSelected2) ? 'block' : 'none';
            if (v && v.length >= 2) { lastSearch2 = v; fetchPlaces2(v); }
          });
          birthplace2Input.addEventListener('blur', function() {
            setTimeout(hideSuggestions2, 200);
            if (hint2El) hint2El.style.display = 'none';
          });
        }
        var transitLocationInput = document.getElementById('transitLocation');
        if (transitLocationInput) {
          var debounceTransit = null;
          transitLocationInput.addEventListener('input', function() {
            var self = this;
            clearTimeout(debounceTransit);
            debounceTransit = setTimeout(function() { showLocationSuggestions(self, 'transitLocationSuggestions', 'transitLocationConfirmed'); }, 320);
          });
        }
        var formPage = document.getElementById('formPage');
        if (formPage && userTariff === 'master') loadForWhoSelect();
      
      // –ü–æ–¥—Å–∫–∞–∑–∫–∞ Soul Chat: –µ—Å—Ç—å –ª–∏ –¥–æ—Å—Ç—É–ø –∏ –∫–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å
      // ‚îÄ‚îÄ Soul Chat ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      var scCurrentRequestId = null;
      var scTimerInterval = null;

      function scShow(state) {
        ['scLoading','scGiftState','scActiveState','scPayState'].forEach(function(id) {
          var el = document.getElementById(id);
          if (el) el.style.display = (id === state) ? '' : 'none';
        });
      }

      function scStartTimer(expiresAt) {
        if (scTimerInterval) clearInterval(scTimerInterval);
        function tick() {
          var el = document.getElementById('scTimer');
          if (!el) return;
          var ms = new Date(expiresAt).getTime() - Date.now();
          if (ms <= 0) { el.textContent = '–í—Ä–µ–º—è –≤—ã—à–ª–æ'; clearInterval(scTimerInterval); initSoulChat(); return; }
          var h = Math.floor(ms / 3600000);
          var m = Math.floor((ms % 3600000) / 60000);
          var s = Math.floor((ms % 60000) / 1000);
          el.textContent = (h > 0 ? h + '—á ' : '') + m + '–º ' + s + '—Å –æ—Å—Ç–∞–ª–æ—Å—å';
        }
        tick();
        scTimerInterval = setInterval(tick, 1000);
      }

      function scAddMessage(role, text) {
        var hist = document.getElementById('scHistory');
        if (!hist) return;
        var isUser = (role === 'user');
        var div = document.createElement('div');
        div.style.cssText = 'padding:10px 14px;border-radius:12px;font-size:0.9rem;line-height:1.6;max-width:90%;' +
          (isUser
            ? 'align-self:flex-end;background:rgba(212,175,55,0.18);border:1px solid rgba(212,175,55,0.3);color:rgba(255,255,255,0.9);'
            : 'align-self:flex-start;background:rgba(255,255,255,0.07);border:1px solid rgba(255,255,255,0.12);color:rgba(255,255,255,0.9);');
        div.textContent = text;
        hist.appendChild(div);
        hist.scrollTop = hist.scrollHeight;
      }

      async function initSoulChat() {
        scShow('scLoading');
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = typeof getInitData === 'function' ? getInitData() : '';
        if (!apiBase || !initData) { scShow('scPayState'); return; }
        try {
          var r = await fetch(apiBase + '/api/soul-chat/access', { headers: { 'X-Telegram-Init': initData } });
          var d = await r.json().catch(function() { return {}; });
          // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞—è–≤–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–∞—Ç–∞
          if (d.last_request_id) scCurrentRequestId = d.last_request_id;
          if (d.allowed) {
            scShow('scActiveState');
            if (d.expires_at) scStartTimer(d.expires_at);
            // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
            var hist = document.getElementById('scHistory');
            if (hist && hist.children.length === 0) {
              scAddMessage('soul', '‚ú® –ü—Ä–∏–≤–µ—Ç! –Ø –∑–¥–µ—Å—å ‚Äî –∑–∞–¥–∞–≤–∞–π –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ —Å–µ–±–µ, —Å–≤–æ—ë–º –ø—É—Ç–∏ –∏ –¥—É—à–µ.');
            }
          } else if (d.trial_available) {
            scShow('scGiftState');
            } else {
            scShow('scPayState');
          }
        } catch(e) {
          scShow('scPayState');
        }
      }

      function updateSoulChatHint() { initSoulChat(); }

      // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∞—Ä–æ—á–Ω—ã–µ —Å—É—Ç–∫–∏
      var scActivateGiftBtn = document.getElementById('scActivateGiftBtn');
      if (scActivateGiftBtn) scActivateGiftBtn.addEventListener('click', async function() {
        scActivateGiftBtn.disabled = true;
        scActivateGiftBtn.textContent = '‚è≥ –ê–∫—Ç–∏–≤–∏—Ä—É—é...';
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = typeof getInitData === 'function' ? getInitData() : '';
        try {
          var r = await fetch(apiBase + '/api/soul-chat/activate-gift', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ initData: initData })
          });
          var d = await r.json().catch(function() { return {}; });
          if (d.success) {
            scShow('scActiveState');
            if (d.expires_at) scStartTimer(d.expires_at);
            scAddMessage('soul', 'üéÅ –ü—Ä–∏–≤–µ—Ç! –¢–≤–æ–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å—É—Ç–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã. –Ø –∑–¥–µ—Å—å ‚Äî –∑–∞–¥–∞–≤–∞–π –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã ‚ú®');
          } else {
            scActivateGiftBtn.disabled = false;
            scActivateGiftBtn.textContent = 'üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å—É—Ç–∫–∏';
            alert(d.error || '–û—à–∏–±–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏');
          }
        } catch(e) {
          scActivateGiftBtn.disabled = false;
          scActivateGiftBtn.textContent = 'üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å—É—Ç–∫–∏';
        }
      });

      // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å
      var scSendBtn = document.getElementById('scSendBtn');
      if (scSendBtn) scSendBtn.addEventListener('click', async function() {
        var qa = document.getElementById('scQuestion');
        var question = qa ? qa.value.trim() : '';
        if (!question) return;
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = typeof getInitData === 'function' ? getInitData() : '';
        scAddMessage('user', question);
        if (qa) qa.value = '';
        scSendBtn.disabled = true;
        scSendBtn.textContent = '‚ú® –°–ª—É—à–∞—é...';
        var thinkingDiv = document.createElement('div');
        thinkingDiv.id = 'scThinking';
        thinkingDiv.style.cssText = 'align-self:flex-start;color:rgba(212,175,55,0.65);font-size:0.85rem;padding:6px 0;';
        thinkingDiv.textContent = 'üí≠ –î—É—à–∞ –¥—É–º–∞–µ—Ç...';
        var hist = document.getElementById('scHistory');
        if (hist) hist.appendChild(thinkingDiv);
        try {
          var requestId = scCurrentRequestId || (typeof pendingPaymentRequestId !== 'undefined' ? pendingPaymentRequestId : null) || '';
          var r = await fetch(apiBase + '/api/soul-chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ request_id: requestId, question: question, initData: initData })
          });
          var d = await r.json().catch(function() { return {}; });
          if (thinkingDiv.parentNode) thinkingDiv.parentNode.removeChild(thinkingDiv);
          if (d.success && d.data && d.data.answer) {
            scAddMessage('soul', d.data.answer);
          } else if (d.need_payment) {
            scShow('scPayState');
          } else {
            scAddMessage('soul', '‚ùó ' + (d.error || '–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞'));
          }
        } catch(e) {
          if (thinkingDiv.parentNode) thinkingDiv.parentNode.removeChild(thinkingDiv);
          scAddMessage('soul', '‚ùó –ù–µ—Ç —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
        } finally {
          scSendBtn.disabled = false;
          scSendBtn.textContent = '–°–ø—Ä–æ—Å–∏—Ç—å –¥—É—à—É ‚ú®';
        }
      });

      // Ctrl+Enter –∏–ª–∏ Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
      var scQa = document.getElementById('scQuestion');
      if (scQa) scQa.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); if (scSendBtn) scSendBtn.click(); }
      });

      // –ö—É–ø–∏—Ç—å —Å—É—Ç–∫–∏
      var scBuyBtn = document.getElementById('scBuyBtn');
      if (scBuyBtn) scBuyBtn.addEventListener('click', async function() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = typeof getInitData === 'function' ? getInitData() : '';
        scBuyBtn.disabled = true;
        scBuyBtn.textContent = '‚è≥ –°–æ–∑–¥–∞—é —Å—Å—ã–ª–∫—É –æ–ø–ª–∞—Ç—ã...';
        try {
          var r = await fetch(apiBase + '/api/soul-chat/buy-day', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ initData: initData })
          });
          var d = await r.json().catch(function() { return {}; });
          if (d.success && d.checkout_url) {
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.openLink) {
              window.Telegram.WebApp.openLink(d.checkout_url, { try_instant_view: false });
            } else {
              window.open(d.checkout_url, '_blank');
            }
            scBuyBtn.textContent = '‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É';
            scBuyBtn.onclick = async function() {
              scBuyBtn.disabled = true;
              scBuyBtn.textContent = '‚è≥ –ü—Ä–æ–≤–µ—Ä—è—é...';
              await initSoulChat();
              scBuyBtn.disabled = false;
              scBuyBtn.textContent = 'üí≥ –ö—É–ø–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ —Å—É—Ç–∫–∏';
            };
          } else {
            alert(d.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –æ–ø–ª–∞—Ç—ã');
          }
        } catch(e) {
          alert('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
        } finally {
          if (scBuyBtn.textContent === '‚è≥ –°–æ–∑–¥–∞—é —Å—Å—ã–ª–∫—É –æ–ø–ª–∞—Ç—ã...') {
            scBuyBtn.disabled = false;
            scBuyBtn.textContent = 'üí≥ –ö—É–ø–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ —Å—É—Ç–∫–∏';
          }
        }
      });
      // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º
      function goToPage(pageId) {
        if (!pageId) {
          console.warn('[goToPage] pageId –ø—É—Å—Ç–æ–π ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ homePage');
          pageId = 'homePage';
        }
        var currentPage = document.querySelector('.page.active');
        
        if (tg && tg.MainButton && tg.MainButton.hide) tg.MainButton.hide();
        // #region agent log
        if (pageId === 'homePage') fetch('http://127.0.0.1:7243/ingest/dccd13d7-932e-4733-92f4-45355c9cfd86',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'public/index.html:goToPage',message:'homePage activated',data:{startBtnText:document.getElementById('startBtn')?document.getElementById('startBtn').textContent:'NULL',previewCarouselVisible:document.getElementById('previewCarousel')?window.getComputedStyle(document.getElementById('previewCarousel')).display:'NULL'},timestamp:Date.now(),hypothesisId:'D'})}).catch(()=>{});
        // #endregion
        // –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–Ω–æ–ø–∫—É –æ–ø–ª–∞—Ç—ã –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
        ensurePayButtonText();
        
        document.querySelectorAll('.page').forEach(function(page) {
          page.classList.remove('active');
        });
        // –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π —Å–∫—Ä—ã–≤–∞–µ–º –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –µ—Å–ª–∏ –æ–Ω –æ—Å—Ç–∞–ª—Å—è –≤–∏–¥–∏–º—ã–º
        var obp = document.getElementById('onboardingPage');
        if (obp && obp.style.display !== 'none') obp.style.display = 'none';
        
        var target = document.getElementById(pageId);
        
        if (!target) {
          console.warn('[goToPage] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:', pageId, '‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ homePage');
          target = document.getElementById('homePage');
          if (!target) return;
        }
        target.classList.add('active');
        // –ò–∫–æ–Ω–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è ‚Äî –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–∞ –≤–Ω—É—Ç—Ä–∏ #homeTopBar (–Ω–µ –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å)
        // –°–±—Ä–æ—Å —Å–∫—Ä–æ–ª–ª–∞ —É –≤—Å–µ—Ö .page-scroll –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ
        try {
          var scrollArea = document.querySelector('#' + pageId + ' .page-scroll');
          if (scrollArea) scrollArea.scrollTop = 0;
        } catch(e) {}
        if (pageId === 'formPage' && userTariff === 'master') loadForWhoSelect();
        if (pageId === 'formPage') loadSavedProfileForForm();
        if (pageId === 'homePage' && typeof loadReferralStats === 'function') loadReferralStats();
        if (pageId === 'profilePage' && typeof loadProfilePage === 'function') loadProfilePage();
        // paymentPage —Ç–µ–ø–µ—Ä—å overlay ‚Äî –∑–¥–µ—Å—å –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
        if (pageId === 'successPage') updateSoulChatHint();
        if (document.getElementById('previewNav') && document.getElementById('previewNav').classList.contains('show')) {
          document.querySelectorAll('.preview-nav button').forEach(function(btn) {
            btn.classList.remove('active');
          });
          var pageMap = { 'homePage': 'home', 'formPage': 'form', 'paymentPage': 'payment', 'loadingPage': 'loading', 'successPage': 'success', 'heroesPage': 'heroes', 'paymentThanksPage': 'payment' };
          var activeBtn = document.querySelector('.preview-nav button[data-page="' + (pageMap[pageId] || '') + '"]');
          if (activeBtn) activeBtn.classList.add('active');
        }
      }
      // –î–µ–ª–∞–µ–º goToPage –≥–ª–æ–±–∞–ª—å–Ω–æ–π ‚Äî –Ω—É–∂–Ω–æ –¥–ª—è onclick-–∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–∫–Ω–æ–ø–∫–∞ –ü–æ–º–æ—â—å, –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥)
      window.goToPage = goToPage;
      window.returnToPage = null;
      function goBack() {
        var target = window.returnToPage || 'homePage';
        window.returnToPage = null;
        goToPage(target);
      }
      window.goBack = goBack;
      function goToProfileFrom(from) { window.returnToPage = from; goToPage('profilePage'); }
      function goToHeroesFrom(from) { window.returnToPage = from; goToPage('heroesPage'); initHeroesPage(); }
      function goToHelpFrom(from) { window.returnToPage = from; goToPage('helpPage'); }
      window.goToProfileFrom = goToProfileFrom;
      window.goToHeroesFrom = goToHeroesFrom;
      window.goToHelpFrom = goToHelpFrom;

      // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –±–ª–æ–∫
      var referralToggleBtn = document.getElementById('referralToggleBtn');
      if (referralToggleBtn) {
        referralToggleBtn.addEventListener('click', function() {
          var body = document.getElementById('referralBody');
          var chevron = document.getElementById('referralToggleChevron');
          if (!body) return;
          var isOpen = body.style.display !== 'none';
          body.style.display = isOpen ? 'none' : 'block';
          if (chevron) chevron.style.transform = isOpen ? '' : 'rotate(90deg)';
          if (!isOpen && typeof loadReferralStats === 'function') loadReferralStats();
        });
      }

      // –†–µ–¥–∏—Ä–µ–∫—Ç —Å HOT: –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å ?payment=success –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É ¬´–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É¬ª
      var search = typeof window.location !== 'undefined' && window.location.search ? window.location.search : '';
      var paymentThanksMsg = document.getElementById('paymentThanksMessage');
      if (search.indexOf('payment=success') !== -1) {
        goToPage('paymentThanksPage');
        var requestIdMatch = search.match(/request_id=([^&\s]+)/);
        var thanksRequestId = requestIdMatch ? decodeURIComponent(requestIdMatch[1]) : null;
        (async function checkPaymentAndConfirm() {
          if (!paymentThanksMsg) return;
          if (!thanksRequestId) {
            paymentThanksMsg.textContent = t('songInProgress');
            return;
          }
          var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
          var initData = (tg && tg.initData) ? tg.initData : (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initData) || '';
          if (!apiBase || !initData) {
            if (paymentThanksMsg) paymentThanksMsg.textContent = t('songInProgress');
            return;
          }
          try {
            var payStatus = '';
            for (var attempt = 0; attempt < 3; attempt++) {
              var statusResp = await fetch(apiBase + '/api/payments/hot/status?request_id=' + encodeURIComponent(thanksRequestId), {
                headers: { 'X-Telegram-Init': initData }
              });
              var statusJson = await statusResp.json().catch(function() { return {}; });
              payStatus = statusJson && statusJson.data && statusJson.data.payment_status ? String(statusJson.data.payment_status).toLowerCase() : '';
              if (payStatus === 'paid') break;
              if (attempt < 2) await new Promise(function(r) { setTimeout(r, 2000); });
            }
            if (payStatus === 'paid') {
              var confirmResp = await fetch(apiBase + '/api/payments/hot/confirm', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
                body: JSON.stringify({ request_id: thanksRequestId, initData: initData })
              });
              confirmResp.json().catch(function() {});
            }
            paymentThanksMsg.textContent = t('songInProgressConfirmed');
          } catch (e) {
            paymentThanksMsg.textContent = t('songInProgress');
          }
        })();
        if (window.history && window.history.replaceState) {
          var cleanUrl = window.location.pathname + (window.location.hash || '');
          window.history.replaceState({}, '', cleanUrl);
        }
      }
      var paymentThanksBackBtn = document.getElementById('paymentThanksBackBtn');
      if (paymentThanksBackBtn) paymentThanksBackBtn.addEventListener('click', function() {
        goToPage('formPage');
      });

      // –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
      var startBtn = document.getElementById('startBtn');
      if (startBtn) startBtn.addEventListener('click', function() {
        fillFormFromProfile(userProfile || (tg && tg.initDataUnsafe && tg.initDataUnsafe.user));
        goToPage('formPage');
      });


      var stepNext = document.getElementById('stepNext');

      function applyTheme() {
        // –§–æ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç—ë–º–Ω—ã–π, –ø–æ—ç—Ç–æ–º—É —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ç—ë–º–Ω—É—é —Ç–µ–º—É,
        // –∏–Ω–∞—á–µ –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ Telegram —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å "–Ω–µ–≤–∏–¥–∏–º—ã–º–∏".
        var theme = 'theme-dark';
        document.body.classList.remove('theme-light', 'theme-dark');
        document.body.classList.add(theme);
      }
      applyTheme();
      try {
        if (tg && tg.onEvent) tg.onEvent('themeChanged', applyTheme);
      } catch (_) {}

      function toggleFormsByMode(mode) {
        var secondForm = document.getElementById('secondPersonForm');
        var transitForm = document.getElementById('transitForm');
        if (secondForm) secondForm.style.display = 'none';
        if (transitForm) transitForm.style.display = 'none';
        if (mode === 'couple' && secondForm) {
          secondForm.style.display = 'block';
        } else if (mode === 'transit' && transitForm) {
          transitForm.style.display = 'block';
        }
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º relationship person2 –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–µ–∂–∏–º–∞
        if (mode !== 'couple') {
          var p2r = document.getElementById('person2Relationship');
          if (p2r) p2r.value = '';
        }
      }

      function updateStepUI() {
        document.querySelectorAll('.mode-btn').forEach(function(btn) { btn.style.display = ''; });
      }

      function setMode(mode) {
        selectedMode = mode || 'single';
        document.querySelectorAll('.mode-btn').forEach(function(btn) {
          btn.classList.toggle('active', btn.getAttribute('data-mode') === selectedMode);
        });
        toggleFormsByMode(selectedMode);
        updatePaymentUiFromCatalog();
      }

      function validateStep(step) {
        if (step === 1) {
          selectedMode = selectedMode || 'single';
          return true;
        }
        if (step === 2) {
          var nameEl = document.getElementById('name');
          var name = (nameEl ? nameEl.value : '').trim();
          var birthdateEl = document.getElementById('birthdate');
          var birthdate = birthdateEl ? birthdateEl.value : '';
          var birthplaceEl = document.getElementById('birthplace');
          var birthplace = (birthplaceEl ? birthplaceEl.value : '').trim();
          var unknownEl = document.getElementById('unknown');
          var birthtimeEl = document.getElementById('birthtime');
          var birthtimeVal = (unknownEl && unknownEl.checked) ? 'ok' : (birthtimeEl ? birthtimeEl.value : '');
          var genderEl = document.getElementById('gender');
          var gender = genderEl ? genderEl.value : '';
          var langEl = document.getElementById('language');
          var language = langEl ? langEl.value : '';
          if (name.length < 2) { alert(t('alertNameShort')); return false; }
          if (!birthdate) { alert(t('alertBirthdate')); return false; }
          if (birthplace.length < 3) { alert(t('alertBirthplace')); return false; }
          var birthplaceField = document.getElementById('birthplace');
          var hasCoords = birthplaceField && birthplaceField.getAttribute('data-lat') && birthplaceField.getAttribute('data-lon');
          var hasPlaceSelected = birthplaceField && birthplaceField.getAttribute('data-place-selected');
          var fromProfile = birthplaceField && birthplaceField.getAttribute('data-from-profile') === '1';
          if (!hasCoords && !hasPlaceSelected && !fromProfile) {
            var birthplaceHint = document.getElementById('birthplaceHint');
            if (birthplaceHint) birthplaceHint.style.display = 'block';
            try { birthplaceField && birthplaceField.scrollIntoView({ behavior: 'smooth', block: 'center' }); } catch (_) {}
            alert(t('alertBirthplaceHint'));
            return false;
          }
          if (!birthtimeVal) { alert(t('alertBirthtime')); return false; }
          if (!gender) { alert(t('alertGender')); return false; }
          if (!language) { alert(t('alertLanguage')); return false; }
          if (selectedMode === 'couple') {
            var name2 = (document.getElementById('name2').value || '').trim();
            var birthdate2 = document.getElementById('birthdate2').value;
            var birthplace2El = document.getElementById('birthplace2');
            var birthplace2 = birthplace2El ? birthplace2El.value.trim() : '';
            var bp2PlaceSelected = birthplace2El && birthplace2El.getAttribute('data-place-selected');
            var bp2FromProfile = birthplace2El && birthplace2El.getAttribute('data-from-profile') === '1';
            if (name2.length < 2) { alert(t('alertName2Short')); return false; }
            if (!birthdate2) { alert(t('alertBirthdate2')); return false; }
            if (birthplace2.length < 3) { alert(t('alertBirthplace2')); return false; }
            if (!bp2PlaceSelected && !bp2FromProfile) {
              alert(t('alertBirthplaceHint'));
              try { birthplace2El && birthplace2El.scrollIntoView({ behavior: 'smooth', block: 'center' }); } catch (_) {}
              return false;
            }
            var birthtime2Val = (document.getElementById('unknown2') && document.getElementById('unknown2').checked) ? 'ok' : (document.getElementById('birthtime2') ? document.getElementById('birthtime2').value : '');
            if (!birthtime2Val) { alert(t('alertBirthtime2')); return false; }
            if (!(document.getElementById('gender2') && document.getElementById('gender2').value)) { alert(t('alertGender2')); return false; }
          }
          if (selectedMode === 'transit') {
            var tDate = document.getElementById('transitDate').value;
            var tLoc = document.getElementById('transitLocation').value.trim();
            if (!tDate) { alert(t('alertTransitDate')); return false; }
            if (!tLoc) { alert(t('alertTransitLocation')); return false; }
          }
          return true;
        }
        if (step === 3) {
          var request = document.getElementById('request').value.trim();
          if (request.length < 5) { alert(t('alertRequestShort')); return false; }
          return true;
        }
        return true;
      }

      document.querySelectorAll('.mode-btn').forEach(function(btn) {
        btn.addEventListener('click', function(e) {
          if (e.target.classList.contains('mode-info')) return;
          setMode(this.getAttribute('data-mode'));
        });
      });

      // –¢—É–ª—Ç–∏–ø –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–µ–∂–∏–º–∞
      (function() {
        var tooltip = document.getElementById('modeTooltip');
        var tooltipTimer = null;
        function hideTooltip() {
          if (tooltip) tooltip.style.display = 'none';
          clearTimeout(tooltipTimer);
        }
        document.querySelectorAll('.mode-info').forEach(function(icon) {
          icon.addEventListener('click', function(e) {
            e.stopPropagation();
            if (!tooltip) return;
            var descEl = this.closest('.mode-btn').querySelector('.mode-desc');
            var text = descEl ? descEl.textContent.trim() : '';
            if (!text) return;
            tooltip.textContent = text;
            var rect = this.getBoundingClientRect();
            tooltip.style.display = 'block';
            var tw = tooltip.offsetWidth || 180;
            var left = Math.min(rect.left, window.innerWidth - tw - 12);
            tooltip.style.left = Math.max(8, left) + 'px';
            tooltip.style.top = (rect.bottom + 8) + 'px';
            clearTimeout(tooltipTimer);
            tooltipTimer = setTimeout(hideTooltip, 3000);
          });
        });
        document.addEventListener('click', hideTooltip);
      })();

      (function() {
        var pickerBtn = document.getElementById('quickPickerBtn');
        var pickerSheet = document.getElementById('quickPickerSheet');
        if (!pickerBtn || !pickerSheet) return;

        function closeSheet() {
          pickerSheet.style.display = 'none';
          pickerBtn.classList.remove('open');
        }
        function openSheet() {
          pickerSheet.style.display = 'block';
          pickerBtn.classList.add('open');
        }

        pickerBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          if (pickerSheet.style.display === 'none') openSheet();
          else closeSheet();
        });

        document.addEventListener('click', function(e) {
          if (pickerSheet.style.display === 'none') return;
          if (!pickerBtn.closest('.quick-picker').contains(e.target)) closeSheet();
        });

        pickerSheet.querySelectorAll('.quick-item').forEach(function(item) {
          item.addEventListener('click', function() {
            var requestField = document.getElementById('request');
            if (requestField) {
              requestField.value = this.getAttribute('data-text') || '';
              requestField.focus();
            }
            closeSheet();
          });
        });
      })();

      if (stepNext) stepNext.addEventListener('click', async function() {
        if (!validateStep(1) || !validateStep(2) || !validateStep(3)) return;
        var mode = selectedMode || 'single';
        var name1 = document.getElementById('name').value.trim();
        var birthdate1 = document.getElementById('birthdate').value;
        var birthplace1 = document.getElementById('birthplace').value.trim();
        var birthtime1 = document.getElementById('birthtime').value;
        var birthtimeUnknown1 = document.getElementById('unknown').checked;
        var gender1 = document.getElementById('gender').value;
        var requestText = document.getElementById('request').value.trim();
        if (name1.length < 2) { alert(t('alertNameShort')); return; }
        if (!birthdate1) { alert(t('alertBirthdate')); return; }
        if (birthplace1.length < 3) { alert(t('alertBirthplace')); return; }
        if (!birthtimeUnknown1 && !birthtime1) { alert(t('alertBirthtime')); return; }
        if (!gender1) { alert(t('alertGender')); return; }
        if (requestText.length < 15) { alert(t('alertRequestLong')); return; }
        var songLangEl = document.getElementById('language');
        var songLanguage = (songLangEl && songLangEl.value) ? songLangEl.value : 'ru';
        var payload = {
          mode: mode,
          person1: { name: name1, birthdate: birthdate1, birthplace: birthplace1, birthtime: birthtimeUnknown1 ? null : birthtime1, birthtimeUnknown: birthtimeUnknown1, gender: gender1 },
          request: requestText,
          language: songLanguage
        };
        // –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ ‚Äî –ø–µ—Ä–µ–¥–∞—ë–º –µ–≥–æ —Å–µ—Ä–≤–µ—Ä—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –î–û 402
        if (activePromo && activePromo.code) {
          payload.promo_code = activePromo.code;
        }
        var birthplaceField = document.getElementById('birthplace');
        if (birthplaceField && birthplaceField.getAttribute('data-lat') && birthplaceField.getAttribute('data-lon')) {
          payload.person1.birthplaceLat = parseFloat(birthplaceField.getAttribute('data-lat'));
          payload.person1.birthplaceLon = parseFloat(birthplaceField.getAttribute('data-lon'));
        }
        var forWho = document.getElementById('forWho');
        if (forWho && forWho.value && userTariff === 'master') payload.clientId = forWho.value;
        if (mode === 'couple') {
          var name2 = document.getElementById('name2').value.trim();
          var birthdate2 = document.getElementById('birthdate2').value;
          var birthplace2 = document.getElementById('birthplace2').value.trim();
          var birthtime2 = document.getElementById('birthtime2').value;
          var birthtimeUnknown2 = document.getElementById('unknown2').checked;
          var gender2 = document.getElementById('gender2').value;
          if (name2.length < 2) { alert(t('alertName2Short')); return; }
          if (!birthdate2) { alert(t('alertBirthdate2')); return; }
          if (birthplace2.length < 3) { alert(t('alertBirthplace2')); return; }
          if (!birthtimeUnknown2 && !birthtime2) { alert(t('alertBirthtime2')); return; }
          if (!gender2) { alert(t('alertGender2')); return; }
          var p2relField = document.getElementById('person2Relationship');
          var relationship2 = p2relField ? p2relField.value.trim() : '';
          payload.person2 = { name: name2, birthdate: birthdate2, birthplace: birthplace2, birthtime: birthtimeUnknown2 ? null : birthtime2, birthtimeUnknown: birthtimeUnknown2, gender: gender2 };
          if (relationship2) payload.person2.relationship = relationship2;
          var bp2Field = document.getElementById('birthplace2');
          if (bp2Field && bp2Field.getAttribute('data-lat') && bp2Field.getAttribute('data-lon')) {
            payload.person2.birthplaceLat = parseFloat(bp2Field.getAttribute('data-lat'));
            payload.person2.birthplaceLon = parseFloat(bp2Field.getAttribute('data-lon'));
          }
        }
        if (mode === 'transit') {
          var transitDate = document.getElementById('transitDate').value;
          var transitTime = document.getElementById('transitTime').value;
          var transitLocation = (document.getElementById('transitLocation') && document.getElementById('transitLocation').value) ? document.getElementById('transitLocation').value.trim() : '';
          var transitIntent = (document.getElementById('transitIntent') && document.getElementById('transitIntent').value) ? document.getElementById('transitIntent').value.trim() : null;
          if (!transitDate) { alert(t('alertTransitDate')); return; }
          if (!transitLocation) { alert(t('alertTransitLocation')); return; }
          if (!(document.getElementById('transitLocationConfirmed') && document.getElementById('transitLocationConfirmed').checked)) { alert(t('alertTransitConfirm')); return; }
          payload.transit = { date: transitDate, time: transitTime || null, location: transitLocation, intent: transitIntent || null };
        }
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!apiBase) { alert(t('alertNoApi')); return; }
        var initData = getInitData();
        if (!initData) { alert(t('alertOpenFromBot')); return; }
        payload.initData = initData;

        try {
          var checkRes = await fetch(apiBase + '/api/check-chat', { method: 'POST', headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData }, body: JSON.stringify({ initData: initData }) });
          var checkJson = await checkRes.json().catch(function() { return {}; });
          if (checkJson.chat_available === false) {
            alert(checkJson.error || '–°–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–º–∏—Ç–µ ¬´–°—Ç–∞—Ä—Ç¬ª –≤ –±–æ—Ç–µ (–∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ), –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É —Å–Ω–æ–≤–∞.');
            return;
          }
        } catch (checkErr) {
          // –µ—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ ‚Äî –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É
        }

        var stepNextOriginalText = stepNext.textContent;
        stepNext.disabled = true;
        stepNext.textContent = t('sending');
        try {
          var controller = new AbortController();
          var timeoutId = setTimeout(function() { controller.abort(); }, 90000);
          var response = await fetch(apiBase + '/api/submit-request', { method: 'POST', headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData }, body: JSON.stringify(payload), signal: controller.signal });
          clearTimeout(timeoutId);
          var result = await response.json().catch(function() { return {}; });

          if (response.ok && result.ok && result.requestId && !result.payment_required) {
            if (typeof scCurrentRequestId !== 'undefined') scCurrentRequestId = result.requestId;
            if (tg && tg.disableClosingConfirmation) try { tg.disableClosingConfirmation(); } catch (e) {}
            showConfirmOverlay('‚ú® –ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞, ' + name1 + '!', '–ü–µ—Å–Ω—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –Ω–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ. –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ ‚Äî –ø—Ä–∏–¥—ë—Ç —Å—é–¥–∞ –≤ —ç—Ç–æ—Ç —á–∞—Ç —Å –±–æ—Ç–æ–º.<br><br>–ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –æ—Å—Ç–∞—ë—à—å—Å—è —Å –Ω–∞–º–∏ ‚ù§Ô∏è<br><br><span style="font-size:0.9em;color:rgba(255,255,255,0.6)">–ù–µ—Ç –ø–µ—Å–Ω–∏? –ù–∞–ø–∏—à–∏ –±–æ—Ç—É ¬´–ø–µ—Å–Ω—è –Ω–µ –ø—Ä–∏—à–ª–∞¬ª.</span>', function() { goToPage('successPage'); });
          } else if ((response.status === 402 || (result && result.payment_required)) && result.requestId) {
            console.log('[Submit] 402 Payment Required ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã');
            console.log('[Submit] requestId:', result.requestId, 'sku:', result.sku);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –∑–∞—è–≤–∫–∏ –∏ SKU –¥–ª—è –æ–ø–ª–∞—Ç—ã
            pendingPaymentRequestId = result.requestId;
            pendingPaymentSku = result.sku || getCurrentSku();
            activePromo = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–º–æ–∫–æ–¥ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π)
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –∏ –æ–±–Ω–æ–≤–ª—è–µ–º UI
            showPaymentOverlay();
            updatePaymentUiFromCatalog();
            setPaymentStatus('', '');
          } else {
            var errMsg = result.error || result.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É.';
            if (response.status === 503) errMsg = t('alertServerSleep');
            stepNext.disabled = false;
            stepNext.textContent = stepNextOriginalText;
            alert(errMsg);
            return;
          }
        } catch (e) {
          stepNext.disabled = false;
          stepNext.textContent = stepNextOriginalText;
          if (e && e.name === 'AbortError') { alert(t('alertServerSleep')); return; }
          if (e && e.message) alert(t('alertSubmitError') + ': ' + e.message);
          return;
        }
        stepNext.disabled = false;
        stepNext.textContent = stepNextOriginalText;
      });
      setMode('single');
      updateStepUI();
      // ‚îÄ‚îÄ Overlay: –∫–Ω–æ–ø–∫–∞ ¬´–ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥¬ª ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      var payOvPromoBtn = document.getElementById('payOvPromoBtn');
      if (payOvPromoBtn) payOvPromoBtn.addEventListener('click', applyPromoCode);
      var payOvPromoToggle = document.getElementById('payOvPromoToggle');
      if (payOvPromoToggle) payOvPromoToggle.addEventListener('click', function() {
        var section = document.getElementById('payOvPromoSection');
        if (!section) return;
        var isOpen = section.style.display !== 'none';
        section.style.display = isOpen ? 'none' : 'block';
        payOvPromoToggle.textContent = isOpen ? '‚ñ∏ –ï—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥?' : '‚ñæ –°–≤–µ—Ä–Ω—É—Ç—å';
      });

      // ‚îÄ‚îÄ Overlay: –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å¬ª (–ø—Ä–æ–º–æ–∫–æ–¥ 100%) ‚îÄ‚îÄ
      var payOvPromoConfirmBtn = document.getElementById('payOvPromoConfirmBtn');
      if (payOvPromoConfirmBtn) payOvPromoConfirmBtn.addEventListener('click', async function() {
        console.log('[Promo Confirm] –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞');
        
        if (!pendingPaymentRequestId) {
          setPaymentStatus('‚ùå –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞—è–≤–∫–∏', 'error');
          return;
        }
        
        if (!activePromo || Number(activePromo.amount_after) !== 0) {
          setPaymentStatus('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –¥–∞—ë—Ç 100% —Å–∫–∏–¥–∫—É', 'error');
          return;
        }
        
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        if (!apiBase || !initData) {
          setPaymentStatus('‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
          return;
        }
        
        payOvPromoConfirmBtn.disabled = true;
        payOvPromoConfirmBtn.textContent = '‚è≥ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é...';
        setPaymentStatus('üéÅ –ü—Ä–∏–º–µ–Ω—è—é –ø—Ä–æ–º–æ–∫–æ–¥...', 'ok');
        
        try {
          var resp = await fetch(apiBase + '/api/payments/hot/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({
              request_id: pendingPaymentRequestId,
              promo_code: activePromo.code,
              initData: initData
            })
          });
          
          var json = await resp.json().catch(function() { return {}; });
          
          if (!resp.ok || !json.success) {
            throw new Error(json.error || json.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞');
          }
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–æ–º–æ–∫–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–∞–ª –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
          if (json.free_applied || (json.provider === 'promo' && Number(json.amount) === 0)) {
            console.log('[Promo Confirm] –ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω —É—Å–ø–µ—à–Ω–æ');
            pendingPaymentRequestId = null;
            pendingPaymentSku = null;
            activePromo = null;
            
            hidePaymentOverlay();
            showConfirm(
              'üéÅ –ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω!',
              '–¢–≤–æ—è –ø–µ—Å–Ω—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏ —Å–∫–æ—Ä–æ –ø—Ä–∏–¥—ë—Ç –≤ –±–æ—Ç.<br><br>üéµ –ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç. –ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç.'
            );
          } else {
            throw new Error('–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –¥–∞–ª –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø');
          }
          
        } catch (e) {
          console.error('[Promo Confirm] –û—à–∏–±–∫–∞:', e);
          setPaymentStatus('‚ùå ' + (e.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞'), 'error');
          payOvPromoConfirmBtn.disabled = false;
          payOvPromoConfirmBtn.textContent = 'üéÅ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å';
        }
      });

      // ‚îÄ‚îÄ Overlay: –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á¬ª (–ø–µ—Ä–≤—ã–π –ø–æ–¥–∞—Ä–æ—á–Ω—ã–π –¥–æ—Å—Ç—É–ø) ‚îÄ‚îÄ
      var payOvFreeClaimBtn = document.getElementById('payOvFreeClaimBtn');
      if (payOvFreeClaimBtn) payOvFreeClaimBtn.addEventListener('click', async function() {
        console.log('[Free Trial] –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á"');
        console.log('[Free Trial] pendingPaymentRequestId:', pendingPaymentRequestId);
        
        if (!pendingPaymentRequestId) {
          setPaymentStatus('‚ùå –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞—è–≤–∫–∏. –ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É –∑–∞–Ω–æ–≤–æ.', 'error');
          return;
        }
        
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        if (!apiBase || !initData) {
          setPaymentStatus('‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü—Ä–æ–≤–µ—Ä—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.', 'error');
          return;
        }
        
        payOvFreeClaimBtn.disabled = true;
        payOvFreeClaimBtn.textContent = '‚è≥ –ê–∫—Ç–∏–≤–∏—Ä—É—é –ø–æ–¥–∞—Ä–æ–∫...';
        setPaymentStatus('üéÅ –ê–∫—Ç–∏–≤–∏—Ä—É—é –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø...', 'ok');
        
        try {
          var resp = await fetch(apiBase + '/api/free-trial/claim', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ request_id: pendingPaymentRequestId, initData: initData })
          });
          var json = await resp.json().catch(function() { return {}; });
          
          if (resp.ok && json.ok) {
            console.log('[Free Trial] –ü–æ–¥–∞—Ä–æ–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ');
            pendingPaymentRequestId = null;
            pendingPaymentSku = null;
            showConfirm('üéÅ –ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è –≤ –ø–æ–¥–∞—Ä–æ–∫!', '–°–æ–∑–¥–∞—ë–º —Ç–≤–æ—é –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–µ—Å–Ω—é.<br><br>üéµ –ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç. –ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç.');
          } else {
            var errMsg = json.error || json.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∞—Ä–æ–∫';
            console.warn('[Free Trial] –û—à–∏–±–∫–∞:', errMsg);
            setPaymentStatus('‚ùå ' + errMsg, 'error');
            payOvFreeClaimBtn.disabled = false;
            payOvFreeClaimBtn.textContent = 'üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –ø–µ—Å–Ω—é';
          }
        } catch (e) {
          console.error('[Free Trial] –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:', e);
          setPaymentStatus('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞.', 'error');
          payOvFreeClaimBtn.disabled = false;
          payOvFreeClaimBtn.textContent = 'üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –ø–µ—Å–Ω—é';
        }
      });

      // ‚îÄ‚îÄ Overlay: –∫–Ω–æ–ø–∫–∞ ¬´–ù–∞–∑–∞–¥¬ª ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      var payOvBackBtn = document.getElementById('payOvBackBtn');
      if (payOvBackBtn) payOvBackBtn.addEventListener('click', function() {
        hidePaymentOverlay();
        if (tg && tg.MainButton && tg.MainButton.hide) tg.MainButton.hide();
      });

      // ‚îÄ‚îÄ Overlay: –∫–Ω–æ–ø–∫–∞ ¬´–Ø —É–∂–µ –æ–ø–ª–∞—Ç–∏–ª¬ª ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      var payOvCheckBtn = document.getElementById('payOvCheckBtn');
      if (payOvCheckBtn) payOvCheckBtn.addEventListener('click', async function() {
        if (!pendingPaymentRequestId) { setPaymentStatus('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞—è–≤–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏', 'error'); return; }
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = getInitData();
        if (!apiBase || !initData) { setPaymentStatus('–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error'); return; }
        payOvCheckBtn.disabled = true;
        payOvCheckBtn.textContent = '‚è≥ –ü—Ä–æ–≤–µ—Ä—è—é...';
        setPaymentStatus('–ü—Ä–æ–≤–µ—Ä—è—é —Å—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã...', 'warn');
        try {
          var st = '';
          for (var i = 0; i < 5; i++) {
            var r = await fetch(apiBase + '/api/payments/hot/status?request_id=' + encodeURIComponent(pendingPaymentRequestId), { headers: { 'X-Telegram-Init': initData } });
            var j = await r.json().catch(function() { return {}; });
            st = j && j.data && j.data.payment_status ? String(j.data.payment_status).toLowerCase() : '';
            if (st === 'paid') break;
            if (i < 4) await new Promise(function(res) { setTimeout(res, 1500); });
          }
          if (st === 'paid') {
            setPaymentStatus('‚úÖ –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞! –ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ...', 'ok');
            await fetch(apiBase + '/api/payments/hot/confirm', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
              body: JSON.stringify({ request_id: pendingPaymentRequestId, initData: initData })
            }).catch(function(){});
            pendingPaymentRequestId = null; pendingPaymentSku = null;
            setTimeout(function() { hidePaymentOverlay(); showConfirm('‚ú® –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!', '–ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–≤–æ–µ–π –ø–µ—Å–Ω–∏.<br><br>üéµ –ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç. –ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç.'); }, 1200);
          } else {
            setPaymentStatus('–û–ø–ª–∞—Ç–∞ –ø–æ–∫–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ü–æ–¥–æ–∂–¥–∏ –Ω–µ–º–Ω–æ–≥–æ –∏ –ø—Ä–æ–≤–µ—Ä—å —Å–Ω–æ–≤–∞.', 'warn');
          }
        } catch(e) {
          setPaymentStatus('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: ' + (e && e.message ? e.message : '–ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞'), 'error');
        } finally {
          payOvCheckBtn.disabled = false;
          payOvCheckBtn.textContent = '‚úÖ –Ø —É–∂–µ –æ–ø–ª–∞—Ç–∏–ª ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å';
        }
      });

      // ‚îÄ‚îÄ Overlay: –∫–Ω–æ–ø–∫–∞ ¬´–û–ø–ª–∞—Ç–∏—Ç—å¬ª ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      var payBtn = document.getElementById('payOvPayBtn');
      if (payBtn) payBtn.addEventListener('click', async function() {
        console.log('[HOT Pay] –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã');
        
        if (payBtn.disabled) {
          console.log('[HOT Pay] –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–ª–∏–∫');
          return;
        }
        
        if (!pendingPaymentRequestId) {
          console.error('[HOT Pay] –ö–†–ò–¢–ò–ß–ù–û: –ù–µ—Ç pendingPaymentRequestId!');
          setPaymentStatus('‚ùå –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É –∏ –æ—Ç–ø—Ä–∞–≤—å –∑–∞—è–≤–∫—É', 'error');
          return;
        }
        
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        if (!apiBase) { 
          console.error('[HOT Pay] –ù–µ—Ç API –±–∞–∑–æ–≤–æ–≥–æ URL');
          alert(t('alertNoApi')); 
          return; 
        }
        
        var initData = getInitData();
        if (!initData) { 
          console.error('[HOT Pay] –ù–µ—Ç initData - –ø—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π Telegram');
          
          if (window.demoMode) {
            console.log('[HOT Pay] –î–µ–º–æ-—Ä–µ–∂–∏–º: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
            alert('üí° –î–µ–º–æ-—Ä–µ–∂–∏–º\n\n' +
                  '–î–ª—è –æ–ø–ª–∞—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ Telegram –±–æ—Ç–∞ @YupSoul_bot\n\n' +
                  'üì± –ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å:\n' +
                  '1. –û—Ç–∫—Ä–æ–π—Ç–µ @YupSoul_bot –≤ Telegram\n' +
                  '2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –º–µ–Ω—é (‚ò∞) –∏–ª–∏ "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"\n' +
                  '3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ –æ–ø–ª–∞—Ç–∏—Ç–µ');
            return;
          }
          
          var errorMessage = '‚ö†Ô∏è –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Telegram!\n\n' +
                            'üîß –†–µ—à–µ–Ω–∏—è:\n' +
                            '‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –±–æ—Ç–∞ @YupSoul_bot (–∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é ‚ò∞)\n' +
                            '‚Ä¢ –û–±–Ω–æ–≤–∏—Ç–µ Telegram –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏\n' +
                            '‚Ä¢ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Telegram\n' +
                            '‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ web.telegram.org\n\n' +
                            'üí° –í–∞—à–∞ –≤–µ—Ä—Å–∏—è Telegram: ' + (tg && tg.version ? tg.version : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞');
          
          if (confirm(errorMessage + '\n\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ?')) {
            window.demoMode = true;
            alert('üí° –î–µ–º–æ-—Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω\n\n–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É, –Ω–æ –æ–ø–ª–∞—Ç–∞ –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.');
          }
          return; 
        }
        
        console.log('[HOT Pay] –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, apiBase:', apiBase);
        console.log('[HOT Pay] pendingPaymentRequestId:', pendingPaymentRequestId);
        console.log('[HOT Pay] Telegram WebApp –¥–æ—Å—Ç—É–ø–µ–Ω:', !!(window.Telegram && window.Telegram.WebApp));
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –¥–ª—è –æ–ø–ª–∞—Ç—ã
        if (tg && tg.version) {
          var version = parseFloat(tg.version) || 0;
          if (version < 6.1) {
            console.warn('[HOT Pay] –í–µ—Ä—Å–∏—è Telegram (' + tg.version + ') –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É');
            alert('‚ö†Ô∏è –î–ª—è –æ–ø–ª–∞—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª–µ–µ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è Telegram!\n\n' +
                  'üì± –í–∞—à–∞ –≤–µ—Ä—Å–∏—è: ' + tg.version + '\n' +
                  '‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è: 6.1 –∏–ª–∏ –≤—ã—à–µ\n\n' +
                  'üîÑ –û–±–Ω–æ–≤–∏—Ç–µ Telegram –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞');
            return;
          }
        }

        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –ü–†–û–í–ï–†–ï–ù–ù–´–ô –ø—Ä–æ–º–æ–∫–æ–¥ (activePromo). –ï—Å–ª–∏ –≤ –ø–æ–ª–µ —Ç–µ–∫—Å—Ç, –Ω–æ activePromo=null ‚Äî
        // –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–º–æ–∫–æ–¥ –±—ã–ª –æ—Ç–∫–ª–æ–Ω—ë–Ω, –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ.
        var promoCode = activePromo ? activePromo.code : null;
        var hotPayload = {
          request_id: pendingPaymentRequestId,
          sku: pendingPaymentSku,
          promo_code: promoCode || null,
          initData: initData
        };

        payBtn.disabled = true;
        payBtn.textContent = t('sending');
        console.log('[HOT Pay] –ù–∞—á–∏–Ω–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞, payload:', hotPayload);
        
        try {
          var hotCtrl = new AbortController();
          var hotTimeout = setTimeout(function() { hotCtrl.abort(); }, 30000);
          console.log('[HOT Pay] –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞:', apiBase + '/api/payments/hot/create');
          
          var hotResp = await fetch(apiBase + '/api/payments/hot/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify(hotPayload),
            signal: hotCtrl.signal
          });
          clearTimeout(hotTimeout);
          
          console.log('[HOT Pay] –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞, —Å—Ç–∞—Ç—É—Å:', hotResp.status, hotResp.ok);
          var hotJson = await hotResp.json().catch(function(e) { 
            console.error('[HOT Pay] –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', e); 
            return {}; 
          });
          console.log('[HOT Pay] –î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:', hotJson);

          if (!hotResp.ok || !hotJson.success) {
            var errorMsg = hotJson.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ–ø–ª–∞—Ç—É HOT';
            console.error('[HOT Pay] –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞:', errorMsg);
            console.error('[HOT Pay] –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:', hotResp.status, hotResp.statusText);
            
            if (hotResp.status === 401) {
              errorMsg = '–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401). –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–æ –∏–∑ Telegram –±–æ—Ç–∞!';
              console.error('[HOT Pay] –ö–†–ò–¢–ò–ß–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ —Å initData - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ –∏–∑ Telegram');
            } else if (hotResp.status === 403) {
              errorMsg = '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω (403). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.';
            } else if (hotResp.status >= 500) {
              errorMsg = '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (' + hotResp.status + '). –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
            }
            
            throw new Error(errorMsg);
          }
          // –ö–†–ò–¢–ò–ß–ù–û: –ï—Å–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥ –¥–∞–ª 100% —Å–∫–∏–¥–∫—É –∏–ª–∏ free_applied ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
          if (hotJson.free_applied || (hotJson.success && hotJson.provider === 'promo' && Number(hotJson.amount) === 0)) {
            console.log('[HOT Pay] –ü—Ä–æ–º–æ–∫–æ–¥ –¥–∞–ª –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è');
            pendingPaymentRequestId = null;
            pendingPaymentSku = null;
            activePromo = null;
            showConfirmOverlay('‚ú® –ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!', '–ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω! üéÅ<br><br>–ü–µ—Å–Ω—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –Ω–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ ‚Äî –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞, –ø—Ä–∏–¥—ë—Ç —Å—é–¥–∞ –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º. –ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç. –°–ø–∞—Å–∏–±–æ ‚ù§Ô∏è<br><br><span style="font-size:0.9em;color:rgba(255,255,255,0.6)">–ù–µ—Ç –ø–µ—Å–Ω–∏? –ù–∞–ø–∏—à–∏ –±–æ—Ç—É ¬´–ø–µ—Å–Ω—è –Ω–µ –ø—Ä–∏—à–ª–∞¬ª.</span>', function() { goToPage('successPage'); });
            return;
          }
          if (!hotJson.checkout_url) {
            console.error('[HOT Pay] Checkout URL –Ω–µ –ø–æ–ª—É—á–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ:', hotJson);
            throw new Error('Checkout URL –Ω–µ –ø–æ–ª—É—á–µ–Ω');
          }
          var checkoutUrl = String(hotJson.checkout_url);
          console.log('[HOT Pay] –ü–æ–ª—É—á–µ–Ω checkout_url:', checkoutUrl);
          setPaymentStatus('–û—Ç–∫—Ä—ã–≤–∞—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã...', 'warn');

          var lastCheckoutUrl = checkoutUrl;
          var hintEl = document.getElementById('payOvLinkRow');
          var copyBtn = document.getElementById('payOvCopyBtn');
          if (copyBtn) {
            copyBtn.onclick = function() {
              try {
                navigator.clipboard.writeText(lastCheckoutUrl);
                alert(t('alertLinkCopied'));
              } catch (e) {
                prompt(t('copyLinkPrompt'), lastCheckoutUrl);
              }
            };
          }
          if (hintEl) hintEl.style.display = 'block';

          var opened = false;
          console.log('[HOT Pay] –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É –æ–ø–ª–∞—Ç—ã:', checkoutUrl);
          
          try {
            if (window.Telegram && window.Telegram.WebApp && typeof window.Telegram.WebApp.openLink === 'function') {
              console.log('[HOT Pay] –ò—Å–ø–æ–ª—å–∑—É–µ–º Telegram.WebApp.openLink');
              try {
                window.Telegram.WebApp.openLink(checkoutUrl, { try_instant_view: false });
                console.log('[HOT Pay] openLink —Å try_instant_view: false - —É—Å–ø–µ—à–Ω–æ');
              } catch (e1) {
                console.log('[HOT Pay] openLink —Å try_instant_view: false - –æ—à–∏–±–∫–∞:', e1);
                window.Telegram.WebApp.openLink(checkoutUrl);
                console.log('[HOT Pay] openLink –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - —É—Å–ø–µ—à–Ω–æ');
              }
              opened = true;
            } else {
              console.log('[HOT Pay] Telegram.WebApp.openLink –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            }
          } catch (linkErr) {
            console.error('[HOT Pay] –û—à–∏–±–∫–∞ Telegram.WebApp.openLink:', linkErr);
          }
          
          if (!opened) {
            console.log('[HOT Pay] –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ window.open');
            var newWindow = window.open(checkoutUrl, '_blank', 'noopener,noreferrer');
            if (newWindow) {
              opened = true;
              console.log('[HOT Pay] window.open - —É—Å–ø–µ—à–Ω–æ');
            } else {
              console.log('[HOT Pay] window.open - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –±—Ä–∞—É–∑–µ—Ä–æ–º');
              // –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ location.href –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç
              console.log('[HOT Pay] –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ location.href');
              try {
                window.location.href = checkoutUrl;
                opened = true;
                console.log('[HOT Pay] location.href - —É—Å–ø–µ—à–Ω–æ');
              } catch (e) {
                console.error('[HOT Pay] location.href - –æ—à–∏–±–∫–∞:', e);
              }
            }
          }
          
          if (!opened) {
            console.error('[HOT Pay] –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É –Ω–∏ –æ–¥–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º');
            setPaymentStatus('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ù–∞–∂–º–∏—Ç–µ ¬´–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É¬ª –Ω–∏–∂–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.', 'error');
            payBtn.disabled = false;
            payBtn.textContent = t('payWithHot');
            return;
          } else {
            console.log('[HOT Pay] –°—Å—ã–ª–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∞, –Ω–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ –æ–ø–ª–∞—Ç—ã');
          }

          setPaymentStatus(t('hotCheckoutOpened'), 'warn');
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ webhook –∑–∞–¥–µ—Ä–∂–∏—Ç—Å—è
          var checkBtn = document.getElementById('payOvCheckBtn');
          if (checkBtn) checkBtn.style.display = 'block';
          var maxAttempts = 60;
          var attempt = 0;
          var paid = false;
          while (attempt < maxAttempts) {
            attempt += 1;
            await new Promise(function(resolve) { setTimeout(resolve, 3000); });
            var statusResp = await fetch(apiBase + '/api/payments/hot/status?request_id=' + encodeURIComponent(pendingPaymentRequestId), { headers: { 'X-Telegram-Init': initData } });
            var statusJson = await statusResp.json().catch(function() { return {}; });
            var paymentStatus = statusJson && statusJson.data && statusJson.data.payment_status ? String(statusJson.data.payment_status).toLowerCase() : '';
            if (paymentStatus === 'paid') { paid = true; break; }
          }
          if (!paid) {
            setPaymentStatus(t('paymentNotConfirmed'), 'warn');
            payBtn.disabled = false;
            payBtn.textContent = t('payWithHot');
            return;
          }
          setPaymentStatus(t('paymentConfirmed'), 'ok');
          var confirmResp = await fetch(apiBase + '/api/payments/hot/confirm', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
            body: JSON.stringify({ request_id: pendingPaymentRequestId, initData: initData })
          });
          if (!confirmResp.ok) throw new Error('–û—à–∏–±–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã (' + confirmResp.status + ')');
          pendingPaymentRequestId = null;
          pendingPaymentSku = null;
          hidePaymentOverlay();
          showConfirm('‚úÖ –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!', '–ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–≤–æ–µ–π –ø–µ—Å–Ω–∏.<br><br>üéµ –ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç. –ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç.');
        } catch (error) {
          console.error('[HOT Pay] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:', error);
          var msg = (error && error.message) ? String(error.message) : t('errorOp');
          var hint = '';
          if (error.name === 'AbortError') {
            hint = ' –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è ‚Äî –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.';
          } else if (msg && (msg.toLowerCase().includes('–ø—Ä–æ–º–æ–∫–æ–¥') || msg.toLowerCase().includes('promo'))) {
            // –ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –ø–æ–¥–æ—à—ë–ª ‚Äî —á–∏—Å—Ç–∏–º –ø–æ–ª–µ –∏ activePromo —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞–ª —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–µ
            activePromo = null;
            var promoInputErr = document.getElementById('payOvPromoInput');
            if (promoInputErr) promoInputErr.value = '';
            hint = ' –û–ø–ª–∞—Ç–∏ –±–µ–∑ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –∏–ª–∏ –≤–≤–µ–¥–∏ –¥—Ä—É–≥–æ–π.';
          } else if (msg && msg.includes('fetch')) {
            hint = ' –ü—Ä–æ–≤–µ—Ä—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.';
          }
          setPaymentStatus('‚ùå ' + msg + hint, 'error');
          // –°–∫—Ä–æ–ª–ª–∏–º –æ–≤–µ—Ä–ª–µ–π –Ω–∞–≤–µ—Ä—Ö, —á—Ç–æ–±—ã –æ—à–∏–±–∫–∞ –±—ã–ª–∞ –≤–∏–¥–Ω–∞
          var ovScroll = document.getElementById('paymentOverlay');
          if (ovScroll) ovScroll.scrollTop = 0;
        } finally {
          console.log('[HOT Pay] –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É');
          payBtn.disabled = false;
          // –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏: —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ HOT Pay (–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –æ—á–∏—â–µ–Ω –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞)
          var isFreeAfterError = activePromo && Number(activePromo.amount_after) === 0;
          payBtn.textContent = isFreeAfterError ? 'üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ' : 'üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ HOT Pay';
          payBtn.style.background = isFreeAfterError ? 'linear-gradient(135deg,#059669,#10b981)' : 'linear-gradient(135deg,#d4af37,#ec4899)';
        }
      });
      
      var goProfileBtn = document.getElementById('goProfileBtn');
      if (goProfileBtn) goProfileBtn.addEventListener('click', function() { goToPage('profilePage'); });
      var goHeroesBtn = document.getElementById('goHeroesBtn');
      if (goHeroesBtn) goHeroesBtn.addEventListener('click', function() { goToPage('heroesPage'); initHeroesPage(); });
      var profileCreateSongBtn = document.getElementById('profileCreateSongBtn');
      if (profileCreateSongBtn) profileCreateSongBtn.addEventListener('click', function() { goToPage('formPage'); });
      var PLAN_PRICES = { plan_basic: '$14.99', plan_plus: '$24.99', plan_master: '$39.99' };
      var PLAN_TRACKS = { plan_basic: '5', plan_plus: '10', plan_master: '30' };

      function showPlanConfirm(planKey, planName) {
        var overlay = document.getElementById('planConfirmOverlay');
        var title = document.getElementById('planConfirmTitle');
        var desc = document.getElementById('planConfirmDesc');
        var btn = document.getElementById('planConfirmBtn');
        if (!overlay) return;
        var price = PLAN_PRICES[planKey] || '';
        var tracks = PLAN_TRACKS[planKey] || '';
        if (title) title.textContent = planName + (price ? ' ‚Äî ' + price + '/–º–µ—Å' : '');
        if (desc) desc.textContent = (tracks ? tracks + ' –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤ –≤ –º–µ—Å—è—Ü.' : '') + ' –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ HOT Pay. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º.';
        if (btn) {
          btn.textContent = '–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ ‚Üí';
          btn.onclick = async function() {
            btn.textContent = '–ó–∞–≥—Ä—É–∂–∞–µ–º‚Ä¶';
            btn.disabled = true;
            try {
              var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
              var initData = getInitData ? getInitData() : '';
              var resp = await fetch(apiBase + '/api/payments/subscription/checkout', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
                body: JSON.stringify({ initData: initData, plan_key: planKey, name: (userProfile && userProfile.name) || '' })
              });
              var data = await resp.json().catch(function() { return {}; });
              if (data.already_subscribed) {
                overlay.style.display = 'none';
                alert('–£ —Ç–µ–±—è —É–∂–µ –∞–∫—Ç–∏–≤–Ω–∞ —ç—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∞.');
                return;
              }
              if (!data.success || !data.checkout_url) {
                btn.textContent = '–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ ‚Üí';
                btn.disabled = false;
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.');
                return;
              }
              overlay.style.display = 'none';
              // –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ–ø–ª–∞—Ç—É –±–µ–∑ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
              if (tg && tg.openLink) {
                tg.openLink(data.checkout_url);
              } else {
                window.open(data.checkout_url, '_blank');
              }
            } catch(e) {
              btn.textContent = '–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ ‚Üí';
              btn.disabled = false;
              alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.');
            }
          };
        }
        overlay.style.display = 'flex';
      }

      var planBtnBasic = document.getElementById('planBtnBasic');
      if (planBtnBasic) planBtnBasic.addEventListener('click', function() {
        showPlanConfirm('plan_basic', 'Basic');
      });
      var planBtnPlus = document.getElementById('planBtnPlus');
      if (planBtnPlus) planBtnPlus.addEventListener('click', function() {
        showPlanConfirm('plan_plus', 'Plus');
      });
      var planBtnMaster = document.getElementById('planBtnMaster');
      if (planBtnMaster) planBtnMaster.addEventListener('click', function() {
        showPlanConfirm('plan_master', '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è');
      });

      // –¢—É–ª—Ç–∏–ø—ã –¥–ª—è —Ñ–∏—á —Ç–∞—Ä–∏—Ñ–æ–≤ (.ppc-info)
      (function() {
        var tooltip = document.getElementById('modeTooltip');
        if (!tooltip) return;
        var timer = null;
        function hide() { tooltip.style.display = 'none'; clearTimeout(timer); }
        document.querySelectorAll('.ppc-info').forEach(function(icon) {
          icon.addEventListener('click', function(e) {
            e.stopPropagation();
            var text = this.getAttribute('data-tip') || '';
            if (!text) return;
            tooltip.textContent = text;
            tooltip.style.display = 'block';
            var rect = this.getBoundingClientRect();
            var tw = tooltip.offsetWidth || 220;
            var left = Math.min(rect.left, window.innerWidth - tw - 12);
            tooltip.style.left = Math.max(8, left) + 'px';
            tooltip.style.top = (rect.bottom + 8) + 'px';
            clearTimeout(timer);
            timer = setTimeout(hide, 4000);
          });
        });
      })();
      var profileRefShareBtn = document.getElementById('profileRefShareBtn');
      if (profileRefShareBtn) profileRefShareBtn.addEventListener('click', function() {
        var link = (document.getElementById('profileRefLinkInput') || {}).value || '';
        if (!link) return;
        if (tg && tg.openTelegramLink) {
          tg.openTelegramLink('https://t.me/share/url?url=' + encodeURIComponent(link) + '&text=' + encodeURIComponent('–ü–æ–ø—Ä–æ–±—É–π YupSoul ‚Äî –ø–µ—Ä–≤—É—é –ø–µ—Å–Ω—é –ø–æ–ª—É—á–∏—à—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ'));
        } else {
          try {
            if (navigator.clipboard && navigator.clipboard.writeText) {
              navigator.clipboard.writeText(link);
              profileRefShareBtn.textContent = t('profileShare') + ' ‚úì';
              setTimeout(function() { profileRefShareBtn.textContent = t('profileShare'); }, 2000);
            }
          } catch (e) {}
        }
      });

      // ‚îÄ‚îÄ –ó–ê–ì–†–£–ó–ö–ê –§–û–¢–û –ü–†–û–§–ò–õ–Ø ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      (function setupAvatarUpload() {
        var wrap = document.getElementById('profileAvatarWrap');
        var input = document.getElementById('avatarFileInput');
        var spinner = document.getElementById('profileAvatarSpinner');

        if (!wrap || !input) return;

        wrap.addEventListener('click', function() { input.click(); });

        input.addEventListener('change', function() {
          var file = input.files && input.files[0];
          if (!file) return;
          if (!file.type.startsWith('image/')) { alert('–í—ã–±–µ—Ä–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'); return; }

          var reader = new FileReader();
          reader.onload = function(e) {
            var src = e.target.result;
            var img = new Image();
            img.onload = function() {
              // –†–µ—Å–∞–π–∑ –¥–æ 256√ó256 —á–µ—Ä–µ–∑ Canvas
              var SIZE = 256;
              var canvas = document.createElement('canvas');
              canvas.width = SIZE; canvas.height = SIZE;
              var ctx = canvas.getContext('2d');
              // –ö—Ä–æ–ø –ø–æ —Ü–µ–Ω—Ç—Ä—É
              var sw = img.width, sh = img.height;
              var side = Math.min(sw, sh);
              var sx = (sw - side) / 2, sy = (sh - side) / 2;
              ctx.drawImage(img, sx, sy, side, side, 0, 0, SIZE, SIZE);
              var base64 = canvas.toDataURL('image/jpeg', 0.85);

              // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é —Å—Ä–∞–∑—É
              var avatarEl = document.getElementById('profileAvatar');
              var initEl   = document.getElementById('profileAvatarInitial');
              if (avatarEl) {
                var existing = avatarEl.querySelector('img');
                if (!existing) { existing = document.createElement('img'); existing.alt='avatar'; avatarEl.insertBefore(existing, avatarEl.firstChild); }
                existing.src = base64; existing.style.display = 'block';
              }
              if (initEl) initEl.style.display = 'none';

              // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
              var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
              var initData = getInitData();
              if (!apiBase || !initData) return;
              if (spinner) { spinner.style.display = 'flex'; }
              fetch(apiBase + '/api/user/avatar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'X-Telegram-Init': initData },
                body: JSON.stringify({ initData: initData, avatar_base64: base64 })
              })
              .then(function(r) { return r.json(); })
              .then(function(json) {
                if (spinner) spinner.style.display = 'none';
                if (!json.ok) console.warn('[Avatar] upload error:', json.error);
              })
              .catch(function(err) {
                if (spinner) spinner.style.display = 'none';
                console.warn('[Avatar] upload failed:', err);
              });
            };
            img.src = src;
          };
          reader.readAsDataURL(file);
          input.value = ''; // —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
        });
      })();

      // ‚îÄ‚îÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≥–µ—Ä–æ–µ–≤ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      function initHeroesPage() {
        var paywall = document.getElementById('masterPaywall');
        var cabinet = document.getElementById('masterCabinet');
        var formWrap = document.getElementById('heroFormWrap');
        if (!paywall || !cabinet) return;
        paywall.style.display = 'none';
        cabinet.style.display = 'none';
        if (formWrap) formWrap.style.display = 'none';
        var badge = document.getElementById('masterAccessBadge');
        if (badge) badge.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶';

        heroesApi('/master/access', { method: 'GET' }).then(function(d) {
          if (d && d.access) {
            var sub = d.source === 'trial' ? '–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥' : '–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞';
            if (d.renew_at) {
              var exp = new Date(d.renew_at);
              sub += ' ¬∑ –¥–æ ' + exp.toLocaleDateString('ru-RU', { day:'numeric', month:'short' });
            }
            if (badge) badge.textContent = sub;
            cabinet.style.display = 'block';
            loadHeroesList();
          } else {
            if (badge) badge.textContent = '';
            paywall.style.display = 'block';
          }
        }).catch(function() {
          if (badge) badge.textContent = '';
          paywall.style.display = 'block';
        });
      }

      // ‚îÄ‚îÄ –¢—Ä–∏–∞–ª –∏ –ø–æ–¥–ø–∏—Å–∫–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      var masterTrialBtn = document.getElementById('masterTrialBtn');
      var masterSubBtn = document.getElementById('masterSubBtn');
      if (masterTrialBtn) masterTrialBtn.addEventListener('click', function() {
        masterTrialBtn.disabled = true;
        masterTrialBtn.textContent = '–ü–æ–¥–∫–ª—é—á–∞–µ–º‚Ä¶';
        heroesApi('/master/trial/start', { method: 'POST', body: { initData: (tg && tg.initData) || '' } }).then(function(d) {
          if (d && d.ok) {
            var paywall = document.getElementById('masterPaywall');
            var cabinet = document.getElementById('masterCabinet');
            var badge = document.getElementById('masterAccessBadge');
            if (paywall) paywall.style.display = 'none';
            if (cabinet) { cabinet.style.display = 'block'; loadHeroesList(); }
            if (badge) {
              var exp = d.renew_at ? new Date(d.renew_at).toLocaleString('ru-RU', { day:'numeric', month:'short', hour:'2-digit', minute:'2-digit' }) : '';
              badge.textContent = '–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥' + (exp ? ' ¬∑ –¥–æ ' + exp : '');
            }
          } else {
            alert(d && d.error ? d.error : '–ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å');
            masterTrialBtn.disabled = false;
            masterTrialBtn.textContent = 'üéÅ 1 –¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚Äî –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å';
          }
        }).catch(function(e) {
          alert('–û—à–∏–±–∫–∞: ' + (e.message || e));
          masterTrialBtn.disabled = false;
          masterTrialBtn.textContent = 'üéÅ 1 –¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚Äî –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å';
        });
      });
      if (masterSubBtn) masterSubBtn.addEventListener('click', function() {
        masterSubBtn.disabled = true;
        masterSubBtn.textContent = '–û—Ç–∫—Ä—ã–≤–∞–µ–º –æ–ø–ª–∞—Ç—É‚Ä¶';
        heroesApi('/master/subscribe', { method: 'POST', body: { initData: (tg && tg.initData) || '' } }).then(function(d) {
          if (d && d.payment_url) {
            if (tg && tg.openLink) tg.openLink(d.payment_url);
            else window.open(d.payment_url, '_blank');
          }
          masterSubBtn.disabled = false;
          masterSubBtn.textContent = 'üí≥ –ü–æ–¥–ø–∏—Å–∫–∞ ‚Äî 299 —Ä—É–±/–º–µ—Å';
        }).catch(function(e) {
          alert('–û—à–∏–±–∫–∞: ' + (e.message || e));
          masterSubBtn.disabled = false;
          masterSubBtn.textContent = 'üí≥ –ü–æ–¥–ø–∏—Å–∫–∞ ‚Äî 299 —Ä—É–±/–º–µ—Å';
        });
      });

      // ‚îÄ‚îÄ –°–ø–∏—Å–æ–∫ –≥–µ—Ä–æ–µ–≤ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      function escHtml(s) { return String(s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

      function loadHeroesList() {
        var listEl = document.getElementById('heroesList');
        if (!listEl) return;
        listEl.innerHTML = '<div style="text-align:center;padding:24px 0;font-size:0.85rem;color:rgba(255,255,255,0.3)">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>';
        var search = (document.getElementById('heroesSearch') || {}).value || '';
        var q = search.trim() ? '?search=' + encodeURIComponent(search.trim()) : '';
        heroesApi('/heroes' + q, { method: 'GET' }).then(function(d) {
          heroesCache = (d && d.clients) || [];
          if (!heroesCache.length) {
            listEl.innerHTML = '<div style="text-align:center;padding:32px 0">' +
              '<div style="font-size:2rem;margin-bottom:10px">üåü</div>' +
              '<div style="font-size:0.9rem;color:rgba(255,255,255,0.35);line-height:1.55">–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –≥–µ—Ä–æ—è.<br>–î–æ–±–∞–≤—å –ø–µ—Ä–≤–æ–≥–æ ‚Äî –∏ —Å–æ–∑–¥–∞–≤–∞–π –¥–ª—è –Ω–µ–≥–æ<br>–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Å–Ω–∏ –≤ –æ–¥–∏–Ω —Ç–∞–ø.</div></div>';
            return;
          }
          listEl.innerHTML = heroesCache.map(function(h) {
            var initials = (h.name || '?').trim().split(/\s+/).map(function(w){ return w[0]; }).slice(0,2).join('').toUpperCase();
            var metaParts = [];
            if (h.relationship) metaParts.push(h.relationship);
            if (h.birth_date) metaParts.push(new Date(h.birth_date).toLocaleDateString('ru-RU', { day:'numeric', month:'long', year:'numeric' }));
            if (h.birth_place) metaParts.push(h.birth_place);
            return '<div class="hero-card" id="hcard-' + escHtml(h.id) + '">' +
              '<div class="hero-card-head" onclick="toggleHeroCard(\'' + escHtml(h.id) + '\')">' +
              '<div class="hero-avatar">' + escHtml(initials) + '</div>' +
              '<div style="flex:1;min-width:0">' +
              '<div class="hero-card-name">' + escHtml(h.name) + '</div>' +
              '<div class="hero-card-meta">' + escHtml(metaParts.join(' ¬∑ ')) + '</div>' +
              (h.preferred_style ? '<div class="hero-style-badge">üéµ ' + escHtml(h.preferred_style) + '</div>' : '') +
              '</div>' +
              '<div class="hero-card-chevron">‚ñº</div>' +
              '</div>' +
              '<div class="hero-card-body">' +
              (h.notes ? '<div style="font-size:0.82rem;color:rgba(255,255,255,0.45);line-height:1.5;margin-bottom:12px">' + escHtml(h.notes) + '</div>' : '') +
              '<div class="hca-row">' +
              '<button type="button" class="hca-btn hero-solo-btn" data-id="' + escHtml(h.id) + '" data-name="' + escHtml(h.name) + '">üéµ –°–æ–ª–æ</button>' +
              '<button type="button" class="hca-btn hero-duo-btn" data-id="' + escHtml(h.id) + '" data-name="' + escHtml(h.name) + '">üé∂ –í–º–µ—Å—Ç–µ —Å–æ –º–Ω–æ–π</button>' +
              '<button type="button" class="hca-btn hca-secondary hero-edit-btn" data-id="' + escHtml(h.id) + '">‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å</button>' +
              '<button type="button" class="hca-btn hca-danger hero-delete-btn" data-id="' + escHtml(h.id) + '" data-name="' + escHtml(h.name) + '">–£–¥–∞–ª–∏—Ç—å</button>' +
              '</div>' +
              '<div class="hero-hist-section" id="hhist-' + escHtml(h.id) + '">' +
              '<button type="button" class="hero-hist-toggle hero-hist-load-btn" data-id="' + escHtml(h.id) + '">‚ñ∏ –ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</button>' +
              '<div class="hero-hist-content" id="hhist-content-' + escHtml(h.id) + '" style="display:none"></div>' +
              '</div>' +
              '</div>' +
              '</div>';
          }).join('');

          // –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
          listEl.querySelectorAll('.hero-hist-load-btn').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
              e.stopPropagation();
              var id = btn.getAttribute('data-id');
              var contentEl = document.getElementById('hhist-content-' + id);
              if (!contentEl) return;
              if (contentEl.style.display === 'block') { contentEl.style.display = 'none'; btn.textContent = '‚ñ∏ –ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π'; return; }
              contentEl.style.display = 'block';
              btn.textContent = '‚ñæ –ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π';
              if (contentEl.dataset.loaded) return;
              contentEl.dataset.loaded = '1';
              contentEl.innerHTML = '<div class="hero-hist-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏‚Ä¶</div>';
              heroesApi('/heroes/' + id + '/requests', { method: 'GET' }).then(function(d) {
                var reqs = (d && d.requests) || [];
                if (!reqs.length) { contentEl.innerHTML = '<div class="hero-hist-empty">–ì–µ–Ω–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>'; return; }
                contentEl.innerHTML = reqs.map(function(r) {
                  var statusEmoji = { completed:'‚úÖ', error:'‚ùå', pending:'‚è≥', pending_payment:'üí≥' }[r.generation_status] || 'üîÑ';
                  var dateStr = r.created_at ? new Date(r.created_at).toLocaleString('ru-RU', { day:'numeric', month:'short', hour:'2-digit', minute:'2-digit' }) : '';
                  var html = '<div class="hero-hist-item">';
                  html += '<div class="hero-hist-title">' + statusEmoji + ' ' + escHtml(r.title || '(–±–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è)') + '</div>';
                  html += '<div class="hero-hist-meta">' + escHtml(dateStr) + (r.request_type ? ' ¬∑ ' + escHtml(r.request_type) : '') + '</div>';
                  if (r.lyrics) {
                    html += '<div class="hero-hist-block-label">–¢–µ–∫—Å—Ç –ø–µ—Å–Ω–∏</div>';
                    html += '<div class="hero-hist-text">' + escHtml(r.lyrics) + '</div>';
                  }
                  if (r.detailed_analysis) {
                    html += '<button type="button" class="hero-hist-toggle hha-toggle" style="margin-bottom:4px">‚ñ∏ –ê–Ω–∞–ª–∏–∑</button>';
                    html += '<div class="hero-hist-text" style="display:none">' + escHtml(r.detailed_analysis) + '</div>';
                  }
                  if (r.cover_letter) {
                    html += '<button type="button" class="hero-hist-toggle hha-toggle" style="margin-bottom:4px">‚ñ∏ –°–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ</button>';
                    html += '<div class="hero-hist-text" style="display:none">' + escHtml(r.cover_letter) + '</div>';
                  }
                  if (r.audio_url) {
                    html += '<a href="' + escHtml(r.audio_url) + '" target="_blank" class="hero-hist-audio">üéß –°–ª—É—à–∞—Ç—å</a>';
                  }
                  html += '</div>';
                  return html;
                }).join('');
                // –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∞–Ω–∞–ª–∏–∑–∞/–ø–∏—Å—å–º–∞
                contentEl.querySelectorAll('.hha-toggle').forEach(function(tb) {
                  tb.addEventListener('click', function() {
                    var next = tb.nextElementSibling;
                    if (!next) return;
                    var open = next.style.display === 'block';
                    next.style.display = open ? 'none' : 'block';
                    tb.textContent = tb.textContent.replace(/^[‚ñ∏‚ñæ]\s/, (open ? '‚ñ∏ ' : '‚ñæ '));
                  });
                });
              }).catch(function() { contentEl.innerHTML = '<div class="hero-hist-empty">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</div>'; });
            });
          });

          // –ö–Ω–æ–ø–∫–∏ –°–æ–ª–æ / –í–º–µ—Å—Ç–µ
          listEl.querySelectorAll('.hero-solo-btn').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
              e.stopPropagation();
              var heroId = btn.getAttribute('data-id');
              var heroName = btn.getAttribute('data-name') || '';
              var h = heroesCache.find(function(c){ return c.id === heroId; }) || {};
              startHeroRequest({ hero: h, mode: 'single', forWho: heroName });
            });
          });
          listEl.querySelectorAll('.hero-duo-btn').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
              e.stopPropagation();
              var heroId = btn.getAttribute('data-id');
              var heroName = btn.getAttribute('data-name') || '';
              var h = heroesCache.find(function(c){ return c.id === heroId; }) || {};
              startHeroRequest({ hero: h, mode: 'couple', forWho: heroName });
            });
          });

          // –ö–Ω–æ–ø–∫–∏ –ò–∑–º–µ–Ω–∏—Ç—å / –£–¥–∞–ª–∏—Ç—å
          listEl.querySelectorAll('.hero-edit-btn').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
              e.stopPropagation();
              var id = btn.getAttribute('data-id');
              var h = heroesCache.find(function(c) { return c.id === id; });
              if (!h) return;
              openHeroForm(h);
            });
          });
          listEl.querySelectorAll('.hero-delete-btn').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
              e.stopPropagation();
              var id = btn.getAttribute('data-id');
              var name = btn.getAttribute('data-name') || '—ç—Ç–æ–≥–æ –≥–µ—Ä–æ—è';
              if (!confirm('–£–¥–∞–ª–∏—Ç—å ¬´' + name + '¬ª?')) return;
              heroesApi('/heroes/' + id, { method: 'DELETE' }).then(function() { loadHeroesList(); }).catch(function(e) { alert('–û—à–∏–±–∫–∞: ' + (e.message || e)); });
            });
          });
        }).catch(function() {
          if (listEl) listEl.innerHTML = '<div style="color:rgba(239,68,68,0.7);font-size:0.85rem;text-align:center;padding:20px">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≥–µ—Ä–æ–µ–≤</div>';
        });
      }

      // –†–∞—Å–∫—Ä—ã—Ç–∏–µ/—Å—Ö–ª–æ–ø—ã–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
      window.toggleHeroCard = function(id) {
        var card = document.getElementById('hcard-' + id);
        if (!card) return;
        card.classList.toggle('expanded');
      };

      // ‚îÄ‚îÄ –§–æ—Ä–º–∞ –≥–µ—Ä–æ—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      function openHeroForm(h) {
        var cabinet = document.getElementById('masterCabinet');
        var formWrap = document.getElementById('heroFormWrap');
        var titleEl = document.getElementById('heroFormTitle');
        if (cabinet) cabinet.style.display = 'none';
        if (!formWrap) return;
        formWrap.style.display = 'block';
        if (h && h.id) {
          editingHeroId = h.id;
          if (titleEl) titleEl.textContent = '–ò–∑–º–µ–Ω–∏—Ç—å –≥–µ—Ä–æ—è';
        } else {
          editingHeroId = null;
          if (titleEl) titleEl.textContent = '–î–æ–±–∞–≤–∏—Ç—å –≥–µ—Ä–æ—è';
        }
        document.getElementById('heroName').value = (h && h.name) || '';
        document.getElementById('heroRelationship').value = (h && h.relationship) || '';
        document.getElementById('heroBirthdate').value = (h && h.birth_date) || '';
        if (typeof updateDateSelectsFromInput === 'function') updateDateSelectsFromInput('heroBirthdate');
        document.getElementById('heroBirthtime').value = ((h && h.birth_time) || '').substring(0, 5);
        document.getElementById('heroBirthtimeUnknown').checked = !!(h && h.birthtime_unknown);
        document.getElementById('heroGender').value = (h && h.gender) || '';
        document.getElementById('heroStyle').value = (h && h.preferred_style) || '';
        document.getElementById('heroNotes').value = (h && h.notes) || '';
        // –ì–æ—Ä–æ–¥: –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–º–∞—Ä–∫–∞
        var hpInput = document.getElementById('heroBirthplace');
        var hpWrap  = document.getElementById('heroBirthplaceWrap');
        var hpCheck = document.getElementById('heroBirthplaceCheck');
        var hpHint  = document.getElementById('heroBirthplaceHint');
        var birthPlaceVal = (h && h.birth_place) || '';
        if (hpInput) hpInput.value = birthPlaceVal;
        if (hpWrap)  hpWrap.classList.toggle('has-place', !!birthPlaceVal);
        if (hpCheck) hpCheck.setAttribute('aria-hidden', birthPlaceVal ? 'false' : 'true');
        if (hpInput && birthPlaceVal) hpInput.setAttribute('data-place-selected','1');
        else if (hpInput) hpInput.removeAttribute('data-place-selected');
        if (hpHint)  hpHint.style.display = 'none';
        formWrap.scrollTop = 0;
      }

      function closeHeroForm() {
        var cabinet = document.getElementById('masterCabinet');
        var formWrap = document.getElementById('heroFormWrap');
        if (formWrap) formWrap.style.display = 'none';
        if (cabinet) cabinet.style.display = 'block';
        editingHeroId = null;
      }

      var addHeroBtn = document.getElementById('addHeroBtn');
      if (addHeroBtn) addHeroBtn.addEventListener('click', function() { openHeroForm(null); });
      var heroFormCancel = document.getElementById('heroFormCancel');
      if (heroFormCancel) heroFormCancel.addEventListener('click', closeHeroForm);

      var heroFormSave = document.getElementById('heroFormSave');
      if (heroFormSave) heroFormSave.addEventListener('click', function() {
        var name = (document.getElementById('heroName') || {}).value.trim();
        if (!name) { alert('–£–∫–∞–∂–∏ –∏–º—è –≥–µ—Ä–æ—è'); return; }
        heroFormSave.disabled = true;
        heroFormSave.textContent = '–°–æ—Ö—Ä–∞–Ω—è–µ–º‚Ä¶';
        var payload = {
          initData: (tg && tg.initData) || '',
          name: name,
          relationship: (document.getElementById('heroRelationship') || {}).value || null,
          birth_date: (document.getElementById('heroBirthdate') || {}).value || null,
          birth_time: (document.getElementById('heroBirthtime') || {}).value || null,
          birth_place: (document.getElementById('heroBirthplace') || {}).value.trim() || null,
          birthtime_unknown: (document.getElementById('heroBirthtimeUnknown') || {}).checked,
          gender: (document.getElementById('heroGender') || {}).value || null,
          preferred_style: (document.getElementById('heroStyle') || {}).value.trim() || null,
          notes: (document.getElementById('heroNotes') || {}).value.trim() || null
        };
        var apiCall = editingHeroId
          ? heroesApi('/heroes/' + editingHeroId, { method: 'PATCH', body: payload })
          : heroesApi('/heroes', { method: 'POST', body: payload });
        apiCall.then(function() {
          closeHeroForm();
          loadHeroesList();
        }).catch(function(e) {
          alert('–û—à–∏–±–∫–∞: ' + (e.message || e));
        }).finally(function() {
          heroFormSave.disabled = false;
          heroFormSave.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
        });
      });

      var heroesSearchBtn = document.getElementById('heroesSearchBtn');
      if (heroesSearchBtn) heroesSearchBtn.addEventListener('click', loadHeroesList);
      var heroesBackBtn = document.getElementById('heroesBackBtn');
      if (heroesBackBtn) heroesBackBtn.addEventListener('click', function() {
        var formWrap = document.getElementById('heroFormWrap');
        if (formWrap && formWrap.style.display !== 'none') { closeHeroForm(); return; }
        goBack();
      });
      var todayHero = new Date();
      var heroBirthdateEl = document.getElementById('heroBirthdate');
      if (heroBirthdateEl) {
        heroBirthdateEl.max = todayHero.toISOString().split('T')[0];
        var minH = new Date(); minH.setFullYear(minH.getFullYear() - 100);
        heroBirthdateEl.min = minH.toISOString().split('T')[0];
      }

      // ‚îÄ‚îÄ –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –¥–ª—è —Ñ–æ—Ä–º—ã –≥–µ—Ä–æ—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      (function() {
        var hInput = document.getElementById('heroBirthplace');
        var hSugg  = document.getElementById('heroBirthplaceSuggestions');
        var hWrap  = document.getElementById('heroBirthplaceWrap');
        var hCheck = document.getElementById('heroBirthplaceCheck');
        var hHint  = document.getElementById('heroBirthplaceHint');
        if (!hInput) return;
        var hDebounce = null;
        var hLastQ = '';

        function hHideSuggestions() {
          if (hSugg) { hSugg.innerHTML = ''; hSugg.setAttribute('aria-hidden','true'); hSugg.style.display = 'none'; }
        }
        function hSelectPlace(displayName, lat, lon) {
          hInput.value = (displayName || '').trim();
          hInput.setAttribute('data-place-selected','1');
          if (lat != null) hInput.setAttribute('data-lat', String(lat));
          if (lon != null) hInput.setAttribute('data-lon', String(lon));
          if (hWrap)  hWrap.classList.add('has-place');
          if (hCheck) hCheck.setAttribute('aria-hidden','false');
          if (hHint)  hHint.style.display = 'none';
          hHideSuggestions();
        }
        function hClearSelection() {
          hInput.removeAttribute('data-place-selected');
          hInput.removeAttribute('data-lat');
          hInput.removeAttribute('data-lon');
          if (hWrap)  hWrap.classList.remove('has-place');
          if (hCheck) hCheck.setAttribute('aria-hidden','true');
        }
        function hFetchPlaces(q) {
          if (!q || q.length < 2) { hHideSuggestions(); return; }
          var url = 'https://nominatim.openstreetmap.org/search?q=' + encodeURIComponent(q) + '&format=json&limit=8&addressdetails=1';
          fetch(url, { headers: { 'Accept':'application/json','Accept-Language':'ru','User-Agent':'YupSoulMiniApp/1.0' } })
            .then(function(r){ return r.json(); })
            .then(function(list){
              if (hLastQ !== q || !hSugg) return;
              hSugg.innerHTML = '';
              (list || []).forEach(function(item) {
                var li = document.createElement('li');
                var main = item.display_name || (item.address && (item.address.city || item.address.town || item.address.village || item.address.state || item.address.country)) || '';
                var country = item.address && item.address.country ? item.address.country : '';
                li.textContent = main;
                if (country) {
                  var sp = document.createElement('div');
                  sp.className = 'place-type';
                  sp.textContent = country + (item.address.country_code ? ' (' + item.address.country_code.toUpperCase() + ')' : '');
                  li.appendChild(sp);
                }
                li.addEventListener('click', function(){ hSelectPlace(item.display_name || main, item.lat, item.lon); });
                hSugg.appendChild(li);
              });
              hSugg.style.display = (list && list.length) ? 'block' : 'none';
              hSugg.setAttribute('aria-hidden', (list && list.length) ? 'false' : 'true');
            })
            .catch(function(){ hHideSuggestions(); });
        }
        hInput.addEventListener('input', function(){
          var v = hInput.value.trim();
          hClearSelection();
          if (v) { hLastQ = v; clearTimeout(hDebounce); hDebounce = setTimeout(function(){ hFetchPlaces(v); }, 320); }
          else hHideSuggestions();
        });
        hInput.addEventListener('focus', function(){
          if (hHint) hHint.style.display = 'none';
          var v = hInput.value.trim();
          if (v && v.length >= 2) { hLastQ = v; hFetchPlaces(v); }
        });
        hInput.addEventListener('blur', function(){
          setTimeout(hHideSuggestions, 200);
        });
      })();

      // ‚îÄ‚îÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ –≥–µ—Ä–æ—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      // –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ heroRequest –ø–æ–∫–∞ loadForWhoSelect –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
      var _pendingHeroRequest = null;

      function _applyHeroRequest(hero, mode) {
        setMode(mode);
        if (mode === 'couple') {
          // –°–∫—Ä—ã–≤–∞–µ–º forWhoWrap (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–∫–∞–∑–∞–Ω async-–∫–æ–ª–±—ç–∫–æ–º loadForWhoSelect)
          var fww = document.getElementById('forWhoWrap');
          if (fww) fww.style.display = 'none';

          // –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω—è–µ–º person1 –ø—Ä–æ—Ñ–∏–ª–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          fillFormFromProfile(userProfile || (tg && tg.initDataUnsafe && tg.initDataUnsafe.user));
          // –ß—Ç–æ–±—ã –Ω–µ —Ç—Ä–µ–±–æ–≤–∞–ª–æ ¬´–≤—ã–±–µ—Ä–∏ –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø–∏—Å–∫–∞¬ª: –µ—Å–ª–∏ —É person1 —É–∂–µ –µ—Å—Ç—å –≥–æ—Ä–æ–¥ (3+ —Å–∏–º–≤–æ–ª–æ–≤), —Å—á–∏—Ç–∞–µ–º –µ–≥–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º
          var bp1 = document.getElementById('birthplace');
          if (bp1 && bp1.value.trim().length >= 3) {
            if (!bp1.getAttribute('data-place-selected')) {
              bp1.setAttribute('data-place-selected', '1');
              bp1.setAttribute('data-from-profile', '1');
            }
            var bw1 = document.getElementById('birthplaceWrap');
            if (bw1) bw1.classList.add('has-place');
            var bch1 = document.getElementById('birthplaceCheck');
            if (bch1) bch1.setAttribute('aria-hidden', 'false');
          }
          // –í—Å–µ–≥–¥–∞ —Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –¥–ª—è person1 –ø—Ä–∏ –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏
          var bHint1 = document.getElementById('birthplaceHint');
          if (bHint1) bHint1.style.display = 'none';

          // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è person2 –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ –≥–µ—Ä–æ—è
          var n2   = document.getElementById('name2');
          var bd2  = document.getElementById('birthdate2');
          var bt2  = document.getElementById('birthtime2');
          var unk2 = document.getElementById('unknown2');
          var g2   = document.getElementById('gender2');
          var bp2  = document.getElementById('birthplace2');

          if (n2)   n2.value   = hero.name || '';
          if (bd2)  { bd2.value = (hero.birth_date || '').substring(0, 10); if (typeof updateDateSelectsFromInput === 'function') updateDateSelectsFromInput('birthdate2'); }
          if (bt2)  bt2.value  = (hero.birth_time || '').substring(0, 5);
          if (unk2) unk2.checked = !!hero.birthtime_unknown;
          if (g2)   g2.value   = hero.gender || '';
          var p2rel = document.getElementById('person2Relationship');
          if (p2rel) p2rel.value = hero.relationship || '';
          if (bp2) {
            bp2.value = hero.birth_place || '';
            if (hero.birth_place && hero.birth_place.trim().length >= 3) {
              bp2.setAttribute('data-from-profile', '1');
              bp2.setAttribute('data-place-selected', '1');
              if (hero.birth_lat) bp2.setAttribute('data-lat', String(hero.birth_lat));
              if (hero.birth_lon) bp2.setAttribute('data-lon', String(hero.birth_lon));
              var bw2 = document.getElementById('birthplace2Wrap');
              if (bw2) bw2.classList.add('has-place');
              var bch2 = document.getElementById('birthplace2Check');
              if (bch2) bch2.setAttribute('aria-hidden', 'false');
              var bHint2 = document.getElementById('birthplace2Hint');
              if (bHint2) bHint2.style.display = 'none';
            }
          }
          // –°–æ–±–∏—Ä–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞—Ä—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞
          (function() {
            var reqEl = document.getElementById('request');
            if (!reqEl || reqEl.value) return;
            var parts = ['–°–æ–∑–¥–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω—É—é –ø–µ—Å–Ω—é –¥–ª—è –Ω–∞—Å –¥–≤–æ–∏—Ö'];
            if (hero.relationship) parts.push('–ö–µ–º —è–≤–ª—è–µ—Ç—Å—è ' + hero.name + ' –¥–ª—è –º–µ–Ω—è: ' + hero.relationship);
            if (hero.preferred_style) parts.push('–ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å: ' + hero.preferred_style);
            if (hero.notes) parts.push('–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç: ' + hero.notes);
            reqEl.value = parts.join('. ');
          })();

          // –°–∫—Ä–æ–ª–ª–∏–º –∫ secondPersonForm —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è
          setTimeout(function() {
            var sf = document.getElementById('secondPersonForm');
            if (sf) try { sf.scrollIntoView({ behavior: 'smooth', block: 'start' }); } catch(e) {}
          }, 100);

        } else {
          // ‚îÄ‚îÄ –†–µ–∂–∏–º ¬´—Å–æ–ª–æ¬ª: –≥–µ—Ä–æ–π = person1 ‚îÄ‚îÄ
          var forWhoEl = document.getElementById('forWho');
          if (forWhoEl && hero.id) {
            if (!forWhoEl.querySelector('option[value="' + hero.id + '"]')) {
              var pendingOpt = document.createElement('option');
              pendingOpt.value = hero.id;
              pendingOpt.textContent = hero.name || hero.id;
              pendingOpt.setAttribute('data-pending', '1');
              forWhoEl.appendChild(pendingOpt);
            }
            forWhoEl.value = hero.id;
          }
          fillFormFromHero(hero);
          // –°–æ–±–∏—Ä–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –≥–µ—Ä–æ—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ ‚Äî relationship + preferred_style + notes
          (function() {
            var reqEl = document.getElementById('request');
            if (!reqEl || reqEl.value) return;
            var parts = ['–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–µ—Å–Ω—é'];
            if (hero.relationship) parts.push('–≠—Ç–æ –º–æ—è ' + hero.relationship + ' ‚Äî ' + (hero.name || ''));
            if (hero.preferred_style) parts.push('–ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å: ' + hero.preferred_style);
            if (hero.notes) parts.push('–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç: ' + hero.notes);
            if (parts.length > 1) reqEl.value = parts.join('. ');
          })();
        }
      }

      function startHeroRequest(opts) {
        var hero = opts.hero || {};
        var mode = opts.mode || 'single';

        _pendingHeroRequest = { hero: hero, mode: mode };
        goToPage('formPage');

        // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
        _applyHeroRequest(hero, mode);
        // –ò –ø–æ–≤—Ç–æ—Ä—è–µ–º —á–µ—Ä–µ–∑ 600–º—Å ‚Äî –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ loadForWhoSelect –∑–∞–≤–µ—Ä—à–∏—Ç async-–∑–∞–ø—Ä–æ—Å
        // –∏ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å forWhoWrap/heroesCache
        setTimeout(function() {
          if (_pendingHeroRequest) {
            _applyHeroRequest(_pendingHeroRequest.hero, _pendingHeroRequest.mode);
            _pendingHeroRequest = null;
          }
        }, 600);
      }

      function fillFormFromProfile(profileOrTgUser) {
        if (!profileOrTgUser) return;
        var nameEl = document.getElementById('name');
        var bd = document.getElementById('birthdate');
        var bt = document.getElementById('birthtime');
        var bp = document.getElementById('birthplace');
        var unk = document.getElementById('unknown');
        var g = document.getElementById('gender');
        var langEl = document.getElementById('language');
        var isProfile = profileOrTgUser && (profileOrTgUser.birthdate != null || profileOrTgUser.birthplace != null);
        var firstName = profileOrTgUser.first_name || profileOrTgUser.name;
        if (nameEl && firstName) nameEl.value = firstName;
        if (isProfile) {
          if (bd) { bd.value = (profileOrTgUser.birthdate || '').toString().slice(0, 10); if (typeof updateDateSelectsFromInput === 'function') updateDateSelectsFromInput('birthdate'); }
          if (bt) bt.value = (profileOrTgUser.birthtime || '').toString().slice(0, 5);
          if (bp) {
            bp.value = profileOrTgUser.birthplace || '';
            if (profileOrTgUser.birthplace && profileOrTgUser.birthplace.length >= 3) {
              bp.setAttribute('data-from-profile', '1');
              bp.setAttribute('data-place-selected', '1');
              var bw = document.getElementById('birthplaceWrap'); if (bw) bw.classList.add('has-place');
              var bch = document.getElementById('birthplaceCheck'); if (bch) bch.setAttribute('aria-hidden', 'false');
              var bHintP = document.getElementById('birthplaceHint'); if (bHintP) bHintP.style.display = 'none';
              if (profileOrTgUser.birthplace_lat != null && profileOrTgUser.birthplace_lon != null) {
                bp.setAttribute('data-lat', String(profileOrTgUser.birthplace_lat));
                bp.setAttribute('data-lon', String(profileOrTgUser.birthplace_lon));
              } else {
                bp.removeAttribute('data-lat');
                bp.removeAttribute('data-lon');
              }
            } else {
              bp.removeAttribute('data-from-profile');
              bp.removeAttribute('data-place-selected');
              bp.removeAttribute('data-lat');
              bp.removeAttribute('data-lon');
              var bw = document.getElementById('birthplaceWrap'); if (bw) bw.classList.remove('has-place');
              var bch = document.getElementById('birthplaceCheck'); if (bch) bch.setAttribute('aria-hidden', 'true');
            }
          }
          if (unk) unk.checked = !!profileOrTgUser.birthtime_unknown;
          if (g) g.value = profileOrTgUser.gender || '';
          if (langEl && profileOrTgUser.language) langEl.value = profileOrTgUser.language;
          var bdWrap = document.getElementById('birthdateWrap');
          if (bdWrap) {
            if (profileOrTgUser.birthdate) { bdWrap.classList.add('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'false'); }
            else { bdWrap.classList.remove('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'true'); }
          }
        }
      }
      function fillFormFromHero(hero) {
        if (!hero) return;
        var nameEl = document.getElementById('name');
        var bd = document.getElementById('birthdate');
        var bt = document.getElementById('birthtime');
        var bp = document.getElementById('birthplace');
        var unk = document.getElementById('unknown');
        var g = document.getElementById('gender');
        if (nameEl) nameEl.value = hero.name || '';
        if (bd) { bd.value = hero.birth_date || ''; if (typeof updateDateSelectsFromInput === 'function') updateDateSelectsFromInput('birthdate'); }
        if (bt) bt.value = (hero.birth_time || '').substring(0, 5);
        if (bp) {
          bp.value = hero.birth_place || '';
          bp.removeAttribute('data-lat');
          bp.removeAttribute('data-lon');
          if (hero.birth_place && String(hero.birth_place).trim().length >= 3) {
            bp.setAttribute('data-from-profile', '1');
            bp.setAttribute('data-place-selected', '1');
            var bw = document.getElementById('birthplaceWrap'); if (bw) bw.classList.add('has-place');
            var bch = document.getElementById('birthplaceCheck'); if (bch) bch.setAttribute('aria-hidden', 'false');
            var bHint = document.getElementById('birthplaceHint'); if (bHint) bHint.style.display = 'none';
          } else {
            bp.removeAttribute('data-from-profile');
            bp.removeAttribute('data-place-selected');
            var bw = document.getElementById('birthplaceWrap'); if (bw) bw.classList.remove('has-place');
            var bch = document.getElementById('birthplaceCheck'); if (bch) bch.setAttribute('aria-hidden', 'true');
          }
        }
        if (unk) unk.checked = !!hero.birthtime_unknown;
        if (g) g.value = hero.gender || '';
        var langEl = document.getElementById('language');
        if (langEl && hero.language) langEl.value = hero.language;
        var bdWrap = document.getElementById('birthdateWrap');
        if (bdWrap) {
          if (hero.birth_date) { bdWrap.classList.add('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'false'); }
          else { bdWrap.classList.remove('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'true'); }
        }
      }
      function loadForWhoSelect() {
        var wrap = document.getElementById('forWhoWrap');
        var sel = document.getElementById('forWho');
        if (!wrap || !sel) return;
        if (userTariff !== 'master') { wrap.style.display = 'none'; return; }
        // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ couple-—Ä–µ–∂–∏–º–µ (–≥–µ—Ä–æ–π = person2, forWho –Ω–µ –Ω—É–∂–µ–Ω)
        if (selectedMode !== 'couple') wrap.style.display = 'block';
        heroesApi('/heroes', { method: 'GET' }).then(function(d) {
          heroesCache = (d && d.clients) || [];
          sel.innerHTML = '<option value="">' + t('forMyself') + '</option>' + heroesCache.map(function(h) { return '<option value="' + (h.id || '') + '">' + t('forHero', { name: h.name || '‚Äî' }) + '</option>'; }).join('');
          // –ò—Å–ø–æ–ª—å–∑—É–µ–º onchange –≤–º–µ—Å—Ç–æ addEventListener —á—Ç–æ–±—ã –Ω–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Å–ª—É—à–∞—Ç–µ–ª–∏
          sel.onchange = function() {
            var id = sel.value;
            if (!id) { fillFormFromHero(null); return; }
            var hero = heroesCache.find(function(c) { return c.id === id; });
            if (hero) fillFormFromHero(hero);
          };
          // –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∂–∏–º
          if (selectedMode !== 'couple') wrap.style.display = 'block';
          else wrap.style.display = 'none';
          // –ï—Å–ª–∏ –µ—Å—Ç—å –æ–∂–∏–¥–∞—é—â–∏–π –≥–µ—Ä–æ—è–º ‚Äî –ø–µ—Ä–µ–ø—Ä–∏–º–µ–Ω—è–µ–º (–∑–∞—â–∏—Ç–∞ –æ—Ç –≥–æ–Ω–∫–∏)
          if (_pendingHeroRequest) {
            _applyHeroRequest(_pendingHeroRequest.hero, _pendingHeroRequest.mode);
          }
        }).catch(function() { wrap.style.display = 'none'; });
      }

      var soulChatBtn = document.getElementById('soulChatBtn');
      if (soulChatBtn) soulChatBtn.addEventListener('click', function() {
        var botUrl = 'https://t.me/' + BOT_USERNAME;
        if (tg && tg.openTelegramLink) tg.openTelegramLink(botUrl);
        else window.open(botUrl, '_blank');
      });
      var soulChatPayBtn = document.getElementById('soulChatPayBtn');
      if (soulChatPayBtn) soulChatPayBtn.addEventListener('click', function() { goToPage('formPage'); setTimeout(function() { var stepNext = document.getElementById('stepNext'); if (stepNext) stepNext.click(); }, 100); });
      function openBotLink(payload) {
        var botUrl = 'https://t.me/' + BOT_USERNAME + (payload ? '?start=' + payload : '');
        if (tg && tg.openTelegramLink) tg.openTelegramLink(botUrl);
        else if (tg && tg.openLink) tg.openLink(botUrl);
        else window.open(botUrl, '_blank');
      }
      var openBotBtn = document.getElementById('openBotBtn');
      if (openBotBtn) openBotBtn.addEventListener('click', function() { openBotLink('song_ready'); });
      var openBotBeforeSubmitBtn = document.getElementById('openBotBeforeSubmitBtn');
      if (openBotBeforeSubmitBtn) openBotBeforeSubmitBtn.addEventListener('click', function() { openBotLink('miniapp_start'); });
      var helpSupportBtn = document.getElementById('helpSupportBtn');
      if (helpSupportBtn) helpSupportBtn.addEventListener('click', function() {
        var supportUrl = 'https://t.me/' + BOT_USERNAME;
        try {
          if (tg && tg.openLink) { tg.openLink(supportUrl); return; }
          if (tg && tg.openTelegramLink) { tg.openTelegramLink(supportUrl); return; }
        } catch(e) {}
        window.open(supportUrl, '_blank');
      });
      var newKeyBtn = document.getElementById('newKeyBtn');
      if (newKeyBtn) newKeyBtn.addEventListener('click', function() {
        var n = document.getElementById('name');
        var bd = document.getElementById('birthdate');
        var bp = document.getElementById('birthplace');
        var bt = document.getElementById('birthtime');
        var g = document.getElementById('gender');
        var langEl = document.getElementById('language');
        var r = document.getElementById('request');
        if (n) n.value = '';
        if (bd) { bd.value = ''; if (typeof updateDateSelectsFromInput === 'function') updateDateSelectsFromInput('birthdate'); }
        if (bp) bp.value = '';
        if (bt) bt.value = '';
        var unknownChk = document.getElementById('unknown'); if (unknownChk) unknownChk.checked = false;
        if (g) g.value = '';
        if (langEl) langEl.value = '';
        if (r) r.value = '';
        var bdWrap = document.getElementById('birthdateWrap');
        if (bdWrap) { bdWrap.classList.remove('has-date'); var bc = document.getElementById('birthdateCheck'); if (bc) bc.setAttribute('aria-hidden', 'true'); }
        var birthplaceHint = document.getElementById('birthplaceHint');
        if (birthplaceHint) birthplaceHint.style.display = 'none';
        var bpEl = document.getElementById('birthplace');
        if (bpEl) { bpEl.removeAttribute('data-place-selected'); bpEl.removeAttribute('data-lat'); bpEl.removeAttribute('data-lon'); }
        var wrap = document.getElementById('birthplaceWrap');
        if (wrap) wrap.classList.remove('has-place');
        goToPage('formPage');
      });
      
      document.querySelectorAll('.preview-nav button').forEach(function(button) {
        button.addEventListener('click', function() {
          var pageMap = { 'home': 'homePage', 'form': 'formPage', 'payment': 'paymentPage', 'loading': 'loadingPage', 'success': 'successPage', 'heroes': 'heroesPage' };
          document.querySelectorAll('.preview-nav button').forEach(function(btn) { btn.classList.remove('active'); });
          this.classList.add('active');
          goToPage(pageMap[button.getAttribute('data-page')] || 'homePage');
        });
      });
      
      (function checkAdminAndShowLink() {
        var apiBase = (window.BACKEND_URL || window.HEROES_API_BASE || '').replace(/\/$/, '');
        var initData = (tg && tg.initData) ? tg.initData : (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initData) || '';
        if (!apiBase || !initData) return;
        fetch(apiBase + '/api/admin/me', { headers: { 'X-Telegram-Init': initData } })
          .then(function(r) { return r.json(); })
          .then(function(data) {
            if (!data || !data.admin) return;
            var wrap = document.getElementById('adminLinkWrap');
            var btn = document.getElementById('adminLinkBtn');
            if (!wrap || !btn) return;
            wrap.style.display = 'block';
            btn.addEventListener('click', function(e) {
              e.preventDefault();
              var url = apiBase + '/admin';
              if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.openLink) window.Telegram.WebApp.openLink(url);
              else window.open(url, '_blank');
            });
          })
          .catch(function() {});
      })();
        } catch (e) {
          console.warn('App init error:', e);
        }
      }, 50);
    });
  </script>

  <!--
    PAYMENT OVERLAY ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π –æ–ø–ª–∞—Ç—ã.
    –ü—Ä—è–º–æ–π —Ä–µ–±—ë–Ω–æ–∫ <body>, –≤–Ω–µ –ª—é–±—ã—Ö stacking context.
    z-index:9999 ‚Äî –≤—ã—à–µ –≤—Å–µ–≥–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
    –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ showPaymentOverlay() / hidePaymentOverlay() –≤ JS.
  -->
  <div id="paymentOverlay" style="
    display:none;
    position:fixed;inset:0;
    z-index:9999;
    overflow-y:auto;overflow-x:hidden;
    background:linear-gradient(165deg,#0d0b1e 0%,#160a2e 45%,#0d1830 100%);
    color:#fff;
    font-family:'Comfortaa',sans-serif;
  ">
    <div style="max-width:520px;margin:0 auto;padding:28px 18px 40px;">
      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <div style="text-align:center;margin-bottom:24px;">
        <div style="font-size:1.9rem;font-weight:700;background:linear-gradient(135deg,#d4af37,#ec4899,#d4af37);background-size:300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">YupSoul</div>
        <div style="font-size:0.72rem;font-weight:400;letter-spacing:0.12em;color:rgba(212,175,55,0.5);margin:2px 0 4px;text-transform:uppercase">–ú—É–∑—ã–∫–∞ —Ç–≤–æ–µ–π –¥—É—à–∏</div>
        <div id="payOvSubtitle" style="color:rgba(255,255,255,0.75);font-size:0.95rem;margin-top:2px;">–¢–≤–æ—è –ø–µ—Å–Ω—è</div>
      </div>

      <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –æ–ø–ª–∞—Ç—ã: –æ–¥–∏–Ω –ø—Ä–æ–¥—É–∫—Ç, –æ–¥–Ω–∞ —Ü–µ–Ω–∞, –æ–¥–∏–Ω CTA -->
      <div style="background:rgba(15,12,40,0.96);border:1px solid rgba(212,175,55,0.3);border-radius:18px;padding:24px 20px;">
        <div id="payOvCardTitle" style="color:#d4af37;font-weight:700;font-size:1.05rem;margin-bottom:10px;">–û–ø–ª–∞—Ç–∞ –∑–∞—è–≤–∫–∏</div>

        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ free_trial –¥–æ—Å—Ç—É–ø–µ–Ω) -->
        <div id="payOvTrialHint" style="display:none;background:rgba(5,150,105,0.15);border:1.5px solid rgba(16,185,129,0.5);border-radius:14px;padding:16px;margin-bottom:16px;">
          <div style="font-size:0.95rem;color:#d1fae5;line-height:1.6;margin-bottom:12px;">
            üéÅ <strong style="color:#6ee7b7;">–ü–µ—Ä–≤–∞—è –ø–µ—Å–Ω—è ‚Äî –≤ –ø–æ–¥–∞—Ä–æ–∫!</strong>
          </div>
          <button id="payOvFreeClaimBtn" type="button"
            style="width:100%;padding:14px;border-radius:11px;background:linear-gradient(135deg,#059669,#10b981);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;letter-spacing:0.2px;">
            üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
          </button>
        </div>

        <!-- –ü—Ä–æ–º–æ–∫–æ–¥ ‚Äî —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º—ã–π –±–ª–æ–∫, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —ç–∫—Ä–∞–Ω -->
        <div style="margin-bottom:16px;">
          <button type="button" id="payOvPromoToggle" style="width:100%;padding:10px 0;background:none;border:none;color:rgba(212,175,55,0.85);font-size:0.9rem;cursor:pointer;font-family:inherit;text-align:left;">‚ñ∏ –ï—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥?</button>
          <div id="payOvPromoSection" style="display:none;margin-top:8px;">
            <input id="payOvPromoInput" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥"
              style="display:block;width:100%;box-sizing:border-box;padding:12px 14px;border-radius:10px;border:1.5px solid rgba(212,175,55,0.65);background:rgba(255,255,255,0.14);color:#fff;font-size:1rem;font-family:inherit;text-transform:uppercase;outline:none;-webkit-appearance:none;margin-bottom:8px;">
            <button id="payOvPromoBtn" type="button"
              style="display:block;width:100%;box-sizing:border-box;padding:11px;border-radius:10px;background:rgba(212,175,55,0.18);border:1.5px solid rgba(212,175,55,0.55);color:#d4af37;font-weight:600;font-size:0.9rem;cursor:pointer;font-family:inherit;">
              –ü—Ä–∏–º–µ–Ω–∏—Ç—å
            </button>
          </div>
        </div>

        <!-- –£—Å–ø–µ—à–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ 100% -->
        <div id="payOvPromoSuccessHint" style="display:none;background:rgba(5,150,105,0.15);border:1.5px solid rgba(16,185,129,0.5);border-radius:14px;padding:16px;margin-bottom:16px;">
          <p style="color:#d1fae5;font-size:0.95rem;line-height:1.6;margin:0;">
            ‚úÖ <strong style="color:#6ee7b7;">–ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω!</strong> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–∞.
          </p>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞ 100% -->
        <button id="payOvPromoConfirmBtn" type="button" style="display:none;width:100%;padding:16px;border-radius:13px;background:linear-gradient(135deg,#059669,#10b981);border:none;color:#fff;font-size:1.05rem;font-weight:700;cursor:pointer;font-family:inherit;margin-bottom:16px;letter-spacing:0.3px;">
          üéÅ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
        </button>

        <!-- –°—Ç–∞—Ç—É—Å (–æ—à–∏–±–∫–∏, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è) -->
        <div id="payOvStatus" style="display:none;border-radius:10px;padding:11px 14px;margin-bottom:14px;font-size:0.88rem;line-height:1.5;"></div>

        <!-- –°–µ–∫—Ü–∏—è –æ–ø–ª–∞—Ç—ã (HOT Pay) -->
        <div id="payOvPaymentSection" style="margin-bottom:16px;">
          <p style="color:rgba(255,255,255,0.8);font-size:0.95rem;margin-bottom:10px;">–ò–ª–∏ –æ–ø–ª–∞—Ç–∏:</p>
          <div style="background:rgba(212,175,55,0.06);border-radius:12px;padding:14px;margin-bottom:12px;text-align:center;">
            <div style="color:rgba(255,255,255,0.6);font-size:0.85rem;margin-bottom:4px;">–¶–µ–Ω–∞:</div>
            <div id="payOvPriceDisplay" style="font-size:1.3rem;font-weight:700;color:#d4af37;">5.99 USDT</div>
            <div id="payOvPriceHint" style="font-size:0.8rem;color:rgba(16,185,129,0.8);margin-top:6px;"></div>
          </div>
          <button id="payOvPayBtn" type="button"
            style="width:100%;padding:13px 24px;border-radius:14px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;margin-bottom:0;letter-spacing:0;">
            üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ HOT Pay
          </button>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ ¬´—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É¬ª (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –µ—Å–ª–∏ openLink –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª) -->
        <div id="payOvLinkRow" style="display:none;margin-bottom:12px;">
          <p style="color:rgba(255,255,255,0.75);font-size:0.85rem;margin-bottom:6px;">
            –ï—Å–ª–∏ –æ–∫–Ω–æ –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å ‚Äî —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä:
          </p>
          <button id="payOvCopyBtn" type="button"
            style="width:100%;padding:11px;border-radius:10px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.2);color:#fff;font-size:0.9rem;cursor:pointer;font-family:inherit;">
            üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –æ–ø–ª–∞—Ç—ã
          </button>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è HOT Pay) -->
        <button id="payOvCheckBtn" type="button" style="display:none;width:100%;padding:13px;border-radius:13px;background:rgba(16,185,129,0.12);border:1.5px solid rgba(16,185,129,0.4);color:rgba(16,185,129,0.95);font-size:0.9rem;font-weight:600;cursor:pointer;font-family:inherit;margin-bottom:11px;">
          ‚úÖ –Ø —É–∂–µ –æ–ø–ª–∞—Ç–∏–ª ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
        </button>

        <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
        <button id="payOvBackBtn" type="button"
          style="width:100%;padding:13px;border-radius:13px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.15);color:rgba(255,255,255,0.65);font-size:0.9rem;cursor:pointer;font-family:inherit;">
          ‚Üê –ù–∞–∑–∞–¥
        </button>
      </div>
    </div>
  </div>

  <!-- –≠–ö–†–ê–ù –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –ó–ê–Ø–í–ö–ò ‚Äî position:fixed, z-index –≤—ã—à–µ –æ–ø–ª–∞—Ç—ã, –≤—Å–µ–≥–¥–∞ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ -->
  <div id="confirmOverlay" style="
    display:none;
    position:fixed;inset:0;
    z-index:10000;
    background:linear-gradient(165deg,#0d0b1e 0%,#160a2e 45%,#0d1830 100%);
    overflow-y:auto;
    font-family:'Comfortaa',sans-serif;
  ">
    <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100%;padding:40px 24px;text-align:center;background:linear-gradient(180deg,rgba(1,6,26,.7) 0%,rgba(8,10,38,.85) 100%);">
      <div style="width:64px;height:64px;border:4px solid rgba(212,175,55,.15);border-top-color:#d4af37;border-radius:50%;margin:0 auto 24px;animation:confirmSpin 1s linear infinite;"></div>
      <div style="font-size:1.5rem;color:#d4af37;font-weight:700;margin-bottom:16px;" id="confirmTitle">‚ú® –ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!</div>
      <div style="color:rgba(255,255,255,0.8);font-size:1rem;line-height:1.8;max-width:340px;" id="confirmDesc">
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é –ø–µ—Å–Ω—é.<br><br>
        üéµ –ü–µ—Å–Ω—è –ø—Ä–∏–¥—ë—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç. –ú–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç.
      </div>
      <button id="confirmContinueBtn" type="button" style="margin-top:28px;padding:13px 44px;border-radius:14px;background:linear-gradient(135deg,#d4af37,#ec4899);border:none;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;font-family:inherit;box-shadow:0 6px 24px rgba(212,175,55,0.35);letter-spacing:0;">
        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚Üí
      </button>
    </div>
  </div>
  <!-- –ü–æ–ø–∞–ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º –ø–æ–¥–ø–∏—Å–∫–∏ -->
  <div id="planConfirmOverlay" style="
    display:none;position:fixed;inset:0;z-index:10000;
    background:rgba(0,0,0,0.72);backdrop-filter:blur(4px);
    align-items:flex-end;justify-content:center;padding:0 0 env(safe-area-inset-bottom,0) 0;
  " onclick="if(event.target===this)this.style.display='none'">
    <div style="
      background:linear-gradient(160deg,#1a1030 0%,#0d1830 100%);
      border:1px solid rgba(212,175,55,0.25);
      border-radius:20px 20px 0 0;
      padding:28px 24px 32px;
      max-width:480px;width:100%;
      text-align:center;
    ">
      <div style="width:40px;height:4px;border-radius:2px;background:rgba(255,255,255,0.15);margin:0 auto 20px;"></div>
      <div id="planConfirmTitle" style="font-size:1.15rem;font-weight:700;color:#d4af37;margin-bottom:10px;"></div>
      <div id="planConfirmDesc" style="font-size:0.88rem;color:rgba(255,255,255,0.65);line-height:1.5;margin-bottom:24px;"></div>
      <button id="planConfirmBtn" type="button" style="
        width:100%;padding:14px;border-radius:14px;
        background:linear-gradient(135deg,#d4af37,#ec4899);
        border:none;color:#fff;font-size:1rem;font-weight:700;
        cursor:pointer;font-family:inherit;
        box-shadow:0 6px 20px rgba(212,175,55,0.3);
        margin-bottom:10px;
      ">–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–æ—Ç ‚Üí</button>
      <button type="button" onclick="document.getElementById('planConfirmOverlay').style.display='none'" style="
        width:100%;padding:12px;border-radius:14px;
        background:transparent;border:1px solid rgba(255,255,255,0.15);
        color:rgba(255,255,255,0.5);font-size:0.9rem;
        cursor:pointer;font-family:inherit;
      ">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>

  <style>
    @keyframes confirmSpin { to { transform: rotate(360deg); } }
  </style>
</body>
</html>
