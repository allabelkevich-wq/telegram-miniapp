# YupSoul — правила проекта

- **Git:** только ветка `main`. Все коммиты и push — в main. Деплой (Render, GitHub Pages) идёт только из main. См. `docs/GIT_WORKFLOW.md`.
- **Одна ветка — обновы катятся везде:** правки в main автоматически попадают во все нужные папки через build (render.yaml копирует public/ → bot/public/). Не создавать другие ветки для «отдельных версий». Не копировать вручную между папками — только через деплой.
- **Перед началом работы:** в начале сессии или перед крупными задачами/деплоем выполнить `git pull origin main`, чтобы локальный main был актуальным. Иначе агент может создать ветку от устаревшего main.
- Контекст и цели проекта описаны в **PROJECT_BRIEF.md** — учитывай их при любых доработках.
- **Mini App (один источник правды):** правки интерфейса — только в **public/index.html**. Иконки и ассеты — только в **public/assets/**. Render при сборке автоматически копирует `public/index.html` и `public/assets/icons/` в `bot/public/` (см. render.yaml). Никогда не редактировать `bot/public/index.html` напрямую — он перезаписывается при деплое. **Исключение:** если срочно нужно синхронизировать вручную (например, Render ещё не задеплоился), выполнить: `cp public/index.html bot/public/ && cp -r public/assets/icons bot/public/assets/`.
- Язык ответов и комментариев в коде: русский по умолчанию (если пользователь не попросит иначе).
- Стек: Telegram Mini App (HTML/JS), Telegram Bot API, в перспективе — оплата Stars, админ-панель заявок, выдача файлов через бота.
- **Автодеплой:** после правок — commit + push в main. При изменении public/index.html или public/assets/ ничего дополнительно синхронизировать не нужно — Render скопирует при следующей сборке.

---

## Защита от путаницы (договорённость)

**Цель:** никаких дубликатов, откатов к старым версиям и потери труда.

- **Один источник правды на артефакт.** Не создавать копии файлов «на всякий случай». Если нужна копия — явно в `_archive/` с датой.
- **Перед созданием нового файла:** проверить, нет ли уже канонической версии (например, код бота — только в `bot/`, не в корне).
- **Перед удалением или объединением:** убедиться, что уникальное содержимое сохранено. При сомнении — оставить как есть или сначала скопировать в `_archive/`.
- **Перед правками в «похожем» файле:** уточнить у пользователя или проверить по правилам — это тот файл, который нужно редактировать?
- **Карта канонических файлов:**
  - Mini App UI: `public/index.html`
  - Воркер генерации: `bot/workerSoundKey.js` (не создавать в корне)
  - Бот, API: `bot/index.js`
  - Конфиг деплоя: `render.yaml`
