# Синхронизация: Cursor ↔ Git ↔ Telegram

Как связаны три стороны и что делать, чтобы всё было в актуальном состоянии.

---

## Схема

```
Cursor (локально)  →  Git (GitHub)  →  Telegram Mini App
     правки              push              открывает сайт
                        на main            с GitHub Pages
```

- **Cursor** — где ты правишь код (`index.html`, бот, стили и т.д.).
- **Git / GitHub** — куда ты отправляешь изменения (`git push`). Там же хранится репозиторий.
- **Telegram** — открывает приложение по ссылке. Сайт для этой ссылки отдаёт **GitHub Pages**, который обновляется после каждого пуша в ветку `main`.

Итого: правки в Cursor нужно **запушить в Git** — тогда через 1–2 минуты в Telegram будет открываться уже новая версия приложения.

---

## 1. Cursor → Git (отправить изменения на GitHub)

Делай это после правок, когда хочешь сохранить их в репозитории и обновить приложение в Telegram.

**В терминале Cursor** (корень проекта `telegram-miniapp`):

```bash
git add .
git status
git commit -m "описание правок"
git push origin main
```

- `git add .` — подготовить все изменения.
- `git status` — посмотреть, что именно попадёт в коммит (по желанию).
- `git commit -m "..."` — зафиксировать с коротким описанием (например: "обновлён дизайн донатов").
- `git push origin main` — отправить ветку `main` на GitHub.

Если ветка по умолчанию у тебя не `main`, а например `master`, замени в команде на неё.

**Одной командой из корня проекта:** если устраивает сообщение коммита "Update", можно выполнить:
```bash
npm run sync
```
Скрипт сделает `git add .`, затем коммит и `git push origin main` (если есть изменения). Если изменений нет, выведет «Нет изменений для коммита».

**Через интерфейс Cursor:** можно использовать Source Control (иконка ветки слева): там кнопки Stage All, поле для сообщения коммита и кнопка Sync/Push.

После успешного `git push` GitHub Actions сам соберёт и задеплоит сайт на GitHub Pages (обычно 1–2 минуты).

---

## 2. Git → Cursor (подтянуть изменения, например со второго компьютера)

Когда правила что-то на другом компьютере (или кто-то ещё пушил в репозиторий), на текущем в Cursor нужно подтянуть изменения:

```bash
git pull origin main
```

Лучше делать в начале работы или когда знаешь, что в репо уже есть новые коммиты.

---

## 3. Git → Telegram (когда в Telegram уже новая версия)

Ничего отдельно настраивать не нужно:

- Приложение в Telegram открывает:  
  `https://allabelkevich-wq.github.io/telegram-miniapp/`
- Этот адрес отдаёт GitHub Pages.
- GitHub Pages обновляется автоматически при каждом пуше в `main`.

Поэтому: **после `git push` подожди 1–2 минуты**, затем в Telegram закрой чат с ботом и открой снова (или заново нажми кнопку меню) — откроется уже обновлённая версия. Если не обновилось — закрой приложение полностью и открой ещё раз (иногда мешает кэш).

---

## Краткий чек-лист

| Цель | Действие |
|------|----------|
| Сохранить правки из Cursor и обновить приложение в Telegram | `git add .` → `git commit -m "..."` → `git push origin main` → подождать 1–2 мин → открыть приложение в Telegram заново |
| Взять последние изменения с GitHub (второй компьютер или общий репо) | `git pull origin main` |
| Убедиться, что в Telegram именно новая версия | После пуша подождать, полностью закрыть приложение в Telegram и открыть снова |

---

## Важно

- Файлы **`bot/.env`** и **`.env`** в репозиторий не попадают (они в `.gitignore`). На втором компьютере их нужно создать вручную и заполнить теми же значениями.
- Бот запускается отдельно (`cd bot && npm start`). Его код синхронизируется через Git, но сам процесс бота нужно запускать на том компьютере, с которого хочешь, чтобы бот работал.

Если хочешь, можно добавить в корень проекта простой скрипт (например, `npm run sync`), который будет делать `git add .` + `git commit` с фиксированным сообщением + `git push` — тогда «синхронизация с Git» будет одной командой из Cursor.
