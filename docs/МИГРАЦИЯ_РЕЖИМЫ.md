# Миграция БД: режимы «Для двоих» и «Энергия дня»

**Сделай один раз:** открой [Supabase](https://supabase.com) → свой проект → **SQL Editor** → New query → вставь блок ниже → **Run**.

```sql
alter table track_requests add column if not exists mode text default 'single';
alter table track_requests drop constraint if exists track_requests_mode_check;
alter table track_requests add constraint track_requests_mode_check check (mode in ('single', 'couple', 'transit'));
alter table track_requests add column if not exists person2_name text;
alter table track_requests add column if not exists person2_birthdate text;
alter table track_requests add column if not exists person2_birthplace text;
alter table track_requests add column if not exists person2_birthtime text;
alter table track_requests add column if not exists person2_birthtime_unknown boolean default false;
alter table track_requests add column if not exists person2_gender text;
alter table track_requests add column if not exists transit_date text;
alter table track_requests add column if not exists transit_time text;
alter table track_requests add column if not exists transit_location text;
alter table track_requests add column if not exists transit_intent text;
```

Если появится ошибка вида `constraint "track_requests_mode_check" does not exist` — её можно проигнорировать (остальные команды выполнятся). После успешного Run деплой с GitHub уже подхватит новый код.
